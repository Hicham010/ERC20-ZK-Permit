import{r as x,u as M,a as v,b as I,c as F,B as r,d as S,e as y,j as e,f as b,A as O,E as K,g as $,Z as _,H as q,h as z}from"./index-3d54e251.js";import{I as D,b as G}from"./poseidon_gencontract-75f3d6cf.js";import{n as J}from"./index-a219c3dd.js";import"./readable-browser-37beddf4.js";import"./useNotification-c719fc5b.js";function es(){const[C,H]=J.useNotification(),[j,c]=x.useState(!1),[d,k]=x.useState(""),{address:t=O,isConnected:l}=M(),h=v(),n={address:K,abi:$.abi},{data:L,refetch:u,isRefetching:f}=I({contracts:[{...n,functionName:"balanceOf",args:[t]},{...n,functionName:"userHash",args:[t]}],enabled:l,staleTime:4e3}),[T,U]=L??[_,q],g=(s,o)=>{C.success({message:s,description:e.jsx("a",{href:`https://sepolia.etherscan.io/tx/${o}`,target:"_blank",children:"Transaction Link"})})},{config:w}=F({...n,functionName:"mint",args:[t,r.from("1000")],enabled:l}),{data:a,isLoading:A,write:P}=S({...w,onSuccess:({hash:s})=>{g("Mint Successful",s),h({hash:s,description:"Minted Tokens"})}}),{data:i,isLoading:N,write:p}=S({...n,functionName:"setUserHash",mode:"recklesslyUnprepared",onSuccess:({hash:s})=>{g("Setting User Hash Successful",s),h({hash:s,description:"Setted new userhash"})}}),{isLoading:Z}=y({hash:a==null?void 0:a.hash,onSuccess(){u()}}),{isLoading:B}=y({hash:i==null?void 0:i.hash,onSuccess(){u()}}),E=async()=>{if(p){c(!0);try{const s=r.from("0x"+Buffer.from(d).toString("hex")).toString(),o="0",m=await G(),R=m.F.toString(m([s,o,t])),W=z.hexZeroPad(r.from(R).toHexString(),32);p({recklesslySetUnpreparedArgs:[W]})}catch(s){console.error(s)}finally{c(!1)}}};return e.jsxs(e.Fragment,{children:[H,e.jsxs("p",{style:{opacity:B||f?.25:1},children:["Current User Hash: ",U]}),e.jsxs("div",{style:{display:"flex"},children:[e.jsx(D,{maxLength:30,minLength:8,onChange:s=>k(s.target.value)}),e.jsx(b,{disabled:d.length<8,loading:j||N,style:{marginLeft:"50px"},onClick:E,children:"Set Password"})]}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"baseline"},children:[e.jsxs("p",{style:{opacity:Z||f?.25:1},children:["Current Balance: ",T.div(`${1e18}`).toString()]}),e.jsx(b,{loading:A,style:{marginLeft:"50px"},onClick:P,children:"Mint 10 000 Tokens"})]})]})}export{es as default};
