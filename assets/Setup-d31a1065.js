import{r as p,u as W,a as R,b as v,B as o,c as x,d as S,j as e,e as y,A as I,E as M,f as F,Z as O,H as K,g as $}from"./index-8370337f.js";import{I as _,b as q}from"./poseidon_gencontract-ae7023b8.js";import{n as z}from"./index-7ca90969.js";import"./readable-browser-8d5425a5.js";import"./useNotification-27fcc2df.js";function X(){const[b,C]=z.useNotification(),[H,c]=p.useState(!1),[d,j]=p.useState(""),{address:t=I,isConnected:l}=W(),a={address:M,abi:F.abi},{data:[L,U]=[O,K],refetch:h,isRefetching:u}=R({contracts:[{...a,functionName:"balanceOf",args:[t]},{...a,functionName:"userHash",args:[t]}],enabled:l,staleTime:4e3}),f=(s,r)=>{b.success({message:s,description:e.jsx("a",{href:`https://sepolia.etherscan.io/tx/${r}`,target:"_blank",children:"Transaction Link"})})},{config:k}=v({...a,functionName:"mint",args:[t,o.from("1000")],enabled:l}),{data:n,isLoading:P,write:w}=x({...k,onSuccess:({hash:s})=>{f("Mint Successful",s)}}),{data:i,isLoading:A,write:g}=x({...a,functionName:"setUserHash",mode:"recklesslyUnprepared",onSuccess:({hash:s})=>{f("Setting User Hash Successful",s)}}),{isLoading:N}=S({hash:n==null?void 0:n.hash,onSuccess(){h()}}),{isLoading:Z}=S({hash:i==null?void 0:i.hash,onSuccess(){h()}}),B=async()=>{if(g){c(!0);try{const s=o.from("0x"+Buffer.from(d).toString("hex")).toString(),r="0",m=await q(),T=m.F.toString(m([s,r,t])),E=$.hexZeroPad(o.from(T).toHexString(),32);g({recklesslySetUnpreparedArgs:[E]})}catch(s){console.error(s)}finally{c(!1)}}};return e.jsxs(e.Fragment,{children:[C,e.jsxs("p",{style:{opacity:Z||u?.25:1},children:["Current User Hash: ",U]}),e.jsxs("div",{style:{display:"flex"},children:[e.jsx(_,{maxLength:30,minLength:8,onChange:s=>j(s.target.value)}),e.jsx(y,{disabled:d.length<8,loading:H||A,style:{marginLeft:"50px"},onClick:B,children:"Set Password"})]}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"baseline"},children:[e.jsxs("p",{style:{opacity:N||u?.25:1},children:["Current Balance: ",L.div(`${1e18}`).toString()]}),e.jsx(y,{loading:P,style:{marginLeft:"50px"},onClick:w,children:"Mint 10 000 Tokens"})]})]})}export{X as default};
