import{r as j,u as v,a as F,b as _,c as D,d as w,e as A,j as t,B as E,Z as K,t as $,p as z,f as q,E as G,g as J}from"./index-cfac5165.js";import{I as Q,b as V}from"./poseidon_gencontract-8eee4a1b.js";import{n as X}from"./index-a3076dec.js";import{m as Y}from"./index-63276fc2.js";import"./readable-browser-cb1fc524.js";function is(){var S,y,C,H;const[L,R]=X.useNotification(),[T,c]=j.useState(!1),[d,k]=j.useState(""),{address:n=q,isConnected:l}=v(),h=F(),a={address:G,abi:J.abi},{data:e,refetch:u,isRefetching:g}=_({contracts:[{...a,functionName:"balanceOf",args:[n]},{...a,functionName:"userHash",args:[n]}],enabled:l,watch:!0});let[f,p]=[0n,K];e&&Array.isArray(e)&&((S=e[0])!=null&&S.result)&&((y=e[1])!=null&&y.result)&&([f,p]=[(C=e[0])==null?void 0:C.result,(H=e[1])==null?void 0:H.result]);const m=(s,o)=>{L.success({message:s,description:t.jsx("a",{href:`https://sepolia.etherscan.io/tx/${o}`,target:"_blank",children:"Transaction Link"})})},{config:B}=D({...a,functionName:"mint",args:[n,1000n],enabled:l}),{data:i,isLoading:P,write:U}=w({...B,onSuccess:({hash:s})=>{m("Mint Successful",s),h({hash:s,description:"Minted Tokens"})}}),{data:r,isLoading:I,write:x}=w({...a,functionName:"setUserHash",onSuccess:({hash:s})=>{m("Setting User Hash Successful",s),h({hash:s,description:"Setted new userhash"})}}),{isLoading:N}=A({hash:i==null?void 0:i.hash,onSuccess(){u()}}),{isLoading:W}=A({hash:r==null?void 0:r.hash,onSuccess(){u()}}),Z=async()=>{if(x){c(!0);try{const s=BigInt($(d)).toString(),o="0",b=await V(),M=b.F.toString(b([s,o,n])),O=z(`0x${BigInt(M).toString(16)}`,{size:32});x({args:[O]})}catch(s){console.error(s),s instanceof Error&&Y.error("Something went wrong setting the user hash: "+s.message)}finally{c(!1)}}};return t.jsxs(t.Fragment,{children:[R,t.jsxs("p",{style:{opacity:W||g?.25:1},children:["Current User Hash: ",p]}),t.jsxs("div",{style:{display:"flex"},children:[t.jsx(Q,{maxLength:30,minLength:8,onChange:s=>k(s.target.value)}),t.jsx(E,{disabled:d.length<8,loading:T||I,style:{marginLeft:"50px"},onClick:Z,children:"Set Password"})]}),t.jsx("br",{}),t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"baseline"},children:[t.jsxs("p",{style:{opacity:N||g?.25:1},children:["Current Balance: ",(f/BigInt(1e18)).toString()]}),t.jsx(E,{loading:P,style:{marginLeft:"50px"},onClick:U,children:"Mint 10 000 Tokens"})]})]})}export{is as default};
