import{aL as Rl,ai as Bs,aM as ie,aj as Kr,aN as G0,aO as Al,aP as Tl,aQ as yc,aR as ga,aS as W0,ah as ta,ak as Nl,aT as _i,aU as J0,aV as Q0,aW as Y,aX as Y0,aY as cc,aZ as X0,a_ as Z0,a$ as em,b0 as Oh,b1 as tm,b2 as rm,b3 as im,b4 as Ch,b5 as sm,b6 as nm,b7 as am,b8 as Fs,b9 as Rh,ba as om,bb as cm,bc as mc,bd as $l,be as Dr,bf as um,bg as Ah,bh as us,bi as $t,bj as Gt,bk as wi,bl as hr,bm as hm,bn as hs,bo as Dl,bp as lm,bq as fm,br as pm,bs as Ll,bt as dm,bu as ql,bv as Ml,bw as fs,bx as uc,by as ca,bz as ps,bA as gm,bB as ua,bC as vm,bD as ym,bE as mm,bF as wm,bG as ra,bH as _m,bI as bm,bJ as Fo,bK as Th,bL as Em,bM as Im,bN as xm,bO as Nh,bP as Pm,bQ as Sm,bR as Om,bS as Cm,bT as Rm,bU as Am,bV as Tm,bW as Hs,bX as jl,bY as Bo,bZ as Nm,b_ as $m,_ as Dm}from"./index-NPCOLHFI.js";import{s as Gs,a as va,i as $h,c as Lm,b as qm,f as wc,p as Mm,J as ni,d as _c,e as bc,g as ya,h as mi,j as si,k as Vs,l as jm,m as zm,H as Ii}from"./http-jkL-4D4Y.js";const Um=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Hm=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,km=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Km(c,i){if(c==="__proto__"||c==="constructor"&&i&&typeof i=="object"&&"prototype"in i){Vm(c);return}return i}function Vm(c){console.warn(`[destr] Dropping "${c}" key to prevent prototype pollution.`)}function ia(c,i={}){if(typeof c!="string")return c;const r=c.trim();if(c[0]==='"'&&c.at(-1)==='"'&&!c.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!km.test(c)){if(i.strict)throw new SyntaxError("[destr] Invalid JSON");return c}try{if(Um.test(c)||Hm.test(c)){if(i.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(c,Km)}return JSON.parse(c)}catch(n){if(i.strict)throw n;return c}}function Fm(c){return!c||typeof c.then!="function"?Promise.resolve(c):c}function Ut(c,...i){try{return Fm(c(...i))}catch(r){return Promise.reject(r)}}function Bm(c){const i=typeof c;return c===null||i!=="object"&&i!=="function"}function Gm(c){const i=Object.getPrototypeOf(c);return!i||i.isPrototypeOf(Object)}function ha(c){if(Bm(c))return String(c);if(Gm(c)||Array.isArray(c))return JSON.stringify(c);if(typeof c.toJSON=="function")return ha(c.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function zl(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const hc="base64:";function Wm(c){if(typeof c=="string")return c;zl();const i=Buffer.from(c).toString("base64");return hc+i}function Jm(c){return typeof c!="string"||!c.startsWith(hc)?c:(zl(),Buffer.from(c.slice(hc.length),"base64"))}function ur(c){return c?c.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Qm(...c){return ur(c.join(":"))}function sa(c){return c=ur(c),c?c+":":""}const Ym="memory",Xm=()=>{const c=new Map;return{name:Ym,options:{},hasItem(i){return c.has(i)},getItem(i){return c.get(i)??null},getItemRaw(i){return c.get(i)??null},setItem(i,r){c.set(i,r)},setItemRaw(i,r){c.set(i,r)},removeItem(i){c.delete(i)},getKeys(){return Array.from(c.keys())},clear(){c.clear()},dispose(){c.clear()}}};function Zm(c={}){const i={mounts:{"":c.driver||Xm()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const E of i.mountpoints)if(y.startsWith(E))return{base:E,relativeKey:y.slice(E.length),driver:i.mounts[E]};return{base:"",relativeKey:y,driver:i.mounts[""]}},n=(y,E)=>i.mountpoints.filter(O=>O.startsWith(y)||E&&y.startsWith(O)).map(O=>({relativeBase:y.length>O.length?y.slice(O.length):void 0,mountpoint:O,driver:i.mounts[O]})),a=(y,E)=>{if(i.watching){E=ur(E);for(const O of i.watchListeners)O(y,E)}},l=async()=>{if(!i.watching){i.watching=!0;for(const y in i.mounts)i.unwatch[y]=await Dh(i.mounts[y],a,y)}},d=async()=>{if(i.watching){for(const y in i.unwatch)await i.unwatch[y]();i.unwatch={},i.watching=!1}},v=(y,E,O)=>{const R=new Map,z=D=>{let V=R.get(D.base);return V||(V={driver:D.driver,base:D.base,items:[]},R.set(D.base,V)),V};for(const D of y){const V=typeof D=="string",re=ur(V?D:D.key),ce=V?void 0:D.value,ue=V||!D.options?E:{...E,...D.options},he=r(re);z(he).items.push({key:re,value:ce,relativeKey:he.relativeKey,options:ue})}return Promise.all([...R.values()].map(D=>O(D))).then(D=>D.flat())},w={hasItem(y,E={}){y=ur(y);const{relativeKey:O,driver:R}=r(y);return Ut(R.hasItem,O,E)},getItem(y,E={}){y=ur(y);const{relativeKey:O,driver:R}=r(y);return Ut(R.getItem,O,E).then(z=>ia(z))},getItems(y,E){return v(y,E,O=>O.driver.getItems?Ut(O.driver.getItems,O.items.map(R=>({key:R.relativeKey,options:R.options})),E).then(R=>R.map(z=>({key:Qm(O.base,z.key),value:ia(z.value)}))):Promise.all(O.items.map(R=>Ut(O.driver.getItem,R.relativeKey,R.options).then(z=>({key:R.key,value:ia(z)})))))},getItemRaw(y,E={}){y=ur(y);const{relativeKey:O,driver:R}=r(y);return R.getItemRaw?Ut(R.getItemRaw,O,E):Ut(R.getItem,O,E).then(z=>Jm(z))},async setItem(y,E,O={}){if(E===void 0)return w.removeItem(y);y=ur(y);const{relativeKey:R,driver:z}=r(y);z.setItem&&(await Ut(z.setItem,R,ha(E),O),z.watch||a("update",y))},async setItems(y,E){await v(y,E,async O=>{O.driver.setItems&&await Ut(O.driver.setItems,O.items.map(R=>({key:R.relativeKey,value:ha(R.value),options:R.options})),E),O.driver.setItem&&await Promise.all(O.items.map(R=>Ut(O.driver.setItem,R.relativeKey,ha(R.value),R.options)))})},async setItemRaw(y,E,O={}){if(E===void 0)return w.removeItem(y,O);y=ur(y);const{relativeKey:R,driver:z}=r(y);if(z.setItemRaw)await Ut(z.setItemRaw,R,E,O);else if(z.setItem)await Ut(z.setItem,R,Wm(E),O);else return;z.watch||a("update",y)},async removeItem(y,E={}){typeof E=="boolean"&&(E={removeMeta:E}),y=ur(y);const{relativeKey:O,driver:R}=r(y);R.removeItem&&(await Ut(R.removeItem,O,E),(E.removeMeta||E.removeMata)&&await Ut(R.removeItem,O+"$",E),R.watch||a("remove",y))},async getMeta(y,E={}){typeof E=="boolean"&&(E={nativeOnly:E}),y=ur(y);const{relativeKey:O,driver:R}=r(y),z=Object.create(null);if(R.getMeta&&Object.assign(z,await Ut(R.getMeta,O,E)),!E.nativeOnly){const D=await Ut(R.getItem,O+"$",E).then(V=>ia(V));D&&typeof D=="object"&&(typeof D.atime=="string"&&(D.atime=new Date(D.atime)),typeof D.mtime=="string"&&(D.mtime=new Date(D.mtime)),Object.assign(z,D))}return z},setMeta(y,E,O={}){return this.setItem(y+"$",E,O)},removeMeta(y,E={}){return this.removeItem(y+"$",E)},async getKeys(y,E={}){y=sa(y);const O=n(y,!0);let R=[];const z=[];for(const D of O){const re=(await Ut(D.driver.getKeys,D.relativeBase,E)).map(ce=>D.mountpoint+ur(ce)).filter(ce=>!R.some(ue=>ce.startsWith(ue)));z.push(...re),R=[D.mountpoint,...R.filter(ce=>!ce.startsWith(D.mountpoint))]}return y?z.filter(D=>D.startsWith(y)&&!D.endsWith("$")):z.filter(D=>!D.endsWith("$"))},async clear(y,E={}){y=sa(y),await Promise.all(n(y,!1).map(async O=>{if(O.driver.clear)return Ut(O.driver.clear,O.relativeBase,E);if(O.driver.removeItem){const R=await O.driver.getKeys(O.relativeBase||"",E);return Promise.all(R.map(z=>O.driver.removeItem(z,E)))}}))},async dispose(){await Promise.all(Object.values(i.mounts).map(y=>Lh(y)))},async watch(y){return await l(),i.watchListeners.push(y),async()=>{i.watchListeners=i.watchListeners.filter(E=>E!==y),i.watchListeners.length===0&&await d()}},async unwatch(){i.watchListeners=[],await d()},mount(y,E){if(y=sa(y),y&&i.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(i.mountpoints.push(y),i.mountpoints.sort((O,R)=>R.length-O.length)),i.mounts[y]=E,i.watching&&Promise.resolve(Dh(E,a,y)).then(O=>{i.unwatch[y]=O}).catch(console.error),w},async unmount(y,E=!0){y=sa(y),!(!y||!i.mounts[y])&&(i.watching&&y in i.unwatch&&(i.unwatch[y](),delete i.unwatch[y]),E&&await Lh(i.mounts[y]),i.mountpoints=i.mountpoints.filter(O=>O!==y),delete i.mounts[y])},getMount(y=""){y=ur(y)+":";const E=r(y);return{driver:E.driver,base:E.base}},getMounts(y="",E={}){return y=ur(y),n(y,E.parents).map(R=>({driver:R.driver,base:R.mountpoint}))}};return w}function Dh(c,i,r){return c.watch?c.watch((n,a)=>i(n,r+a)):()=>{}}async function Lh(c){typeof c.dispose=="function"&&await Ut(c.dispose)}function Ui(c){return new Promise((i,r)=>{c.oncomplete=c.onsuccess=()=>i(c.result),c.onabort=c.onerror=()=>r(c.error)})}function Ul(c,i){const r=indexedDB.open(c);r.onupgradeneeded=()=>r.result.createObjectStore(i);const n=Ui(r);return(a,l)=>n.then(d=>l(d.transaction(i,a).objectStore(i)))}let Go;function Ws(){return Go||(Go=Ul("keyval-store","keyval")),Go}function qh(c,i=Ws()){return i("readonly",r=>Ui(r.get(c)))}function ew(c,i,r=Ws()){return r("readwrite",n=>(n.put(i,c),Ui(n.transaction)))}function tw(c,i=Ws()){return i("readwrite",r=>(r.delete(c),Ui(r.transaction)))}function rw(c=Ws()){return c("readwrite",i=>(i.clear(),Ui(i.transaction)))}function iw(c,i){return c.openCursor().onsuccess=function(){this.result&&(i(this.result),this.result.continue())},Ui(c.transaction)}function sw(c=Ws()){return c("readonly",i=>{if(i.getAllKeys)return Ui(i.getAllKeys());const r=[];return iw(i,n=>r.push(n.key)).then(()=>r)})}const nw="idb-keyval";var aw=(c={})=>{const i=c.base&&c.base.length>0?`${c.base}:`:"",r=a=>i+a;let n;return c.dbName&&c.storeName&&(n=Ul(c.dbName,c.storeName)),{name:nw,options:c,async hasItem(a){return!(typeof await qh(r(a),n)>"u")},async getItem(a){return await qh(r(a),n)??null},setItem(a,l){return ew(r(a),l,n)},removeItem(a){return tw(r(a),n)},getKeys(){return sw(n)},clear(){return rw(n)}}};const ow="WALLET_CONNECT_V2_INDEXED_DB",cw="keyvaluestorage";let uw=class{constructor(){this.indexedDb=Zm({driver:aw({dbName:ow,storeName:cw})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(i=>[i.key,i.value])}async getItem(i){const r=await this.indexedDb.getItem(i);if(r!==null)return r}async setItem(i,r){await this.indexedDb.setItem(i,Gs(r))}async removeItem(i){await this.indexedDb.removeItem(i)}};var Wo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},la={exports:{}};(function(){let c;function i(){}c=i,c.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},c.prototype.setItem=function(r,n){this[r]=String(n)},c.prototype.removeItem=function(r){delete this[r]},c.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},c.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},c.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Wo<"u"&&Wo.localStorage?la.exports=Wo.localStorage:typeof window<"u"&&window.localStorage?la.exports=window.localStorage:la.exports=new i})();function hw(c){var i;return[c[0],va((i=c[1])!=null?i:"")]}class lw{constructor(){this.localStorage=la.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(hw)}async getItem(i){const r=this.localStorage.getItem(i);if(r!==null)return va(r)}async setItem(i,r){this.localStorage.setItem(i,Gs(r))}async removeItem(i){this.localStorage.removeItem(i)}}const fw="wc_storage_version",Mh=1,pw=async(c,i,r)=>{const n=fw,a=await i.getItem(n);if(a&&a>=Mh){r(i);return}const l=await c.getKeys();if(!l.length){r(i);return}const d=[];for(;l.length;){const v=l.shift();if(!v)continue;const w=v.toLowerCase();if(w.includes("wc@")||w.includes("walletconnect")||w.includes("wc_")||w.includes("wallet_connect")){const y=await c.getItem(v);await i.setItem(v,y),d.push(v)}}await i.setItem(n,Mh),r(i),dw(c,d)},dw=async(c,i)=>{i.length&&i.forEach(async r=>{await c.removeItem(r)})};let gw=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const i=new lw;this.storage=i;try{const r=new uw;pw(i,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(i){return await this.initialize(),this.storage.getItem(i)}async setItem(i,r){return await this.initialize(),this.storage.setItem(i,r)}async removeItem(i){return await this.initialize(),this.storage.removeItem(i)}async initialize(){this.initialized||await new Promise(i=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),i())},20)})}};var ds={},Ds={},Jo={},Ls={};class Hi{}const vw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Hi},Symbol.toStringTag,{value:"Module"})),yw=Rl(vw);var jh;function mw(){if(jh)return Ls;jh=1,Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.IHeartBeat=void 0;const c=yw;class i extends c.IEvents{constructor(n){super()}}return Ls.IHeartBeat=i,Ls}var zh;function Hl(){return zh||(zh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),Bs.__exportStar(mw(),c)}(Jo)),Jo}var Qo={},ji={},Uh;function ww(){if(Uh)return ji;Uh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.HEARTBEAT_EVENTS=ji.HEARTBEAT_INTERVAL=void 0;const c=ie;return ji.HEARTBEAT_INTERVAL=c.FIVE_SECONDS,ji.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ji}var Hh;function kl(){return Hh||(Hh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),Bs.__exportStar(ww(),c)}(Qo)),Qo}var kh;function _w(){if(kh)return Ds;kh=1,Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.HeartBeat=void 0;const c=Bs,i=Kr,r=ie,n=Hl(),a=kl();class l extends n.IHeartBeat{constructor(v){super(v),this.events=new i.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(v==null?void 0:v.interval)||a.HEARTBEAT_INTERVAL}static init(v){return c.__awaiter(this,void 0,void 0,function*(){const w=new l(v);return yield w.init(),w})}init(){return c.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(v,w){this.events.on(v,w)}once(v,w){this.events.once(v,w)}off(v,w){this.events.off(v,w)}removeListener(v,w){this.events.removeListener(v,w)}initialize(){return c.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Ds.HeartBeat=l,Ds}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const i=Bs;i.__exportStar(_w(),c),i.__exportStar(Hl(),c),i.__exportStar(kl(),c)})(ds);var Se={},Yo,Kh;function bw(){if(Kh)return Yo;Kh=1;function c(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Yo=i;function i(r,n,a){var l=a&&a.stringify||c,d=1;if(typeof r=="object"&&r!==null){var v=n.length+d;if(v===1)return r;var w=new Array(v);w[0]=l(r);for(var y=1;y<v;y++)w[y]=l(n[y]);return w.join(" ")}if(typeof r!="string")return r;var E=n.length;if(E===0)return r;for(var O="",R=1-d,z=-1,D=r&&r.length||0,V=0;V<D;){if(r.charCodeAt(V)===37&&V+1<D){switch(z=z>-1?z:0,r.charCodeAt(V+1)){case 100:case 102:if(R>=E||n[R]==null)break;z<V&&(O+=r.slice(z,V)),O+=Number(n[R]),z=V+2,V++;break;case 105:if(R>=E||n[R]==null)break;z<V&&(O+=r.slice(z,V)),O+=Math.floor(Number(n[R])),z=V+2,V++;break;case 79:case 111:case 106:if(R>=E||n[R]===void 0)break;z<V&&(O+=r.slice(z,V));var re=typeof n[R];if(re==="string"){O+="'"+n[R]+"'",z=V+2,V++;break}if(re==="function"){O+=n[R].name||"<anonymous>",z=V+2,V++;break}O+=l(n[R]),z=V+2,V++;break;case 115:if(R>=E)break;z<V&&(O+=r.slice(z,V)),O+=String(n[R]),z=V+2,V++;break;case 37:z<V&&(O+=r.slice(z,V)),O+="%",z=V+2,V++,R--;break}++R}++V}return z===-1?r:(z<D&&(O+=r.slice(z)),O)}return Yo}var Xo,Vh;function Ew(){if(Vh)return Xo;Vh=1;const c=bw();Xo=a;const i=pe().console||{},r={mapHttpRequest:D,mapHttpResponse:D,wrapRequestSerializer:V,wrapResponseSerializer:V,wrapErrorSerializer:V,req:D,res:D,err:R};function n($,k){return Array.isArray($)?$.filter(function(ve){return ve!=="!stdSerializers.err"}):$===!0?Object.keys(k):!1}function a($){$=$||{},$.browser=$.browser||{};const k=$.browser.transmit;if(k&&typeof k.send!="function")throw Error("pino: transmit option must have a send function");const W=$.browser.write||i;$.browser.write&&($.browser.asObject=!0);const ve=$.serializers||{},te=n($.browser.serialize,ve);let Ee=$.browser.serialize;Array.isArray($.browser.serialize)&&$.browser.serialize.indexOf("!stdSerializers.err")>-1&&(Ee=!1);const Re=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),$.enabled===!1&&($.level="silent");const et=$.level||"info",A=Object.create(W);A.log||(A.log=re),Object.defineProperty(A,"levelVal",{get:ze}),Object.defineProperty(A,"level",{get:Ae,set:J});const j={transmit:k,serialize:te,asObject:$.browser.asObject,levels:Re,timestamp:z($)};A.levels=a.levels,A.level=et,A.setMaxListeners=A.getMaxListeners=A.emit=A.addListener=A.on=A.prependListener=A.once=A.prependOnceListener=A.removeListener=A.removeAllListeners=A.listeners=A.listenerCount=A.eventNames=A.write=A.flush=re,A.serializers=ve,A._serialize=te,A._stdErrSerialize=Ee,A.child=F,k&&(A._logEvent=O());function ze(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Ae(){return this._level}function J(K){if(K!=="silent"&&!this.levels.values[K])throw Error("unknown level "+K);this._level=K,l(j,A,"error","log"),l(j,A,"fatal","error"),l(j,A,"warn","error"),l(j,A,"info","log"),l(j,A,"debug","log"),l(j,A,"trace","log")}function F(K,B){if(!K)throw new Error("missing bindings for child Pino");B=B||{},te&&K.serializers&&(B.serializers=K.serializers);const ut=B.serializers;if(te&&ut){var ke=Object.assign({},ve,ut),Lr=$.browser.serialize===!0?Object.keys(ke):te;delete K.serializers,w([K],Lr,ke,this._stdErrSerialize)}function _e(It){this._childLevel=(It._childLevel|0)+1,this.error=y(It,K,"error"),this.fatal=y(It,K,"fatal"),this.warn=y(It,K,"warn"),this.info=y(It,K,"info"),this.debug=y(It,K,"debug"),this.trace=y(It,K,"trace"),ke&&(this.serializers=ke,this._serialize=Lr),k&&(this._logEvent=O([].concat(It._logEvent.bindings,K)))}return _e.prototype=this,new _e(this)}return A}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ce,epochTime:ue,unixTime:he,isoTime:fe});function l($,k,W,ve){const te=Object.getPrototypeOf(k);k[W]=k.levelVal>k.levels.values[W]?re:te[W]?te[W]:i[W]||i[ve]||re,d($,k,W)}function d($,k,W){!$.transmit&&k[W]===re||(k[W]=function(ve){return function(){const Ee=$.timestamp(),Re=new Array(arguments.length),et=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var A=0;A<Re.length;A++)Re[A]=arguments[A];if($.serialize&&!$.asObject&&w(Re,this._serialize,this.serializers,this._stdErrSerialize),$.asObject?ve.call(et,v(this,W,Re,Ee)):ve.apply(et,Re),$.transmit){const j=$.transmit.level||k.level,ze=a.levels.values[j],Ae=a.levels.values[W];if(Ae<ze)return;E(this,{ts:Ee,methodLevel:W,methodValue:Ae,transmitLevel:j,transmitValue:a.levels.values[$.transmit.level||k.level],send:$.transmit.send,val:k.levelVal},Re)}}}(k[W]))}function v($,k,W,ve){$._serialize&&w(W,$._serialize,$.serializers,$._stdErrSerialize);const te=W.slice();let Ee=te[0];const Re={};ve&&(Re.time=ve),Re.level=a.levels.values[k];let et=($._childLevel|0)+1;if(et<1&&(et=1),Ee!==null&&typeof Ee=="object"){for(;et--&&typeof te[0]=="object";)Object.assign(Re,te.shift());Ee=te.length?c(te.shift(),te):void 0}else typeof Ee=="string"&&(Ee=c(te.shift(),te));return Ee!==void 0&&(Re.msg=Ee),Re}function w($,k,W,ve){for(const te in $)if(ve&&$[te]instanceof Error)$[te]=a.stdSerializers.err($[te]);else if(typeof $[te]=="object"&&!Array.isArray($[te]))for(const Ee in $[te])k&&k.indexOf(Ee)>-1&&Ee in W&&($[te][Ee]=W[Ee]($[te][Ee]))}function y($,k,W){return function(){const ve=new Array(1+arguments.length);ve[0]=k;for(var te=1;te<ve.length;te++)ve[te]=arguments[te-1];return $[W].apply(this,ve)}}function E($,k,W){const ve=k.send,te=k.ts,Ee=k.methodLevel,Re=k.methodValue,et=k.val,A=$._logEvent.bindings;w(W,$._serialize||Object.keys($.serializers),$.serializers,$._stdErrSerialize===void 0?!0:$._stdErrSerialize),$._logEvent.ts=te,$._logEvent.messages=W.filter(function(j){return A.indexOf(j)===-1}),$._logEvent.level.label=Ee,$._logEvent.level.value=Re,ve(Ee,$._logEvent,et),$._logEvent=O(A)}function O($){return{ts:0,messages:[],bindings:$||[],level:{label:"",value:0}}}function R($){const k={type:$.constructor.name,msg:$.message,stack:$.stack};for(const W in $)k[W]===void 0&&(k[W]=$[W]);return k}function z($){return typeof $.timestamp=="function"?$.timestamp:$.timestamp===!1?ce:ue}function D(){return{}}function V($){return $}function re(){}function ce(){return!1}function ue(){return Date.now()}function he(){return Math.round(Date.now()/1e3)}function fe(){return new Date(Date.now()).toISOString()}function pe(){function $(k){return typeof k<"u"&&k}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return $(self)||$(window)||$(this)||{}}}return Xo}var zi={},Fh;function Kl(){return Fh||(Fh=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.PINO_CUSTOM_CONTEXT_KEY=zi.PINO_LOGGER_DEFAULTS=void 0,zi.PINO_LOGGER_DEFAULTS={level:"info"},zi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),zi}var tr={},Bh;function Iw(){if(Bh)return tr;Bh=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.generateChildLogger=tr.formatChildLoggerContext=tr.getLoggerContext=tr.setBrowserLoggerContext=tr.getBrowserLoggerContext=tr.getDefaultLoggerOptions=void 0;const c=Kl();function i(v){return Object.assign(Object.assign({},v),{level:(v==null?void 0:v.level)||c.PINO_LOGGER_DEFAULTS.level})}tr.getDefaultLoggerOptions=i;function r(v,w=c.PINO_CUSTOM_CONTEXT_KEY){return v[w]||""}tr.getBrowserLoggerContext=r;function n(v,w,y=c.PINO_CUSTOM_CONTEXT_KEY){return v[y]=w,v}tr.setBrowserLoggerContext=n;function a(v,w=c.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof v.bindings>"u"?y=r(v,w):y=v.bindings().context||"",y}tr.getLoggerContext=a;function l(v,w,y=c.PINO_CUSTOM_CONTEXT_KEY){const E=a(v,y);return E.trim()?`${E}/${w}`:w}tr.formatChildLoggerContext=l;function d(v,w,y=c.PINO_CUSTOM_CONTEXT_KEY){const E=l(v,w,y),O=v.child({context:E});return n(O,E,y)}return tr.generateChildLogger=d,tr}(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.pino=void 0;const i=Bs,r=i.__importDefault(Ew());Object.defineProperty(c,"pino",{enumerable:!0,get:function(){return r.default}}),i.__exportStar(Kl(),c),i.__exportStar(Iw(),c)})(Se);class xw extends Hi{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}}let Pw=class extends Hi{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}},Sw=class{constructor(i,r){this.logger=i,this.core=r}},Ow=class extends Hi{constructor(i,r){super(),this.relayer=i,this.logger=r}},Cw=class extends Hi{constructor(i){super()}},Rw=class{constructor(i,r,n,a){this.core=i,this.logger=r,this.name=n}};class Aw extends Hi{constructor(i,r){super(),this.relayer=i,this.logger=r}}let Tw=class extends Hi{constructor(i,r){super(),this.core=i,this.logger=r}},Nw=class{constructor(i,r){this.projectId=i,this.logger=r}},$w=class{constructor(i,r){this.projectId=i,this.logger=r}},Dw=class{constructor(i){this.opts=i,this.protocol="wc",this.version=2}},Lw=class{constructor(i){this.client=i}};var Ec={},Vl={};(function(c){Object.defineProperty(c,"__esModule",{value:!0});var i=G0,r=Al;c.DIGEST_LENGTH=64,c.BLOCK_SIZE=128;var n=function(){function v(){this.digestLength=c.DIGEST_LENGTH,this.blockSize=c.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},v.prototype.update=function(w,y){if(y===void 0&&(y=w.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<c.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=w[E++],y--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(E=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,w,E,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=w[E++],y--;return this},v.prototype.finish=function(w){if(!this._finished){var y=this._bytesHashed,E=this._bufferLength,O=y/536870912|0,R=y<<3,z=y%128<112?128:256;this._buffer[E]=128;for(var D=E+1;D<z-8;D++)this._buffer[D]=0;i.writeUint32BE(O,this._buffer,z-8),i.writeUint32BE(R,this._buffer,z-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,z),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)i.writeUint32BE(this._stateHi[D],w,D*8),i.writeUint32BE(this._stateLo[D],w,D*8+4);return this},v.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(w){return this._stateHi.set(w.stateHi),this._stateLo.set(w.stateLo),this._bufferLength=w.bufferLength,w.buffer&&this._buffer.set(w.buffer),this._bytesHashed=w.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(w){r.wipe(w.stateHi),r.wipe(w.stateLo),w.buffer&&r.wipe(w.buffer),w.bufferLength=0,w.bytesHashed=0},v}();c.SHA512=n;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(v,w,y,E,O,R,z){for(var D=y[0],V=y[1],re=y[2],ce=y[3],ue=y[4],he=y[5],fe=y[6],pe=y[7],$=E[0],k=E[1],W=E[2],ve=E[3],te=E[4],Ee=E[5],Re=E[6],et=E[7],A,j,ze,Ae,J,F,K,B;z>=128;){for(var ut=0;ut<16;ut++){var ke=8*ut+R;v[ut]=i.readUint32BE(O,ke),w[ut]=i.readUint32BE(O,ke+4)}for(var ut=0;ut<80;ut++){var Lr=D,_e=V,It=re,N=ce,T=ue,S=he,u=fe,b=pe,Z=$,oe=k,me=W,Te=ve,$e=te,xe=Ee,xt=Re,mt=et;if(A=pe,j=et,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=(ue>>>14|te<<18)^(ue>>>18|te<<14)^(te>>>9|ue<<23),j=(te>>>14|ue<<18)^(te>>>18|ue<<14)^(ue>>>9|te<<23),J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,A=ue&he^~ue&fe,j=te&Ee^~te&Re,J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,A=a[ut*2],j=a[ut*2+1],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,A=v[ut%16],j=w[ut%16],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,ze=K&65535|B<<16,Ae=J&65535|F<<16,A=ze,j=Ae,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=(D>>>28|$<<4)^($>>>2|D<<30)^($>>>7|D<<25),j=($>>>28|D<<4)^(D>>>2|$<<30)^(D>>>7|$<<25),J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,A=D&V^D&re^V&re,j=$&k^$&W^k&W,J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,b=K&65535|B<<16,mt=J&65535|F<<16,A=N,j=Te,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=ze,j=Ae,J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,N=K&65535|B<<16,Te=J&65535|F<<16,V=Lr,re=_e,ce=It,ue=N,he=T,fe=S,pe=u,D=b,k=Z,W=oe,ve=me,te=Te,Ee=$e,Re=xe,et=xt,$=mt,ut%16===15)for(var ke=0;ke<16;ke++)A=v[ke],j=w[ke],J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=v[(ke+9)%16],j=w[(ke+9)%16],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,ze=v[(ke+1)%16],Ae=w[(ke+1)%16],A=(ze>>>1|Ae<<31)^(ze>>>8|Ae<<24)^ze>>>7,j=(Ae>>>1|ze<<31)^(Ae>>>8|ze<<24)^(Ae>>>7|ze<<25),J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,ze=v[(ke+14)%16],Ae=w[(ke+14)%16],A=(ze>>>19|Ae<<13)^(Ae>>>29|ze<<3)^ze>>>6,j=(Ae>>>19|ze<<13)^(ze>>>29|Ae<<3)^(Ae>>>6|ze<<26),J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,v[ke]=K&65535|B<<16,w[ke]=J&65535|F<<16}A=D,j=$,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=y[0],j=E[0],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,y[0]=D=K&65535|B<<16,E[0]=$=J&65535|F<<16,A=V,j=k,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=y[1],j=E[1],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,y[1]=V=K&65535|B<<16,E[1]=k=J&65535|F<<16,A=re,j=W,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=y[2],j=E[2],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,y[2]=re=K&65535|B<<16,E[2]=W=J&65535|F<<16,A=ce,j=ve,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=y[3],j=E[3],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,y[3]=ce=K&65535|B<<16,E[3]=ve=J&65535|F<<16,A=ue,j=te,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=y[4],j=E[4],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,y[4]=ue=K&65535|B<<16,E[4]=te=J&65535|F<<16,A=he,j=Ee,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=y[5],j=E[5],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,y[5]=he=K&65535|B<<16,E[5]=Ee=J&65535|F<<16,A=fe,j=Re,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=y[6],j=E[6],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,y[6]=fe=K&65535|B<<16,E[6]=Re=J&65535|F<<16,A=pe,j=et,J=j&65535,F=j>>>16,K=A&65535,B=A>>>16,A=y[7],j=E[7],J+=j&65535,F+=j>>>16,K+=A&65535,B+=A>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,y[7]=pe=K&65535|B<<16,E[7]=et=J&65535|F<<16,R+=128,z-=128}return R}function d(v){var w=new n;w.update(v);var y=w.digest();return w.clean(),y}c.hash=d})(Vl);(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.convertSecretKeyToX25519=c.convertPublicKeyToX25519=c.verify=c.sign=c.extractPublicKeyFromSecretKey=c.generateKeyPair=c.generateKeyPairFromSeed=c.SEED_LENGTH=c.SECRET_KEY_LENGTH=c.PUBLIC_KEY_LENGTH=c.SIGNATURE_LENGTH=void 0;const i=Tl,r=Vl,n=Al;c.SIGNATURE_LENGTH=64,c.PUBLIC_KEY_LENGTH=32,c.SECRET_KEY_LENGTH=64,c.SEED_LENGTH=32;function a(N){const T=new Float64Array(16);if(N)for(let S=0;S<N.length;S++)T[S]=N[S];return T}const l=new Uint8Array(32);l[0]=9;const d=a(),v=a([1]),w=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),R=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function z(N,T){for(let S=0;S<16;S++)N[S]=T[S]|0}function D(N){let T=1;for(let S=0;S<16;S++){let u=N[S]+T+65535;T=Math.floor(u/65536),N[S]=u-T*65536}N[0]+=T-1+37*(T-1)}function V(N,T,S){const u=~(S-1);for(let b=0;b<16;b++){const Z=u&(N[b]^T[b]);N[b]^=Z,T[b]^=Z}}function re(N,T){const S=a(),u=a();for(let b=0;b<16;b++)u[b]=T[b];D(u),D(u),D(u);for(let b=0;b<2;b++){S[0]=u[0]-65517;for(let oe=1;oe<15;oe++)S[oe]=u[oe]-65535-(S[oe-1]>>16&1),S[oe-1]&=65535;S[15]=u[15]-32767-(S[14]>>16&1);const Z=S[15]>>16&1;S[14]&=65535,V(u,S,1-Z)}for(let b=0;b<16;b++)N[2*b]=u[b]&255,N[2*b+1]=u[b]>>8}function ce(N,T){let S=0;for(let u=0;u<32;u++)S|=N[u]^T[u];return(1&S-1>>>8)-1}function ue(N,T){const S=new Uint8Array(32),u=new Uint8Array(32);return re(S,N),re(u,T),ce(S,u)}function he(N){const T=new Uint8Array(32);return re(T,N),T[0]&1}function fe(N,T){for(let S=0;S<16;S++)N[S]=T[2*S]+(T[2*S+1]<<8);N[15]&=32767}function pe(N,T,S){for(let u=0;u<16;u++)N[u]=T[u]+S[u]}function $(N,T,S){for(let u=0;u<16;u++)N[u]=T[u]-S[u]}function k(N,T,S){let u,b,Z=0,oe=0,me=0,Te=0,$e=0,xe=0,xt=0,mt=0,nt=0,Le=0,Je=0,Qe=0,at=0,Ue=0,Ye=0,Ne=0,Ke=0,ht=0,Me=0,Pt=0,Dt=0,Ht=0,kt=0,Mt=0,Jt=0,rr=0,qr=0,Qt=0,Vr=0,oi=0,xi=0,lt=S[0],tt=S[1],ft=S[2],pt=S[3],ot=S[4],rt=S[5],St=S[6],Ot=S[7],dt=S[8],Ct=S[9],gt=S[10],wt=S[11],vt=S[12],We=S[13],Rt=S[14],At=S[15];u=T[0],Z+=u*lt,oe+=u*tt,me+=u*ft,Te+=u*pt,$e+=u*ot,xe+=u*rt,xt+=u*St,mt+=u*Ot,nt+=u*dt,Le+=u*Ct,Je+=u*gt,Qe+=u*wt,at+=u*vt,Ue+=u*We,Ye+=u*Rt,Ne+=u*At,u=T[1],oe+=u*lt,me+=u*tt,Te+=u*ft,$e+=u*pt,xe+=u*ot,xt+=u*rt,mt+=u*St,nt+=u*Ot,Le+=u*dt,Je+=u*Ct,Qe+=u*gt,at+=u*wt,Ue+=u*vt,Ye+=u*We,Ne+=u*Rt,Ke+=u*At,u=T[2],me+=u*lt,Te+=u*tt,$e+=u*ft,xe+=u*pt,xt+=u*ot,mt+=u*rt,nt+=u*St,Le+=u*Ot,Je+=u*dt,Qe+=u*Ct,at+=u*gt,Ue+=u*wt,Ye+=u*vt,Ne+=u*We,Ke+=u*Rt,ht+=u*At,u=T[3],Te+=u*lt,$e+=u*tt,xe+=u*ft,xt+=u*pt,mt+=u*ot,nt+=u*rt,Le+=u*St,Je+=u*Ot,Qe+=u*dt,at+=u*Ct,Ue+=u*gt,Ye+=u*wt,Ne+=u*vt,Ke+=u*We,ht+=u*Rt,Me+=u*At,u=T[4],$e+=u*lt,xe+=u*tt,xt+=u*ft,mt+=u*pt,nt+=u*ot,Le+=u*rt,Je+=u*St,Qe+=u*Ot,at+=u*dt,Ue+=u*Ct,Ye+=u*gt,Ne+=u*wt,Ke+=u*vt,ht+=u*We,Me+=u*Rt,Pt+=u*At,u=T[5],xe+=u*lt,xt+=u*tt,mt+=u*ft,nt+=u*pt,Le+=u*ot,Je+=u*rt,Qe+=u*St,at+=u*Ot,Ue+=u*dt,Ye+=u*Ct,Ne+=u*gt,Ke+=u*wt,ht+=u*vt,Me+=u*We,Pt+=u*Rt,Dt+=u*At,u=T[6],xt+=u*lt,mt+=u*tt,nt+=u*ft,Le+=u*pt,Je+=u*ot,Qe+=u*rt,at+=u*St,Ue+=u*Ot,Ye+=u*dt,Ne+=u*Ct,Ke+=u*gt,ht+=u*wt,Me+=u*vt,Pt+=u*We,Dt+=u*Rt,Ht+=u*At,u=T[7],mt+=u*lt,nt+=u*tt,Le+=u*ft,Je+=u*pt,Qe+=u*ot,at+=u*rt,Ue+=u*St,Ye+=u*Ot,Ne+=u*dt,Ke+=u*Ct,ht+=u*gt,Me+=u*wt,Pt+=u*vt,Dt+=u*We,Ht+=u*Rt,kt+=u*At,u=T[8],nt+=u*lt,Le+=u*tt,Je+=u*ft,Qe+=u*pt,at+=u*ot,Ue+=u*rt,Ye+=u*St,Ne+=u*Ot,Ke+=u*dt,ht+=u*Ct,Me+=u*gt,Pt+=u*wt,Dt+=u*vt,Ht+=u*We,kt+=u*Rt,Mt+=u*At,u=T[9],Le+=u*lt,Je+=u*tt,Qe+=u*ft,at+=u*pt,Ue+=u*ot,Ye+=u*rt,Ne+=u*St,Ke+=u*Ot,ht+=u*dt,Me+=u*Ct,Pt+=u*gt,Dt+=u*wt,Ht+=u*vt,kt+=u*We,Mt+=u*Rt,Jt+=u*At,u=T[10],Je+=u*lt,Qe+=u*tt,at+=u*ft,Ue+=u*pt,Ye+=u*ot,Ne+=u*rt,Ke+=u*St,ht+=u*Ot,Me+=u*dt,Pt+=u*Ct,Dt+=u*gt,Ht+=u*wt,kt+=u*vt,Mt+=u*We,Jt+=u*Rt,rr+=u*At,u=T[11],Qe+=u*lt,at+=u*tt,Ue+=u*ft,Ye+=u*pt,Ne+=u*ot,Ke+=u*rt,ht+=u*St,Me+=u*Ot,Pt+=u*dt,Dt+=u*Ct,Ht+=u*gt,kt+=u*wt,Mt+=u*vt,Jt+=u*We,rr+=u*Rt,qr+=u*At,u=T[12],at+=u*lt,Ue+=u*tt,Ye+=u*ft,Ne+=u*pt,Ke+=u*ot,ht+=u*rt,Me+=u*St,Pt+=u*Ot,Dt+=u*dt,Ht+=u*Ct,kt+=u*gt,Mt+=u*wt,Jt+=u*vt,rr+=u*We,qr+=u*Rt,Qt+=u*At,u=T[13],Ue+=u*lt,Ye+=u*tt,Ne+=u*ft,Ke+=u*pt,ht+=u*ot,Me+=u*rt,Pt+=u*St,Dt+=u*Ot,Ht+=u*dt,kt+=u*Ct,Mt+=u*gt,Jt+=u*wt,rr+=u*vt,qr+=u*We,Qt+=u*Rt,Vr+=u*At,u=T[14],Ye+=u*lt,Ne+=u*tt,Ke+=u*ft,ht+=u*pt,Me+=u*ot,Pt+=u*rt,Dt+=u*St,Ht+=u*Ot,kt+=u*dt,Mt+=u*Ct,Jt+=u*gt,rr+=u*wt,qr+=u*vt,Qt+=u*We,Vr+=u*Rt,oi+=u*At,u=T[15],Ne+=u*lt,Ke+=u*tt,ht+=u*ft,Me+=u*pt,Pt+=u*ot,Dt+=u*rt,Ht+=u*St,kt+=u*Ot,Mt+=u*dt,Jt+=u*Ct,rr+=u*gt,qr+=u*wt,Qt+=u*vt,Vr+=u*We,oi+=u*Rt,xi+=u*At,Z+=38*Ke,oe+=38*ht,me+=38*Me,Te+=38*Pt,$e+=38*Dt,xe+=38*Ht,xt+=38*kt,mt+=38*Mt,nt+=38*Jt,Le+=38*rr,Je+=38*qr,Qe+=38*Qt,at+=38*Vr,Ue+=38*oi,Ye+=38*xi,b=1,u=Z+b+65535,b=Math.floor(u/65536),Z=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,u=Te+b+65535,b=Math.floor(u/65536),Te=u-b*65536,u=$e+b+65535,b=Math.floor(u/65536),$e=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=xt+b+65535,b=Math.floor(u/65536),xt=u-b*65536,u=mt+b+65535,b=Math.floor(u/65536),mt=u-b*65536,u=nt+b+65535,b=Math.floor(u/65536),nt=u-b*65536,u=Le+b+65535,b=Math.floor(u/65536),Le=u-b*65536,u=Je+b+65535,b=Math.floor(u/65536),Je=u-b*65536,u=Qe+b+65535,b=Math.floor(u/65536),Qe=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=Ue+b+65535,b=Math.floor(u/65536),Ue=u-b*65536,u=Ye+b+65535,b=Math.floor(u/65536),Ye=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,Z+=b-1+37*(b-1),b=1,u=Z+b+65535,b=Math.floor(u/65536),Z=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,u=Te+b+65535,b=Math.floor(u/65536),Te=u-b*65536,u=$e+b+65535,b=Math.floor(u/65536),$e=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=xt+b+65535,b=Math.floor(u/65536),xt=u-b*65536,u=mt+b+65535,b=Math.floor(u/65536),mt=u-b*65536,u=nt+b+65535,b=Math.floor(u/65536),nt=u-b*65536,u=Le+b+65535,b=Math.floor(u/65536),Le=u-b*65536,u=Je+b+65535,b=Math.floor(u/65536),Je=u-b*65536,u=Qe+b+65535,b=Math.floor(u/65536),Qe=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=Ue+b+65535,b=Math.floor(u/65536),Ue=u-b*65536,u=Ye+b+65535,b=Math.floor(u/65536),Ye=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,Z+=b-1+37*(b-1),N[0]=Z,N[1]=oe,N[2]=me,N[3]=Te,N[4]=$e,N[5]=xe,N[6]=xt,N[7]=mt,N[8]=nt,N[9]=Le,N[10]=Je,N[11]=Qe,N[12]=at,N[13]=Ue,N[14]=Ye,N[15]=Ne}function W(N,T){k(N,T,T)}function ve(N,T){const S=a();let u;for(u=0;u<16;u++)S[u]=T[u];for(u=253;u>=0;u--)W(S,S),u!==2&&u!==4&&k(S,S,T);for(u=0;u<16;u++)N[u]=S[u]}function te(N,T){const S=a();let u;for(u=0;u<16;u++)S[u]=T[u];for(u=250;u>=0;u--)W(S,S),u!==1&&k(S,S,T);for(u=0;u<16;u++)N[u]=S[u]}function Ee(N,T){const S=a(),u=a(),b=a(),Z=a(),oe=a(),me=a(),Te=a(),$e=a(),xe=a();$(S,N[1],N[0]),$(xe,T[1],T[0]),k(S,S,xe),pe(u,N[0],N[1]),pe(xe,T[0],T[1]),k(u,u,xe),k(b,N[3],T[3]),k(b,b,y),k(Z,N[2],T[2]),pe(Z,Z,Z),$(oe,u,S),$(me,Z,b),pe(Te,Z,b),pe($e,u,S),k(N[0],oe,me),k(N[1],$e,Te),k(N[2],Te,me),k(N[3],oe,$e)}function Re(N,T,S){for(let u=0;u<4;u++)V(N[u],T[u],S)}function et(N,T){const S=a(),u=a(),b=a();ve(b,T[2]),k(S,T[0],b),k(u,T[1],b),re(N,u),N[31]^=he(S)<<7}function A(N,T,S){z(N[0],d),z(N[1],v),z(N[2],v),z(N[3],d);for(let u=255;u>=0;--u){const b=S[u/8|0]>>(u&7)&1;Re(N,T,b),Ee(T,N),Ee(N,N),Re(N,T,b)}}function j(N,T){const S=[a(),a(),a(),a()];z(S[0],E),z(S[1],O),z(S[2],v),k(S[3],E,O),A(N,S,T)}function ze(N){if(N.length!==c.SEED_LENGTH)throw new Error(`ed25519: seed must be ${c.SEED_LENGTH} bytes`);const T=(0,r.hash)(N);T[0]&=248,T[31]&=127,T[31]|=64;const S=new Uint8Array(32),u=[a(),a(),a(),a()];j(u,T),et(S,u);const b=new Uint8Array(64);return b.set(N),b.set(S,32),{publicKey:S,secretKey:b}}c.generateKeyPairFromSeed=ze;function Ae(N){const T=(0,i.randomBytes)(32,N),S=ze(T);return(0,n.wipe)(T),S}c.generateKeyPair=Ae;function J(N){if(N.length!==c.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${c.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(N.subarray(32))}c.extractPublicKeyFromSecretKey=J;const F=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function K(N,T){let S,u,b,Z;for(u=63;u>=32;--u){for(S=0,b=u-32,Z=u-12;b<Z;++b)T[b]+=S-16*T[u]*F[b-(u-32)],S=Math.floor((T[b]+128)/256),T[b]-=S*256;T[b]+=S,T[u]=0}for(S=0,b=0;b<32;b++)T[b]+=S-(T[31]>>4)*F[b],S=T[b]>>8,T[b]&=255;for(b=0;b<32;b++)T[b]-=S*F[b];for(u=0;u<32;u++)T[u+1]+=T[u]>>8,N[u]=T[u]&255}function B(N){const T=new Float64Array(64);for(let S=0;S<64;S++)T[S]=N[S];for(let S=0;S<64;S++)N[S]=0;K(N,T)}function ut(N,T){const S=new Float64Array(64),u=[a(),a(),a(),a()],b=(0,r.hash)(N.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const Z=new Uint8Array(64);Z.set(b.subarray(32),32);const oe=new r.SHA512;oe.update(Z.subarray(32)),oe.update(T);const me=oe.digest();oe.clean(),B(me),j(u,me),et(Z,u),oe.reset(),oe.update(Z.subarray(0,32)),oe.update(N.subarray(32)),oe.update(T);const Te=oe.digest();B(Te);for(let $e=0;$e<32;$e++)S[$e]=me[$e];for(let $e=0;$e<32;$e++)for(let xe=0;xe<32;xe++)S[$e+xe]+=Te[$e]*b[xe];return K(Z.subarray(32),S),Z}c.sign=ut;function ke(N,T){const S=a(),u=a(),b=a(),Z=a(),oe=a(),me=a(),Te=a();return z(N[2],v),fe(N[1],T),W(b,N[1]),k(Z,b,w),$(b,b,N[2]),pe(Z,N[2],Z),W(oe,Z),W(me,oe),k(Te,me,oe),k(S,Te,b),k(S,S,Z),te(S,S),k(S,S,b),k(S,S,Z),k(S,S,Z),k(N[0],S,Z),W(u,N[0]),k(u,u,Z),ue(u,b)&&k(N[0],N[0],R),W(u,N[0]),k(u,u,Z),ue(u,b)?-1:(he(N[0])===T[31]>>7&&$(N[0],d,N[0]),k(N[3],N[0],N[1]),0)}function Lr(N,T,S){const u=new Uint8Array(32),b=[a(),a(),a(),a()],Z=[a(),a(),a(),a()];if(S.length!==c.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${c.SIGNATURE_LENGTH} bytes`);if(ke(Z,N))return!1;const oe=new r.SHA512;oe.update(S.subarray(0,32)),oe.update(N),oe.update(T);const me=oe.digest();return B(me),A(b,Z,me),j(Z,S.subarray(32)),Ee(b,Z),et(u,b),!ce(S,u)}c.verify=Lr;function _e(N){let T=[a(),a(),a(),a()];if(ke(T,N))throw new Error("Ed25519: invalid public key");let S=a(),u=a(),b=T[1];pe(S,v,b),$(u,v,b),ve(u,u),k(S,S,u);let Z=new Uint8Array(32);return re(Z,S),Z}c.convertPublicKeyToX25519=_e;function It(N){const T=(0,r.hash)(N.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const S=new Uint8Array(T.subarray(0,32));return(0,n.wipe)(T),S}c.convertSecretKeyToX25519=It})(Ec);const qw="EdDSA",Mw="JWT",Fl=".",Bl="base64url",jw="utf8",zw="utf8",Uw=":",Hw="did",kw="key",Gh="base58btc",Kw="z",Vw="K36",Fw=32;function fa(c){return ga(yc(Gs(c),jw),Bl)}function Gl(c){const i=yc(Vw,Gh),r=Kw+ga(W0([i,c]),Gh);return[Hw,kw,r].join(Uw)}function Bw(c){return ga(c,Bl)}function Gw(c){return yc([fa(c.header),fa(c.payload)].join(Fl),zw)}function Ww(c){return[fa(c.header),fa(c.payload),Bw(c.signature)].join(Fl)}function Wh(c=Tl.randomBytes(Fw)){return Ec.generateKeyPairFromSeed(c)}async function Jw(c,i,r,n,a=ie.fromMiliseconds(Date.now())){const l={alg:qw,typ:Mw},d=Gl(n.publicKey),v=a+r,w={iss:d,sub:c,aud:i,iat:a,exp:v},y=Gw({header:l,payload:w}),E=Ec.sign(n.secretKey,y);return Ww({header:l,payload:w,signature:E})}const Qw=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Yw=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Jh=c=>c.split("?")[0],Qh=10,Xw=Qw();let Zw=class{constructor(i){if(this.url=i,this.events=new Kr.EventEmitter,this.registering=!1,!$h(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),i()},this.socket.close()})}async send(i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Gs(i))}catch(r){this.onError(i.id,r)}}register(i=this.url){if(!$h(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,n)=>{const a=new URLSearchParams(i).get("origin"),l=Lm.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!qm(i)},d=new Xw(i,[],l);Yw()?d.onerror=v=>{const w=v;n(this.emitError(w.error))}:d.on("error",v=>{n(this.emitError(v))}),d.onopen=()=>{this.onOpen(d),r(d)}})}onOpen(i){i.onmessage=r=>this.onPayload(r),i.onclose=r=>this.onClose(r),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?va(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const n=this.parseError(r),a=n.message||n.toString(),l=wc(i,a);this.events.emit("payload",l)}parseError(i,r=this.url){return Mm(i,Jh(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Qh&&this.events.setMaxListeners(Qh)}emitError(i){const r=this.parseError(new Error((i==null?void 0:i.message)||`WebSocket connection failed for host: ${Jh(this.url)}`));return this.events.emit("register_error",r),r}};var pa={exports:{}};pa.exports;(function(c,i){var r=200,n="__lodash_hash_undefined__",a=1,l=2,d=9007199254740991,v="[object Arguments]",w="[object Array]",y="[object AsyncFunction]",E="[object Boolean]",O="[object Date]",R="[object Error]",z="[object Function]",D="[object GeneratorFunction]",V="[object Map]",re="[object Number]",ce="[object Null]",ue="[object Object]",he="[object Promise]",fe="[object Proxy]",pe="[object RegExp]",$="[object Set]",k="[object String]",W="[object Symbol]",ve="[object Undefined]",te="[object WeakMap]",Ee="[object ArrayBuffer]",Re="[object DataView]",et="[object Float32Array]",A="[object Float64Array]",j="[object Int8Array]",ze="[object Int16Array]",Ae="[object Int32Array]",J="[object Uint8Array]",F="[object Uint8ClampedArray]",K="[object Uint16Array]",B="[object Uint32Array]",ut=/[\\^$.*+?()[\]{}|]/g,ke=/^\[object .+?Constructor\]$/,Lr=/^(?:0|[1-9]\d*)$/,_e={};_e[et]=_e[A]=_e[j]=_e[ze]=_e[Ae]=_e[J]=_e[F]=_e[K]=_e[B]=!0,_e[v]=_e[w]=_e[Ee]=_e[E]=_e[Re]=_e[O]=_e[R]=_e[z]=_e[V]=_e[re]=_e[ue]=_e[pe]=_e[$]=_e[k]=_e[te]=!1;var It=typeof ta=="object"&&ta&&ta.Object===Object&&ta,N=typeof self=="object"&&self&&self.Object===Object&&self,T=It||N||Function("return this")(),S=i&&!i.nodeType&&i,u=S&&!0&&c&&!c.nodeType&&c,b=u&&u.exports===S,Z=b&&It.process,oe=function(){try{return Z&&Z.binding&&Z.binding("util")}catch{}}(),me=oe&&oe.isTypedArray;function Te(g,I){for(var U=-1,Q=g==null?0:g.length,Fe=0,de=[];++U<Q;){var Xe=g[U];I(Xe,U,g)&&(de[Fe++]=Xe)}return de}function $e(g,I){for(var U=-1,Q=I.length,Fe=g.length;++U<Q;)g[Fe+U]=I[U];return g}function xe(g,I){for(var U=-1,Q=g==null?0:g.length;++U<Q;)if(I(g[U],U,g))return!0;return!1}function xt(g,I){for(var U=-1,Q=Array(g);++U<g;)Q[U]=I(U);return Q}function mt(g){return function(I){return g(I)}}function nt(g,I){return g.has(I)}function Le(g,I){return g==null?void 0:g[I]}function Je(g){var I=-1,U=Array(g.size);return g.forEach(function(Q,Fe){U[++I]=[Fe,Q]}),U}function Qe(g,I){return function(U){return g(I(U))}}function at(g){var I=-1,U=Array(g.size);return g.forEach(function(Q){U[++I]=Q}),U}var Ue=Array.prototype,Ye=Function.prototype,Ne=Object.prototype,Ke=T["__core-js_shared__"],ht=Ye.toString,Me=Ne.hasOwnProperty,Pt=function(){var g=/[^.]+$/.exec(Ke&&Ke.keys&&Ke.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Dt=Ne.toString,Ht=RegExp("^"+ht.call(Me).replace(ut,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=b?T.Buffer:void 0,Mt=T.Symbol,Jt=T.Uint8Array,rr=Ne.propertyIsEnumerable,qr=Ue.splice,Qt=Mt?Mt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,oi=kt?kt.isBuffer:void 0,xi=Qe(Object.keys,Object),lt=lr(T,"DataView"),tt=lr(T,"Map"),ft=lr(T,"Promise"),pt=lr(T,"Set"),ot=lr(T,"WeakMap"),rt=lr(Object,"create"),St=Br(lt),Ot=Br(tt),dt=Br(ft),Ct=Br(pt),gt=Br(ot),wt=Mt?Mt.prototype:void 0,vt=wt?wt.valueOf:void 0;function We(g){var I=-1,U=g==null?0:g.length;for(this.clear();++I<U;){var Q=g[I];this.set(Q[0],Q[1])}}function Rt(){this.__data__=rt?rt(null):{},this.size=0}function At(g){var I=this.has(g)&&delete this.__data__[g];return this.size-=I?1:0,I}function _a(g){var I=this.__data__;if(rt){var U=I[g];return U===n?void 0:U}return Me.call(I,g)?I[g]:void 0}function ba(g){var I=this.__data__;return rt?I[g]!==void 0:Me.call(I,g)}function Ea(g,I){var U=this.__data__;return this.size+=this.has(g)?0:1,U[g]=rt&&I===void 0?n:I,this}We.prototype.clear=Rt,We.prototype.delete=At,We.prototype.get=_a,We.prototype.has=ba,We.prototype.set=Ea;function yr(g){var I=-1,U=g==null?0:g.length;for(this.clear();++I<U;){var Q=g[I];this.set(Q[0],Q[1])}}function Ia(){this.__data__=[],this.size=0}function xa(g){var I=this.__data__,U=Pi(I,g);if(U<0)return!1;var Q=I.length-1;return U==Q?I.pop():qr.call(I,U,1),--this.size,!0}function Pa(g){var I=this.__data__,U=Pi(I,g);return U<0?void 0:I[U][1]}function Sa(g){return Pi(this.__data__,g)>-1}function Oa(g,I){var U=this.__data__,Q=Pi(U,g);return Q<0?(++this.size,U.push([g,I])):U[Q][1]=I,this}yr.prototype.clear=Ia,yr.prototype.delete=xa,yr.prototype.get=Pa,yr.prototype.has=Sa,yr.prototype.set=Oa;function Fr(g){var I=-1,U=g==null?0:g.length;for(this.clear();++I<U;){var Q=g[I];this.set(Q[0],Q[1])}}function Ki(){this.size=0,this.__data__={hash:new We,map:new(tt||yr),string:new We}}function Ca(g){var I=ci(this,g).delete(g);return this.size-=I?1:0,I}function Vi(g){return ci(this,g).get(g)}function Ra(g){return ci(this,g).has(g)}function Aa(g,I){var U=ci(this,g),Q=U.size;return U.set(g,I),this.size+=U.size==Q?0:1,this}Fr.prototype.clear=Ki,Fr.prototype.delete=Ca,Fr.prototype.get=Vi,Fr.prototype.has=Ra,Fr.prototype.set=Aa;function Fi(g){var I=-1,U=g==null?0:g.length;for(this.__data__=new Fr;++I<U;)this.add(g[I])}function Qs(g){return this.__data__.set(g,n),this}function Ys(g){return this.__data__.has(g)}Fi.prototype.add=Fi.prototype.push=Qs,Fi.prototype.has=Ys;function Or(g){var I=this.__data__=new yr(g);this.size=I.size}function Ta(){this.__data__=new yr,this.size=0}function Na(g){var I=this.__data__,U=I.delete(g);return this.size=I.size,U}function $a(g){return this.__data__.get(g)}function Da(g){return this.__data__.has(g)}function Xs(g,I){var U=this.__data__;if(U instanceof yr){var Q=U.__data__;if(!tt||Q.length<r-1)return Q.push([g,I]),this.size=++U.size,this;U=this.__data__=new Fr(Q)}return U.set(g,I),this.size=U.size,this}Or.prototype.clear=Ta,Or.prototype.delete=Na,Or.prototype.get=$a,Or.prototype.has=Da,Or.prototype.set=Xs;function Zs(g,I){var U=Wi(g),Q=!U&&fn(g),Fe=!U&&!Q&&ys(g),de=!U&&!Q&&!Fe&&gn(g),Xe=U||Q||Fe||de,Tt=Xe?xt(g.length,String):[],Oe=Tt.length;for(var Be in g)(I||Me.call(g,Be))&&!(Xe&&(Be=="length"||Fe&&(Be=="offset"||Be=="parent")||de&&(Be=="buffer"||Be=="byteLength"||Be=="byteOffset")||on(Be,Oe)))&&Tt.push(Be);return Tt}function Pi(g,I){for(var U=g.length;U--;)if(ln(g[U][0],I))return U;return-1}function gs(g,I,U){var Q=I(g);return Wi(g)?Q:$e(Q,U(g))}function Si(g){return g==null?g===void 0?ve:ce:Qt&&Qt in Object(g)?nn(g):Ma(g)}function vs(g){return Ci(g)&&Si(g)==v}function Oi(g,I,U,Q,Fe){return g===I?!0:g==null||I==null||!Ci(g)&&!Ci(I)?g!==g&&I!==I:en(g,I,U,Q,Oi,Fe)}function en(g,I,U,Q,Fe,de){var Xe=Wi(g),Tt=Wi(I),Oe=Xe?w:Mr(g),Be=Tt?w:Mr(I);Oe=Oe==v?ue:Oe,Be=Be==v?ue:Be;var _t=Oe==ue,ir=Be==ue,Nt=Oe==Be;if(Nt&&ys(g)){if(!ys(I))return!1;Xe=!0,_t=!1}if(Nt&&!_t)return de||(de=new Or),Xe||gn(g)?Bi(g,I,U,Q,Fe,de):qa(g,I,Oe,U,Q,Fe,de);if(!(U&a)){var Ze=_t&&Me.call(g,"__wrapped__"),Yt=ir&&Me.call(I,"__wrapped__");if(Ze||Yt){var Cr=Ze?g.value():g,mr=Yt?I.value():I;return de||(de=new Or),Fe(Cr,mr,U,Q,de)}}return Nt?(de||(de=new Or),sn(g,I,U,Q,Fe,de)):!1}function La(g){if(!dn(g)||un(g))return!1;var I=Ji(g)?Ht:ke;return I.test(Br(g))}function tn(g){return Ci(g)&&pn(g.length)&&!!_e[Si(g)]}function rn(g){if(!hn(g))return xi(g);var I=[];for(var U in Object(g))Me.call(g,U)&&U!="constructor"&&I.push(U);return I}function Bi(g,I,U,Q,Fe,de){var Xe=U&a,Tt=g.length,Oe=I.length;if(Tt!=Oe&&!(Xe&&Oe>Tt))return!1;var Be=de.get(g);if(Be&&de.get(I))return Be==I;var _t=-1,ir=!0,Nt=U&l?new Fi:void 0;for(de.set(g,I),de.set(I,g);++_t<Tt;){var Ze=g[_t],Yt=I[_t];if(Q)var Cr=Xe?Q(Yt,Ze,_t,I,g,de):Q(Ze,Yt,_t,g,I,de);if(Cr!==void 0){if(Cr)continue;ir=!1;break}if(Nt){if(!xe(I,function(mr,jr){if(!nt(Nt,jr)&&(Ze===mr||Fe(Ze,mr,U,Q,de)))return Nt.push(jr)})){ir=!1;break}}else if(!(Ze===Yt||Fe(Ze,Yt,U,Q,de))){ir=!1;break}}return de.delete(g),de.delete(I),ir}function qa(g,I,U,Q,Fe,de,Xe){switch(U){case Re:if(g.byteLength!=I.byteLength||g.byteOffset!=I.byteOffset)return!1;g=g.buffer,I=I.buffer;case Ee:return!(g.byteLength!=I.byteLength||!de(new Jt(g),new Jt(I)));case E:case O:case re:return ln(+g,+I);case R:return g.name==I.name&&g.message==I.message;case pe:case k:return g==I+"";case V:var Tt=Je;case $:var Oe=Q&a;if(Tt||(Tt=at),g.size!=I.size&&!Oe)return!1;var Be=Xe.get(g);if(Be)return Be==I;Q|=l,Xe.set(g,I);var _t=Bi(Tt(g),Tt(I),Q,Fe,de,Xe);return Xe.delete(g),_t;case W:if(vt)return vt.call(g)==vt.call(I)}return!1}function sn(g,I,U,Q,Fe,de){var Xe=U&a,Tt=Gi(g),Oe=Tt.length,Be=Gi(I),_t=Be.length;if(Oe!=_t&&!Xe)return!1;for(var ir=Oe;ir--;){var Nt=Tt[ir];if(!(Xe?Nt in I:Me.call(I,Nt)))return!1}var Ze=de.get(g);if(Ze&&de.get(I))return Ze==I;var Yt=!0;de.set(g,I),de.set(I,g);for(var Cr=Xe;++ir<Oe;){Nt=Tt[ir];var mr=g[Nt],jr=I[Nt];if(Q)var ms=Xe?Q(jr,mr,Nt,I,g,de):Q(mr,jr,Nt,g,I,de);if(!(ms===void 0?mr===jr||Fe(mr,jr,U,Q,de):ms)){Yt=!1;break}Cr||(Cr=Nt=="constructor")}if(Yt&&!Cr){var Ri=g.constructor,jt=I.constructor;Ri!=jt&&"constructor"in g&&"constructor"in I&&!(typeof Ri=="function"&&Ri instanceof Ri&&typeof jt=="function"&&jt instanceof jt)&&(Yt=!1)}return de.delete(g),de.delete(I),Yt}function Gi(g){return gs(g,Ua,an)}function ci(g,I){var U=g.__data__;return cn(I)?U[typeof I=="string"?"string":"hash"]:U.map}function lr(g,I){var U=Le(g,I);return La(U)?U:void 0}function nn(g){var I=Me.call(g,Qt),U=g[Qt];try{g[Qt]=void 0;var Q=!0}catch{}var Fe=Dt.call(g);return Q&&(I?g[Qt]=U:delete g[Qt]),Fe}var an=Vr?function(g){return g==null?[]:(g=Object(g),Te(Vr(g),function(I){return rr.call(g,I)}))}:Ve,Mr=Si;(lt&&Mr(new lt(new ArrayBuffer(1)))!=Re||tt&&Mr(new tt)!=V||ft&&Mr(ft.resolve())!=he||pt&&Mr(new pt)!=$||ot&&Mr(new ot)!=te)&&(Mr=function(g){var I=Si(g),U=I==ue?g.constructor:void 0,Q=U?Br(U):"";if(Q)switch(Q){case St:return Re;case Ot:return V;case dt:return he;case Ct:return $;case gt:return te}return I});function on(g,I){return I=I??d,!!I&&(typeof g=="number"||Lr.test(g))&&g>-1&&g%1==0&&g<I}function cn(g){var I=typeof g;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?g!=="__proto__":g===null}function un(g){return!!Pt&&Pt in g}function hn(g){var I=g&&g.constructor,U=typeof I=="function"&&I.prototype||Ne;return g===U}function Ma(g){return Dt.call(g)}function Br(g){if(g!=null){try{return ht.call(g)}catch{}try{return g+""}catch{}}return""}function ln(g,I){return g===I||g!==g&&I!==I}var fn=vs(function(){return arguments}())?vs:function(g){return Ci(g)&&Me.call(g,"callee")&&!rr.call(g,"callee")},Wi=Array.isArray;function ja(g){return g!=null&&pn(g.length)&&!Ji(g)}var ys=oi||He;function za(g,I){return Oi(g,I)}function Ji(g){if(!dn(g))return!1;var I=Si(g);return I==z||I==D||I==y||I==fe}function pn(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=d}function dn(g){var I=typeof g;return g!=null&&(I=="object"||I=="function")}function Ci(g){return g!=null&&typeof g=="object"}var gn=me?mt(me):tn;function Ua(g){return ja(g)?Zs(g):rn(g)}function Ve(){return[]}function He(){return!1}c.exports=za})(pa,pa.exports);var e_=pa.exports;const t_=Nl(e_);function r_(c,i){return i=i||{},new Promise(function(r,n){var a=new XMLHttpRequest,l=[],d=[],v={},w=function(){return{ok:(a.status/100|0)==2,statusText:a.statusText,status:a.status,url:a.responseURL,text:function(){return Promise.resolve(a.responseText)},json:function(){return Promise.resolve(a.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([a.response]))},clone:w,headers:{keys:function(){return l},entries:function(){return d},get:function(E){return v[E.toLowerCase()]},has:function(E){return E.toLowerCase()in v}}}};for(var y in a.open(i.method||"get",c,!0),a.onload=function(){a.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(E,O,R){l.push(O=O.toLowerCase()),d.push([O,R]),v[O]=v[O]?v[O]+","+R:R}),r(w())},a.onerror=n,a.withCredentials=i.credentials=="include",i.headers)a.setRequestHeader(y,i.headers[y]);a.send(i.body||null)})}const i_=Object.freeze(Object.defineProperty({__proto__:null,default:r_},Symbol.toStringTag,{value:"Module"})),Yh=Rl(i_);var s_=self.fetch||(self.fetch=Yh.default||Yh);const n_=Nl(s_);var a_={};function o_(c,i){if(c.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var a=0;a<c.length;a++){var l=c.charAt(a),d=l.charCodeAt(0);if(r[d]!==255)throw new TypeError(l+" is ambiguous");r[d]=a}var v=c.length,w=c.charAt(0),y=Math.log(v)/Math.log(256),E=Math.log(256)/Math.log(v);function O(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var V=0,re=0,ce=0,ue=D.length;ce!==ue&&D[ce]===0;)ce++,V++;for(var he=(ue-ce)*E+1>>>0,fe=new Uint8Array(he);ce!==ue;){for(var pe=D[ce],$=0,k=he-1;(pe!==0||$<re)&&k!==-1;k--,$++)pe+=256*fe[k]>>>0,fe[k]=pe%v>>>0,pe=pe/v>>>0;if(pe!==0)throw new Error("Non-zero carry");re=$,ce++}for(var W=he-re;W!==he&&fe[W]===0;)W++;for(var ve=w.repeat(V);W<he;++W)ve+=c.charAt(fe[W]);return ve}function R(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var V=0;if(D[V]!==" "){for(var re=0,ce=0;D[V]===w;)re++,V++;for(var ue=(D.length-V)*y+1>>>0,he=new Uint8Array(ue);D[V];){var fe=r[D.charCodeAt(V)];if(fe===255)return;for(var pe=0,$=ue-1;(fe!==0||pe<ce)&&$!==-1;$--,pe++)fe+=v*he[$]>>>0,he[$]=fe%256>>>0,fe=fe/256>>>0;if(fe!==0)throw new Error("Non-zero carry");ce=pe,V++}if(D[V]!==" "){for(var k=ue-ce;k!==ue&&he[k]===0;)k++;for(var W=new Uint8Array(re+(ue-k)),ve=re;k!==ue;)W[ve++]=he[k++];return W}}}function z(D){var V=R(D);if(V)return V;throw new Error(`Non-${i} character`)}return{encode:O,decodeUnsafe:R,decode:z}}var c_=o_,u_=c_;const Wl=c=>{if(c instanceof Uint8Array&&c.constructor.name==="Uint8Array")return c;if(c instanceof ArrayBuffer)return new Uint8Array(c);if(ArrayBuffer.isView(c))return new Uint8Array(c.buffer,c.byteOffset,c.byteLength);throw new Error("Unknown type, must be binary type")},h_=c=>new TextEncoder().encode(c),l_=c=>new TextDecoder().decode(c);class f_{constructor(i,r,n){this.name=i,this.prefix=r,this.baseEncode=n}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class p_{constructor(i,r,n){if(this.name=i,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return Jl(this,i)}}class d_{constructor(i){this.decoders=i}or(i){return Jl(this,i)}decode(i){const r=i[0],n=this.decoders[r];if(n)return n.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Jl=(c,i)=>new d_({...c.decoders||{[c.prefix]:c},...i.decoders||{[i.prefix]:i}});class g_{constructor(i,r,n,a){this.name=i,this.prefix=r,this.baseEncode=n,this.baseDecode=a,this.encoder=new f_(i,r,n),this.decoder=new p_(i,r,a)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const ma=({name:c,prefix:i,encode:r,decode:n})=>new g_(c,i,r,n),Js=({prefix:c,name:i,alphabet:r})=>{const{encode:n,decode:a}=u_(r,i);return ma({prefix:c,name:i,encode:n,decode:l=>Wl(a(l))})},v_=(c,i,r,n)=>{const a={};for(let E=0;E<i.length;++E)a[i[E]]=E;let l=c.length;for(;c[l-1]==="=";)--l;const d=new Uint8Array(l*r/8|0);let v=0,w=0,y=0;for(let E=0;E<l;++E){const O=a[c[E]];if(O===void 0)throw new SyntaxError(`Non-${n} character`);w=w<<r|O,v+=r,v>=8&&(v-=8,d[y++]=255&w>>v)}if(v>=r||255&w<<8-v)throw new SyntaxError("Unexpected end of data");return d},y_=(c,i,r)=>{const n=i[i.length-1]==="=",a=(1<<r)-1;let l="",d=0,v=0;for(let w=0;w<c.length;++w)for(v=v<<8|c[w],d+=8;d>r;)d-=r,l+=i[a&v>>d];if(d&&(l+=i[a&v<<r-d]),n)for(;l.length*r&7;)l+="=";return l},Vt=({name:c,prefix:i,bitsPerChar:r,alphabet:n})=>ma({prefix:i,name:c,encode(a){return y_(a,n,r)},decode(a){return v_(a,n,r,c)}}),m_=ma({prefix:"\0",name:"identity",encode:c=>l_(c),decode:c=>h_(c)});var w_=Object.freeze({__proto__:null,identity:m_});const __=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var b_=Object.freeze({__proto__:null,base2:__});const E_=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var I_=Object.freeze({__proto__:null,base8:E_});const x_=Js({prefix:"9",name:"base10",alphabet:"0123456789"});var P_=Object.freeze({__proto__:null,base10:x_});const S_=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),O_=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var C_=Object.freeze({__proto__:null,base16:S_,base16upper:O_});const R_=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),A_=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),T_=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),N_=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$_=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),D_=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),L_=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),q_=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),M_=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var j_=Object.freeze({__proto__:null,base32:R_,base32upper:A_,base32pad:T_,base32padupper:N_,base32hex:$_,base32hexupper:D_,base32hexpad:L_,base32hexpadupper:q_,base32z:M_});const z_=Js({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),U_=Js({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var H_=Object.freeze({__proto__:null,base36:z_,base36upper:U_});const k_=Js({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),K_=Js({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var V_=Object.freeze({__proto__:null,base58btc:k_,base58flickr:K_});const F_=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),B_=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),G_=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),W_=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var J_=Object.freeze({__proto__:null,base64:F_,base64pad:B_,base64url:G_,base64urlpad:W_});const Ql=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Q_=Ql.reduce((c,i,r)=>(c[r]=i,c),[]),Y_=Ql.reduce((c,i,r)=>(c[i.codePointAt(0)]=r,c),[]);function X_(c){return c.reduce((i,r)=>(i+=Q_[r],i),"")}function Z_(c){const i=[];for(const r of c){const n=Y_[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);i.push(n)}return new Uint8Array(i)}const eb=ma({prefix:"🚀",name:"base256emoji",encode:X_,decode:Z_});var tb=Object.freeze({__proto__:null,base256emoji:eb}),rb=Yl,Xh=128,ib=127,sb=~ib,nb=Math.pow(2,31);function Yl(c,i,r){i=i||[],r=r||0;for(var n=r;c>=nb;)i[r++]=c&255|Xh,c/=128;for(;c&sb;)i[r++]=c&255|Xh,c>>>=7;return i[r]=c|0,Yl.bytes=r-n+1,i}var ab=lc,ob=128,Zh=127;function lc(c,n){var r=0,n=n||0,a=0,l=n,d,v=c.length;do{if(l>=v)throw lc.bytes=0,new RangeError("Could not decode varint");d=c[l++],r+=a<28?(d&Zh)<<a:(d&Zh)*Math.pow(2,a),a+=7}while(d>=ob);return lc.bytes=l-n,r}var cb=Math.pow(2,7),ub=Math.pow(2,14),hb=Math.pow(2,21),lb=Math.pow(2,28),fb=Math.pow(2,35),pb=Math.pow(2,42),db=Math.pow(2,49),gb=Math.pow(2,56),vb=Math.pow(2,63),yb=function(c){return c<cb?1:c<ub?2:c<hb?3:c<lb?4:c<fb?5:c<pb?6:c<db?7:c<gb?8:c<vb?9:10},mb={encode:rb,decode:ab,encodingLength:yb},Xl=mb;const el=(c,i,r=0)=>(Xl.encode(c,i,r),i),tl=c=>Xl.encodingLength(c),fc=(c,i)=>{const r=i.byteLength,n=tl(c),a=n+tl(r),l=new Uint8Array(a+r);return el(c,l,0),el(r,l,n),l.set(i,a),new wb(c,r,i,l)};class wb{constructor(i,r,n,a){this.code=i,this.size=r,this.digest=n,this.bytes=a}}const Zl=({name:c,code:i,encode:r})=>new _b(c,i,r);class _b{constructor(i,r,n){this.name=i,this.code=r,this.encode=n}digest(i){if(i instanceof Uint8Array){const r=this.encode(i);return r instanceof Uint8Array?fc(this.code,r):r.then(n=>fc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ef=c=>async i=>new Uint8Array(await crypto.subtle.digest(c,i)),bb=Zl({name:"sha2-256",code:18,encode:ef("SHA-256")}),Eb=Zl({name:"sha2-512",code:19,encode:ef("SHA-512")});var Ib=Object.freeze({__proto__:null,sha256:bb,sha512:Eb});const tf=0,xb="identity",rf=Wl,Pb=c=>fc(tf,rf(c)),Sb={code:tf,name:xb,encode:rf,digest:Pb};var Ob=Object.freeze({__proto__:null,identity:Sb});new TextEncoder,new TextDecoder;const rl={...w_,...b_,...I_,...P_,...C_,...j_,...H_,...V_,...J_,...tb};({...Ib,...Ob});function sf(c){return globalThis.Buffer!=null?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):c}function Cb(c=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?sf(globalThis.Buffer.allocUnsafe(c)):new Uint8Array(c)}function nf(c,i,r,n){return{name:c,prefix:i,encoder:{name:c,prefix:i,encode:r},decoder:{decode:n}}}const il=nf("utf8","u",c=>"u"+new TextDecoder("utf8").decode(c),c=>new TextEncoder().encode(c.substring(1))),Zo=nf("ascii","a",c=>{let i="a";for(let r=0;r<c.length;r++)i+=String.fromCharCode(c[r]);return i},c=>{c=c.substring(1);const i=Cb(c.length);for(let r=0;r<c.length;r++)i[r]=c.charCodeAt(r);return i}),Rb={utf8:il,"utf-8":il,hex:rl.base16,latin1:Zo,ascii:Zo,binary:Zo,...rl};function Ab(c,i="utf8"){const r=Rb[i];if(!r)throw new Error(`Unsupported encoding "${i}"`);return(i==="utf8"||i==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?sf(globalThis.Buffer.from(c,"utf-8")):r.decoder.decode(`${r.prefix}${c}`)}const af="wc",Tb=2,Ic="core",bi=`${af}@2:${Ic}:`,Nb={name:Ic,logger:"error"},$b={database:":memory:"},Db="crypto",sl="client_ed25519_seed",Lb=ie.ONE_DAY,qb="keychain",Mb="0.3",jb="messages",zb="0.3",Ub=ie.SIX_HOURS,Hb="publisher",of="irn",kb="error",cf="wss://relay.walletconnect.com",nl="wss://relay.walletconnect.org",Kb="relayer",Wt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Vb="_subscription",ri={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Fb=ie.ONE_SECOND,Bb="2.11.0",Gb=1e4,Wb="0.3",Jb="WALLETCONNECT_CLIENT_ID",$r={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Qb="subscription",Yb="0.3",Xb=ie.FIVE_SECONDS*1e3,Zb="pairing",e1="0.3",qs={wc_pairingDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:0},res:{ttl:ie.ONE_DAY,prompt:!1,tag:0}}},ks={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},t1="history",r1="0.3",i1="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},s1="0.3",ec="verify-api",ls="https://verify.walletconnect.com",pc="https://verify.walletconnect.org",n1=[ls,pc],a1="echo",o1="https://echo.walletconnect.com";class c1{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name=qb,this.version=Mb,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,a)=>{this.isInitialized(),this.keychain.set(n,a),await this.persist()},this.get=n=>{this.isInitialized();const a=this.keychain.get(n);if(typeof a>"u"){const{message:l}=Y("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(l)}return a},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=i,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,ql(i))}async getKeyChain(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Ml(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}}}class u1{constructor(i,r,n){this.core=i,this.logger=r,this.name=Db,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=Wh(a);return Gl(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Y0();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),d=Wh(l),v=cc();return await Jw(v,a,Lb,d)},this.generateSharedKey=(a,l,d)=>{this.isInitialized();const v=this.getPrivateKey(a),w=X0(v,l);return this.setSymKey(w,d)},this.setSymKey=async(a,l)=>{this.isInitialized();const d=l||Z0(a);return await this.keychain.set(d,a),d},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,d)=>{this.isInitialized();const v=em(d),w=Gs(l);if(Oh(v)){const R=v.senderPublicKey,z=v.receiverPublicKey;a=await this.generateSharedKey(R,z)}const y=this.getSymKey(a),{type:E,senderPublicKey:O}=v;return tm({type:E,symKey:y,message:w,senderPublicKey:O})},this.decode=async(a,l,d)=>{this.isInitialized();const v=rm(l,d);if(Oh(v)){const w=v.receiverPublicKey,y=v.senderPublicKey;a=await this.generateSharedKey(w,y)}try{const w=this.getSymKey(a),y=im({symKey:w,encoded:l});return va(y)}catch(w){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(w)}},this.getPayloadType=a=>{const l=Ch(a);return sm(l.type)},this.getPayloadSenderPublicKey=a=>{const l=Ch(a);return l.senderPublicKey?ga(l.senderPublicKey,nm):void 0},this.core=i,this.logger=Se.generateChildLogger(r,this.name),this.keychain=n||new c1(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(sl)}catch{i=cc(),await this.keychain.set(sl,i)}return Ab(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}}}class h1 extends Sw{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name=jb,this.version=zb,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,a)=>{this.isInitialized();const l=fs(a);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[l]<"u"||(d[l]=a,this.messages.set(n,d),await this.persist()),l},this.get=n=>{this.isInitialized();let a=this.messages.get(n);return typeof a>"u"&&(a={}),a},this.has=(n,a)=>{this.isInitialized();const l=this.get(n),d=fs(a);return typeof l[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Se.generateChildLogger(i,this.name),this.core=r}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,ql(i))}async getRelayerMessages(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Ml(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}}}class l1 extends Ow{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new Kr.EventEmitter,this.name=Hb,this.queue=new Map,this.publishTimeout=ie.toMiliseconds(ie.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,a,l)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:l}});try{const v=(l==null?void 0:l.ttl)||Ub,w=uc(l),y=(l==null?void 0:l.prompt)||!1,E=(l==null?void 0:l.tag)||0,O=(l==null?void 0:l.id)||jm().toString(),R={topic:n,message:a,opts:{ttl:v,relay:w,prompt:y,tag:E,id:O}},z=setTimeout(()=>this.queue.set(O,R),this.publishTimeout);try{await await Fs(this.rpcPublish(n,a,v,w,y,E,O),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(O),this.relayer.events.emit(Wt.publish,R)}catch(D){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=l==null?void 0:l.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(O),D;return}finally{clearTimeout(z)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:l}})}catch(v){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(v),v}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.relayer=i,this.logger=Se.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(i,r,n,a,l,d,v){var w,y,E,O;const R={method:ca(a.protocol).publish,params:{topic:i,message:r,ttl:n,prompt:l,tag:d},id:v};return _i((w=R.params)==null?void 0:w.prompt)&&((y=R.params)==null||delete y.prompt),_i((E=R.params)==null?void 0:E.tag)&&((O=R.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:R}),this.relayer.request(R)}removeRequestFromQueue(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{const{topic:r,message:n,opts:a}=i;await this.publish(r,n,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Wt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Wt.message_ack,i=>{this.removeRequestFromQueue(i.id.toString())})}}class f1{constructor(){this.map=new Map,this.set=(i,r)=>{const n=this.get(i);this.exists(i,r)||this.map.set(i,[...n,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;const n=this.get(i);if(!this.exists(i,r))return;const a=n.filter(l=>l!==r);if(!a.length){this.map.delete(i);return}this.map.set(i,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var p1=Object.defineProperty,d1=Object.defineProperties,g1=Object.getOwnPropertyDescriptors,al=Object.getOwnPropertySymbols,v1=Object.prototype.hasOwnProperty,y1=Object.prototype.propertyIsEnumerable,ol=(c,i,r)=>i in c?p1(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,Ms=(c,i)=>{for(var r in i||(i={}))v1.call(i,r)&&ol(c,r,i[r]);if(al)for(var r of al(i))y1.call(i,r)&&ol(c,r,i[r]);return c},tc=(c,i)=>d1(c,g1(i));class m1 extends Aw{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new f1,this.events=new Kr.EventEmitter,this.name=Qb,this.version=Yb,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=bi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}});try{const l=uc(a),d={topic:n,relay:l};this.pending.set(n,d);const v=await this.rpcSubscribe(n,l);return this.onSubscribe(v,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}}),v}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(n,a.id,a):await this.unsubscribeByTopic(n,a)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((a,l)=>{const d=new ie.Watch;d.start(this.pendingSubscriptionWatchLabel);const v=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),a(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=Xb&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=Se.generateChildLogger(r,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let n=!1;try{n=this.getSubscription(i).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){const n=this.topicMap.get(i);await Promise.all(n.map(async a=>await this.unsubscribeById(i,a,r)))}async unsubscribeById(i,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}});try{const a=uc(n);await this.rpcUnsubscribe(i,r,a);const l=Gt("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(i,r){const n={method:ca(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Fs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}return fs(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;const r=i[0].relay,n={method:ca(r.protocol).batchSubscribe,params:{topics:i.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Fs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}}rpcUnsubscribe(i,r,n){const a={method:ca(n.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(i,r){this.setSubscription(i,tc(Ms({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(r=>{this.setSubscription(r.id,Ms({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(i,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,n),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,Ms({},r)),this.topicMap.set(r.topic,i),this.events.emit($r.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});const r=this.subscriptions.get(i);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});const n=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(n.topic,i),this.events.emit($r.deleted,tc(Ms({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit($r.sync)}async reset(){if(this.cached.length){const i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit($r.resubscribed)}async restore(){try{const i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;const r=await this.rpcBatchSubscribe(i);ps(r)&&this.onBatchSubscribe(r.map((n,a)=>tc(Ms({},i[a]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Wt.connect,async()=>{await this.onConnect()}),this.relayer.on(Wt.disconnect,()=>{this.onDisconnect()}),this.events.on($r.created,async i=>{const r=$r.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on($r.deleted,async i=>{const r=$r.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}}var w1=Object.defineProperty,cl=Object.getOwnPropertySymbols,_1=Object.prototype.hasOwnProperty,b1=Object.prototype.propertyIsEnumerable,ul=(c,i,r)=>i in c?w1(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,E1=(c,i)=>{for(var r in i||(i={}))_1.call(i,r)&&ul(c,r,i[r]);if(cl)for(var r of cl(i))b1.call(i,r)&&ul(c,r,i[r]);return c};class I1 extends Cw{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new Kr.EventEmitter,this.name=Kb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Wt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Wt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ri.payload,this.onPayloadHandler),this.provider.on(ri.connect,this.onConnectHandler),this.provider.on(ri.disconnect,this.onDisconnectHandler),this.provider.on(ri.error,this.onProviderErrorHandler)},this.core=i.core,this.logger=typeof i.logger<"u"&&typeof i.logger!="string"?Se.generateChildLogger(i.logger,this.name):Se.pino(Se.getDefaultLoggerOptions({level:i.logger||kb})),this.messages=new h1(this.logger,i.core),this.subscriber=new m1(this,this.logger),this.publisher=new l1(this,this.logger),this.relayUrl=(i==null?void 0:i.relayUrl)||cf,this.projectId=i.projectId,this.bundleId=am(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${nl}...`),await this.restartTransport(nl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},Gb)}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,n){this.isInitialized(),await this.publisher.publish(i,r,n),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var n;this.isInitialized();let a=((n=this.subscriber.topicMap.get(i))==null?void 0:n[0])||"";if(a)return a;let l;const d=v=>{v.topic===i&&(this.subscriber.off($r.created,d),l())};return await Promise.all([new Promise(v=>{l=v,this.subscriber.on($r.created,d)}),new Promise(async v=>{a=await this.subscriber.subscribe(i,r),v()})]),a}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Fs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(i){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){i&&i!==this.relayUrl&&(this.relayUrl=i,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once($r.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Fs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){n(a);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(ri.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(i){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=i||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Rh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ni(new Zw(om({sdkVersion:Bb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(i){const{topic:r,message:n}=i;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(i){const{topic:r,message:n}=i;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,n);return a&&this.logger.debug(`Ignoring duplicate message: ${n}`),a}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),_c(i)){if(!i.method.endsWith(Vb))return;const r=i.params,{topic:n,message:a,publishedAt:l}=r.data,d={topic:n,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(E1({type:"event",event:r.id},d)),this.events.emit(r.id,d),await this.acknowledgePayload(i),await this.onMessageEvent(d)}else bc(i)&&this.events.emit(Wt.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(Wt.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){const r=ya(i.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(ri.payload,this.onPayloadHandler),this.provider.off(ri.connect,this.onConnectHandler),this.provider.off(ri.disconnect,this.onDisconnectHandler),this.provider.off(ri.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Wt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let i=await Rh();cm(async r=>{this.initialized&&i!==r&&(i=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Wt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(i=>this.logger.error(i))},ie.toMiliseconds(Fb)))}isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(i=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var x1=Object.defineProperty,hl=Object.getOwnPropertySymbols,P1=Object.prototype.hasOwnProperty,S1=Object.prototype.propertyIsEnumerable,ll=(c,i,r)=>i in c?x1(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,fl=(c,i)=>{for(var r in i||(i={}))P1.call(i,r)&&ll(c,r,i[r]);if(hl)for(var r of hl(i))S1.call(i,r)&&ll(c,r,i[r]);return c};class wa extends Rw{constructor(i,r,n,a=bi,l=void 0){super(i,r,n,a),this.core=i,this.logger=r,this.name=n,this.map=new Map,this.version=Wb,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!_i(d)?this.map.set(this.getKey(d),d):J0(d)?this.map.set(d.id,d):Q0(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,v)=>{this.isInitialized(),this.map.has(d)?await this.update(d,v):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:v}),this.map.set(d,v),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(v=>Object.keys(d).every(w=>t_(v[w],d[w]))):this.values),this.update=async(d,v)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:v});const w=fl(fl({},this.getData(d)),v);this.map.set(d,w),await this.persist()},this.delete=async(d,v)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:v}),this.map.delete(d),await this.persist())},this.logger=Se.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){const r=this.map.get(i);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}}}class O1{constructor(i,r){this.core=i,this.logger=r,this.name=Zb,this.version=e1,this.events=new mc,this.initialized=!1,this.storagePrefix=bi,this.ignoredPayloadTypes=[$l],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=cc(),a=await this.core.crypto.setSymKey(n),l=Dr(ie.FIVE_MINUTES),d={protocol:of},v={topic:a,expiry:l,relay:d,active:!1},w=um({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:n,relay:d});return await this.pairings.set(a,v),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:w}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:a,symKey:l,relay:d}=Ah(n.uri);let v;if(this.pairings.keys.includes(a)&&(v=this.pairings.get(a),v.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const w=Dr(ie.FIVE_MINUTES),y={topic:a,relay:d,expiry:w,active:!1};return await this.pairings.set(a,y),this.core.expirer.set(a,w),n.activatePairing&&await this.activate({topic:a}),this.events.emit(ks.create,y),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:d})),y},this.activate=async({topic:n})=>{this.isInitialized();const a=Dr(ie.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:a}),this.core.expirer.set(n,a)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:a}=n;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:d,resolve:v,reject:w}=us();this.events.once($t("pairing_ping",l),({error:y})=>{y?w(y):v()}),await d()}},this.updateExpiry=async({topic:n,expiry:a})=>{this.isInitialized(),await this.pairings.update(n,{expiry:a})},this.updateMetadata=async({topic:n,metadata:a})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:a}=n;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",Gt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(n,a,l)=>{const d=Vs(a,l),v=await this.core.crypto.encode(n,d),w=qs[a].req;return this.core.history.set(n,d),this.core.relayer.publish(n,v,w),d.id},this.sendResult=async(n,a,l)=>{const d=ya(n,l),v=await this.core.crypto.encode(a,d),w=await this.core.history.get(a,n),y=qs[w.request.method].res;await this.core.relayer.publish(a,v,y),await this.core.history.resolve(d)},this.sendError=async(n,a,l)=>{const d=wc(n,l),v=await this.core.crypto.encode(a,d),w=await this.core.history.get(a,n),y=qs[w.request.method]?qs[w.request.method].res:qs.unregistered_method.res;await this.core.relayer.publish(a,v,y),await this.core.history.resolve(d)},this.deletePairing=async(n,a)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Gt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),a?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(a=>wi(a.expiry));await Promise.all(n.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=n=>{const{topic:a,payload:l}=n;switch(l.method){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async n=>{const{topic:a,payload:l}=n,d=(await this.core.history.get(a,l.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,a)=>{const{id:l}=a;try{this.isValidPing({topic:n}),await this.sendResult(l,n,!0),this.events.emit(ks.ping,{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,a)=>{const{id:l}=a;setTimeout(()=>{mi(a)?this.events.emit($t("pairing_ping",l),{}):si(a)&&this.events.emit($t("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(n,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(ks.delete,{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,a)=>{const{id:l,method:d}=a;try{if(this.registeredMethods.includes(d))return;const v=Gt("WC_METHOD_UNSUPPORTED",d);await this.sendError(l,n,v),this.logger.error(v)}catch(v){await this.sendError(l,n,v),this.logger.error(v)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Gt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var a;if(!hr(n)){const{message:d}=Y("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(d)}if(!hm(n.uri)){const{message:d}=Y("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(d)}const l=Ah(n.uri);if(!((a=l==null?void 0:l.relay)!=null&&a.protocol)){const{message:d}=Y("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(d)}if(!(l!=null&&l.symKey)){const{message:d}=Y("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(d)}},this.isValidPing=async n=>{if(!hr(n)){const{message:l}=Y("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(l)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidDisconnect=async n=>{if(!hr(n)){const{message:l}=Y("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(l)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async n=>{if(!hs(n,!1)){const{message:a}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(a)}if(!this.pairings.keys.includes(n)){const{message:a}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(a)}if(wi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:a}=Y("EXPIRED",`pairing topic: ${n}`);throw new Error(a)}},this.core=i,this.logger=Se.generateChildLogger(r,this.name),this.pairings=new wa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.core.relayer.on(Wt.message,async i=>{const{topic:r,message:n}=i;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(r,n);try{_c(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):bc(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(l){this.logger.error(l)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async i=>{const{topic:r}=Dl(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(ks.expire,{topic:r}))})}}class C1 extends Pw{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new Kr.EventEmitter,this.name=t1,this.version=r1,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:a,chainId:l}),this.records.has(a.id))return;const d={id:a.id,topic:n,request:{method:a.method,params:a.params||null},chainId:l,expiry:Dr(ie.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(kr.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const a=await this.getRecord(n.id);typeof a.response>"u"&&(a.response=si(n)?{error:n.error}:{result:n.result},this.records.set(a.id,a),this.events.emit(kr.updated,a))},this.get=async(n,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:a}),await this.getRecord(a)),this.delete=(n,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===n){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(kr.deleted,l)}})},this.exists=async(n,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===n:!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const i=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Vs(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(n)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();const r=this.records.get(i);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(kr.sync)}async restore(){try{const i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(kr.created,i=>{const r=kr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(kr.updated,i=>{const r=kr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(kr.deleted,i=>{const r=kr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{ie.toMiliseconds(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}}}class R1 extends Tw{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new Kr.EventEmitter,this.name=i1,this.version=s1,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const a=this.formatTarget(n);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(n,a)=>{this.isInitialized();const l=this.formatTarget(n),d={target:l,expiry:a};this.expirations.set(l,d),this.checkExpiry(l,d),this.events.emit(Sr.created,{target:l,expiration:d})},this.get=n=>{this.isInitialized();const a=this.formatTarget(n);return this.getExpiration(a)},this.del=n=>{if(this.isInitialized(),this.has(n)){const a=this.formatTarget(n),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Sr.deleted,{target:a,expiration:l})}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if(typeof i=="string")return lm(i);if(typeof i=="number")return fm(i);const{message:r}=Y("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw new Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){const r=this.expirations.get(i);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(i,r){const{expiry:n}=r;ie.toMiliseconds(n)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(Sr.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,i=>{const r=Sr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.expired,i=>{const r=Sr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.deleted,i=>{const r=Sr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}}}class A1 extends Nw{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=ec,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||pm()||!Ll())return;const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(l){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(l)}if(!this.initialized){this.removeIframe(),this.verifyUrl=pc;try{await this.createIframe()}catch(l){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(l),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let l;try{l=await this.fetchAttestation(n.attestationId,a)}catch(d){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${a}`),this.logger.info(d),l=await this.fetchAttestation(n.attestationId,pc)}return l},this.fetchAttestation=async(n,a)=>{this.logger.info(`resolving attestation: ${n} from url: ${a}`);const l=this.startAbortTimer(ie.ONE_SECOND*2),d=await fetch(`${a}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(l),d.status===200?await d.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const a=l=>{l.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),n())};await Promise.race([new Promise(l=>{if(document.getElementById(ec))return l();window.addEventListener("message",a);const d=document.createElement("iframe");d.id=ec,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,n=l}),new Promise((l,d)=>setTimeout(()=>{window.removeEventListener("message",a),d("verify iframe load timeout")},ie.toMiliseconds(ie.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let a=n||ls;return n1.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${ls}`),a=ls),a},this.logger=Se.generateChildLogger(r,this.name),this.verifyUrl=ls,this.abortController=new AbortController,this.isDevEnv=dm()&&a_.IS_VITEST}get context(){return Se.getLoggerContext(this.logger)}startAbortTimer(i){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ie.toMiliseconds(i))}}class T1 extends $w{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.context=a1,this.registerDeviceToken=async n=>{const{clientId:a,token:l,notificationType:d,enableEncrypted:v=!1}=n,w=`${o1}/${this.projectId}/clients`;await n_(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:a,type:d,token:l,always_raw:v})})},this.logger=Se.generateChildLogger(r,this.context)}}var N1=Object.defineProperty,pl=Object.getOwnPropertySymbols,$1=Object.prototype.hasOwnProperty,D1=Object.prototype.propertyIsEnumerable,dl=(c,i,r)=>i in c?N1(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,gl=(c,i)=>{for(var r in i||(i={}))$1.call(i,r)&&dl(c,r,i[r]);if(pl)for(var r of pl(i))D1.call(i,r)&&dl(c,r,i[r]);return c};class xc extends xw{constructor(i){super(i),this.protocol=af,this.version=Tb,this.name=Ic,this.events=new Kr.EventEmitter,this.initialized=!1,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.projectId=i==null?void 0:i.projectId,this.relayUrl=(i==null?void 0:i.relayUrl)||cf,this.customStoragePrefix=i!=null&&i.customStoragePrefix?`:${i.customStoragePrefix}`:"";const r=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Se.pino(Se.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||Nb.logger}));this.logger=Se.generateChildLogger(r,this.name),this.heartbeat=new ds.HeartBeat,this.crypto=new u1(this,this.logger,i==null?void 0:i.keychain),this.history=new C1(this,this.logger),this.expirer=new R1(this,this.logger),this.storage=i!=null&&i.storage?i.storage:new gw(gl(gl({},$b),i==null?void 0:i.storageOptions)),this.relayer=new I1({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new O1(this,this.logger),this.verify=new A1(this.projectId||"",this.logger),this.echoClient=new T1(this.projectId||"",this.logger)}static async init(i){const r=new xc(i);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(Jb,n),r}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}}const L1=xc,uf="wc",hf=2,lf="client",Pc=`${uf}@${hf}:${lf}:`,rc={name:lf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},vl="WALLETCONNECT_DEEPLINK_CHOICE",q1="proposal",ff="Proposal expired",M1="session",na=ie.SEVEN_DAYS,j1="engine",js={wc_sessionPropose:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1115}}},ic={min:ie.FIVE_MINUTES,max:ie.SEVEN_DAYS},ii={idle:"IDLE",active:"ACTIVE"},z1="request",U1=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var H1=Object.defineProperty,k1=Object.defineProperties,K1=Object.getOwnPropertyDescriptors,yl=Object.getOwnPropertySymbols,V1=Object.prototype.hasOwnProperty,F1=Object.prototype.propertyIsEnumerable,ml=(c,i,r)=>i in c?H1(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,cr=(c,i)=>{for(var r in i||(i={}))V1.call(i,r)&&ml(c,r,i[r]);if(yl)for(var r of yl(i))F1.call(i,r)&&ml(c,r,i[r]);return c},zs=(c,i)=>k1(c,K1(i));class B1 extends Lw{constructor(i){super(i),this.name=j1,this.events=new mc,this.initialized=!1,this.ignoredPayloadTypes=[$l],this.requestQueue={state:ii.idle,queue:[]},this.sessionRequestQueue={state:ii.idle,queue:[]},this.requestQueueDelay=ie.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(js)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=zs(cr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:d,sessionProperties:v,relays:w}=n;let y=a,E,O=!1;if(y&&(O=this.client.core.pairing.pairings.get(y).active),!y||!O){const{topic:he,uri:fe}=await this.client.core.pairing.create();y=he,E=fe}const R=await this.client.core.crypto.generateKeyPair(),z=cr({requiredNamespaces:l,optionalNamespaces:d,relays:w??[{protocol:of}],proposer:{publicKey:R,metadata:this.client.metadata}},v&&{sessionProperties:v}),{reject:D,resolve:V,done:re}=us(ie.FIVE_MINUTES,ff);if(this.events.once($t("session_connect"),async({error:he,session:fe})=>{if(he)D(he);else if(fe){fe.self.publicKey=R;const pe=zs(cr({},fe),{requiredNamespaces:fe.requiredNamespaces,optionalNamespaces:fe.optionalNamespaces});await this.client.session.set(fe.topic,pe),await this.setExpiry(fe.topic,fe.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:fe.peer.metadata}),V(pe)}}),!y){const{message:he}=Y("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(he)}const ce=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:z}),ue=Dr(ie.FIVE_MINUTES);return await this.setProposal(ce,cr({id:ce,expiry:ue},z)),{uri:E,approval:re}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:a,namespaces:l,sessionProperties:d}=r,v=this.client.proposal.get(n);let{pairingTopic:w,proposer:y,requiredNamespaces:E,optionalNamespaces:O}=v;w=w||"",ua(E)||(E=vm(l,"approve()"));const R=await this.client.core.crypto.generateKeyPair(),z=y.publicKey,D=await this.client.core.crypto.generateSharedKey(R,z);w&&n&&(await this.client.core.pairing.updateMetadata({topic:w,metadata:y.metadata}),await this.sendResult({id:n,topic:w,result:{relay:{protocol:a??"irn"},responderPublicKey:R}}),await this.client.proposal.delete(n,Gt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}));const V=cr({relay:{protocol:a??"irn"},namespaces:l,requiredNamespaces:E,optionalNamespaces:O,pairingTopic:w,controller:{publicKey:R,metadata:this.client.metadata},expiry:Dr(na)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(D),await this.sendRequest({topic:D,method:"wc_sessionSettle",params:V,throwOnFailedPublish:!0});const re=zs(cr({},V),{topic:D,pairingTopic:w,acknowledged:!1,self:V.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:R});return await this.client.session.set(D,re),await this.setExpiry(D,Dr(na)),{topic:D,acknowledged:()=>new Promise(ce=>setTimeout(()=>ce(this.client.session.get(D)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(n);l&&(await this.sendError(n,l,a),await this.client.proposal.delete(n,Gt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:a}=r,l=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:d,resolve:v,reject:w}=us();return this.events.once($t("session_update",l),({error:y})=>{y?w(y):v()}),await this.client.session.update(n,{namespaces:a}),{acknowledged:d}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,a=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:l,resolve:d,reject:v}=us();return this.events.once($t("session_extend",a),({error:w})=>{w?v(w):d()}),await this.setExpiry(n,Dr(na)),{acknowledged:l}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:a,topic:l,expiry:d}=r,v=zm(),{done:w,resolve:y,reject:E}=us(d,"Request expired. Please try again.");return this.events.once($t("session_request",v),({error:O,result:R})=>{O?E(O):y(R)}),await Promise.all([new Promise(async O=>{await this.sendRequest({clientRpcId:v,topic:l,method:"wc_sessionRequest",params:{request:a,chainId:n},expiry:d,throwOnFailedPublish:!0}).catch(R=>E(R)),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:n,id:v}),O()}),new Promise(async O=>{const R=await ym(this.client.core.storage,vl);mm({id:v,topic:l,wcDeepLink:R}),O()}),w()]).then(O=>O[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:a}=r,{id:l}=a;mi(a)?await this.sendResult({id:l,topic:n,result:a.result,throwOnFailedPublish:!0}):si(a)&&await this.sendError(l,n,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const a=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:l,resolve:d,reject:v}=us();this.events.once($t("session_ping",a),({error:w})=>{w?v(w):d()}),await l()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:a,chainId:l}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:a,chainId:l}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Gt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>wm(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var d,v;return((d=l.peerMetadata)==null?void 0:d.url)&&((v=l.peerMetadata)==null?void 0:v.url)===r.peer.metadata.url&&l.topic&&l.topic!==n.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Gt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(vl).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===r&&this.deletePendingSessionRequest(l.id,Gt("USER_DISCONNECTED"))})},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Gt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(l=>l.id!==r),a&&(this.sessionRequestQueue.state=ii.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=js.wc_sessionRequest.req.ttl,{id:a,topic:l,params:d,verifyContext:v}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:d,verifyContext:v}),n&&this.client.core.expirer.set(a,Dr(n))},this.sendRequest=async r=>{const{topic:n,method:a,params:l,expiry:d,relayRpcId:v,clientRpcId:w,throwOnFailedPublish:y}=r,E=Vs(a,l,w);if(Ll()&&U1.includes(a)){const z=fs(JSON.stringify(E));this.client.core.verify.register({attestationId:z})}const O=await this.client.core.crypto.encode(n,E),R=js[a].req;return d&&(R.ttl=d),v&&(R.id=v),this.client.core.history.set(n,E),y?(R.internal=zs(cr({},R.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,O,R)):this.client.core.relayer.publish(n,O,R).catch(z=>this.client.logger.error(z)),E.id},this.sendResult=async r=>{const{id:n,topic:a,result:l,throwOnFailedPublish:d}=r,v=ya(n,l),w=await this.client.core.crypto.encode(a,v),y=await this.client.core.history.get(a,n),E=js[y.request.method].res;d?(E.internal=zs(cr({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,w,E)):this.client.core.relayer.publish(a,w,E).catch(O=>this.client.logger.error(O)),await this.client.core.history.resolve(v)},this.sendError=async(r,n,a)=>{const l=wc(r,a),d=await this.client.core.crypto.encode(n,l),v=await this.client.core.history.get(n,r),w=js[v.request.method].res;this.client.core.relayer.publish(n,d,w),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(a=>{wi(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{wi(a.expiry)&&n.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...n.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ii.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ii.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ii.idle},this.processRequest=r=>{const{topic:n,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(n,a);case"wc_sessionSettle":return this.onSessionSettleRequest(n,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,a);case"wc_sessionExtend":return this.onSessionExtendRequest(n,a);case"wc_sessionPing":return this.onSessionPingRequest(n,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,a);case"wc_sessionRequest":return this.onSessionRequest(n,a);case"wc_sessionEvent":return this.onSessionEventRequest(n,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:a}=r,l=(await this.client.core.history.get(n,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,a);case"wc_sessionExtend":return this.onSessionExtendResponse(n,a);case"wc_sessionPing":return this.onSessionPingResponse(n,a);case"wc_sessionRequest":return this.onSessionRequestResponse(n,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:a}=Y("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,n)=>{const{params:a,id:l}=n;try{this.isValidConnect(cr({},n.params));const d=Dr(ie.FIVE_MINUTES),v=cr({id:l,pairingTopic:r,expiry:d},a);await this.setProposal(l,v);const w=fs(JSON.stringify(n)),y=await this.getVerifyContext(w,v.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:v,verifyContext:y})}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(r,n)=>{const{id:a}=n;if(mi(n)){const{result:l}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const d=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const v=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:v});const w=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:w});const y=await this.client.core.crypto.generateSharedKey(v,w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const E=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:r})}else si(n)&&(await this.client.proposal.delete(a,Gt("USER_DISCONNECTED")),this.events.emit($t("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:a,params:l}=n;try{this.isValidSessionSettleRequest(l);const{relay:d,controller:v,expiry:w,namespaces:y,requiredNamespaces:E,optionalNamespaces:O,sessionProperties:R,pairingTopic:z}=n.params,D=cr({topic:r,relay:d,expiry:w,namespaces:y,acknowledged:!0,pairingTopic:z,requiredNamespaces:E,optionalNamespaces:O,controller:v.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:v.publicKey,metadata:v.metadata}},R&&{sessionProperties:R});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit($t("session_connect"),{session:D}),this.cleanupDuplicatePairings(D)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(r,n)=>{const{id:a}=n;mi(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit($t("session_approve",a),{})):si(n)&&(await this.client.session.delete(r,Gt("USER_DISCONNECTED")),this.events.emit($t("session_approve",a),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:a,id:l}=n;try{const d=`${r}_session_update`,v=ra.get(d);if(v&&this.isRequestOutOfSync(v,l)){this.client.logger.info(`Discarding out of sync request - ${l}`);return}this.isValidUpdate(cr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:l,topic:r,result:!0}),this.client.events.emit("session_update",{id:l,topic:r,params:a}),ra.set(d,l)}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:a}=n;mi(n)?this.events.emit($t("session_update",a),{}):si(n)&&this.events.emit($t("session_update",a),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:a}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Dr(na)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,n)=>{const{id:a}=n;mi(n)?this.events.emit($t("session_extend",a),{}):si(n)&&this.events.emit($t("session_extend",a),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:a}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,n)=>{const{id:a}=n;setTimeout(()=>{mi(n)?this.events.emit($t("session_ping",a),{}):si(n)&&this.events.emit($t("session_ping",a),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Wt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,n)=>{const{id:a,params:l}=n;try{this.isValidRequest(cr({topic:r},l));const d=fs(JSON.stringify(Vs("wc_sessionRequest",l,a))),v=this.client.session.get(r),w=await this.getVerifyContext(d,v.peer.metadata),y={id:a,topic:r,params:l,verifyContext:w};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(r,n)=>{const{id:a}=n;mi(n)?this.events.emit($t("session_request",a),{result:n.result}):si(n)&&this.events.emit($t("session_request",a),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:a,params:l}=n;try{const d=`${r}_session_event_${l.event.name}`,v=ra.get(d);if(v&&this.isRequestOutOfSync(v,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(cr({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l}),ra.set(d,a)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ii.idle,this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ii.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ii.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,Vs("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!hr(r)){const{message:w}=Y("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(w)}const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:d,relays:v}=r;if(_i(n)||await this.isValidPairingTopic(n),!_m(v,!0)){const{message:w}=Y("MISSING_OR_INVALID",`connect() relays: ${v}`);throw new Error(w)}!_i(a)&&ua(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!_i(l)&&ua(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),_i(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(r,n)=>{const a=bm(r,"connect()",n);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!hr(r))throw new Error(Y("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:a,relayProtocol:l,sessionProperties:d}=r;await this.isValidProposalId(n);const v=this.client.proposal.get(n),w=Fo(a,"approve()");if(w)throw new Error(w.message);const y=Th(v.requiredNamespaces,a,"approve()");if(y)throw new Error(y.message);if(!hs(l,!0)){const{message:E}=Y("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(E)}_i(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async r=>{if(!hr(r)){const{message:l}=Y("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:n,reason:a}=r;if(await this.isValidProposalId(n),!Em(a)){const{message:l}=Y("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!hr(r)){const{message:y}=Y("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:n,controller:a,namespaces:l,expiry:d}=r;if(!Im(n)){const{message:y}=Y("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const v=xm(a,"onSessionSettleRequest()");if(v)throw new Error(v.message);const w=Fo(l,"onSessionSettleRequest()");if(w)throw new Error(w.message);if(wi(d)){const{message:y}=Y("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!hr(r)){const{message:w}=Y("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(w)}const{topic:n,namespaces:a}=r;await this.isValidSessionTopic(n);const l=this.client.session.get(n),d=Fo(a,"update()");if(d)throw new Error(d.message);const v=Th(l.requiredNamespaces,a,"update()");if(v)throw new Error(v.message)},this.isValidExtend=async r=>{if(!hr(r)){const{message:a}=Y("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!hr(r)){const{message:w}=Y("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(w)}const{topic:n,request:a,chainId:l,expiry:d}=r;await this.isValidSessionTopic(n);const{namespaces:v}=this.client.session.get(n);if(!Nh(v,l)){const{message:w}=Y("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(w)}if(!Pm(a)){const{message:w}=Y("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(w)}if(!Sm(v,l,a.method)){const{message:w}=Y("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(w)}if(d&&!Om(d,ic)){const{message:w}=Y("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${ic.min} and ${ic.max}`);throw new Error(w)}},this.isValidRespond=async r=>{var n;if(!hr(r)){const{message:d}=Y("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(d)}const{topic:a,response:l}=r;try{await this.isValidSessionTopic(a)}catch(d){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),d}if(!Cm(l)){const{message:d}=Y("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(l)}`);throw new Error(d)}},this.isValidPing=async r=>{if(!hr(r)){const{message:a}=Y("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!hr(r)){const{message:v}=Y("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(v)}const{topic:n,event:a,chainId:l}=r;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Nh(d,l)){const{message:v}=Y("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(v)}if(!Rm(a)){const{message:v}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(v)}if(!Am(d,l,a.name)){const{message:v}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(v)}},this.isValidDisconnect=async r=>{if(!hr(r)){const{message:a}=Y("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const a={verified:{verifyUrl:n.verifyUrl||ls,validation:"UNKNOWN",origin:n.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});l&&(a.verified.origin=l.origin,a.verified.isScam=l.isScam,a.verified.validation=l.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.info(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(a=>{if(!hs(a,!1)){const{message:l}=Y("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}async isInitialized(){if(!this.initialized){const{message:i}=Y("NOT_INITIALIZED",this.name);throw new Error(i)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Wt.message,async i=>{const{topic:r,message:n}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const a=await this.client.core.crypto.decode(r,n);try{_c(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):bc(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(l){this.client.logger.error(l)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async i=>{const{topic:r,id:n}=Dl(i.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Y("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(ks.create,i=>this.onPairingCreated(i))}isValidPairingTopic(i){if(!hs(i,!1)){const{message:r}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){const{message:r}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.core.pairing.pairings.get(i).expiry)){const{message:r}=Y("EXPIRED",`pairing topic: ${i}`);throw new Error(r)}}async isValidSessionTopic(i){if(!hs(i,!1)){const{message:r}=Y("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw new Error(r)}if(!this.client.session.keys.includes(i)){const{message:r}=Y("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.session.get(i).expiry)){await this.deleteSession(i);const{message:r}=Y("EXPIRED",`session topic: ${i}`);throw new Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if(hs(i,!1)){const{message:r}=Y("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw new Error(r)}else{const{message:r}=Y("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw new Error(r)}}async isValidProposalId(i){if(!Tm(i)){const{message:r}=Y("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw new Error(r)}if(!this.client.proposal.keys.includes(i)){const{message:r}=Y("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);const{message:r}=Y("EXPIRED",`proposal id: ${i}`);throw new Error(r)}}}class G1 extends wa{constructor(i,r){super(i,r,q1,Pc),this.core=i,this.logger=r}}class W1 extends wa{constructor(i,r){super(i,r,M1,Pc),this.core=i,this.logger=r}}class J1 extends wa{constructor(i,r){super(i,r,z1,Pc,n=>n.id),this.core=i,this.logger=r}}let Q1=class pf extends Dw{constructor(i){super(i),this.protocol=uf,this.version=hf,this.name=rc.name,this.events=new Kr.EventEmitter,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(a){throw this.logger.error(a.message),a}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(a){throw this.logger.error(a.message),a}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(a){throw this.logger.error(a.message),a}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(a){throw this.logger.error(a.message),a}},this.update=async n=>{try{return await this.engine.update(n)}catch(a){throw this.logger.error(a.message),a}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(a){throw this.logger.error(a.message),a}},this.request=async n=>{try{return await this.engine.request(n)}catch(a){throw this.logger.error(a.message),a}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(a){throw this.logger.error(a.message),a}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(a){throw this.logger.error(a.message),a}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(a){throw this.logger.error(a.message),a}},this.find=n=>{try{return this.engine.find(n)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(i==null?void 0:i.name)||rc.name,this.metadata=(i==null?void 0:i.metadata)||gm();const r=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Se.pino(Se.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||rc.logger}));this.core=(i==null?void 0:i.core)||new L1(i),this.logger=Se.generateChildLogger(r,this.name),this.session=new W1(this.core,this.logger),this.proposal=new G1(this.core,this.logger),this.pendingRequest=new J1(this.core,this.logger),this.engine=new B1(this)}static async init(i){const r=new pf(i);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}};const wl="error",Y1="wss://relay.walletconnect.com",X1="wc",Z1="universal_provider",_l=`${X1}@2:${Z1}:`,eE="https://rpc.walletconnect.com/v1/",ai={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Us=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(c,i){(function(){var r,n="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",v="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",y=500,E="__lodash_placeholder__",O=1,R=2,z=4,D=1,V=2,re=1,ce=2,ue=4,he=8,fe=16,pe=32,$=64,k=128,W=256,ve=512,te=30,Ee="...",Re=800,et=16,A=1,j=2,ze=3,Ae=1/0,J=9007199254740991,F=17976931348623157e292,K=NaN,B=4294967295,ut=B-1,ke=B>>>1,Lr=[["ary",k],["bind",re],["bindKey",ce],["curry",he],["curryRight",fe],["flip",ve],["partial",pe],["partialRight",$],["rearg",W]],_e="[object Arguments]",It="[object Array]",N="[object AsyncFunction]",T="[object Boolean]",S="[object Date]",u="[object DOMException]",b="[object Error]",Z="[object Function]",oe="[object GeneratorFunction]",me="[object Map]",Te="[object Number]",$e="[object Null]",xe="[object Object]",xt="[object Promise]",mt="[object Proxy]",nt="[object RegExp]",Le="[object Set]",Je="[object String]",Qe="[object Symbol]",at="[object Undefined]",Ue="[object WeakMap]",Ye="[object WeakSet]",Ne="[object ArrayBuffer]",Ke="[object DataView]",ht="[object Float32Array]",Me="[object Float64Array]",Pt="[object Int8Array]",Dt="[object Int16Array]",Ht="[object Int32Array]",kt="[object Uint8Array]",Mt="[object Uint8ClampedArray]",Jt="[object Uint16Array]",rr="[object Uint32Array]",qr=/\b__p \+= '';/g,Qt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,oi=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,lt=RegExp(oi.source),tt=RegExp(xi.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Ct=RegExp(dt.source),gt=/^\s+/,wt=/\s/,vt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,We=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,At=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,_a=/[()=,{}\[\]\/\s]/,ba=/\\(\\)?/g,Ea=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Ia=/^[-+]0x[0-9a-f]+$/i,xa=/^0b[01]+$/i,Pa=/^\[object .+?Constructor\]$/,Sa=/^0o[0-7]+$/i,Oa=/^(?:0|[1-9]\d*)$/,Fr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ki=/($^)/,Ca=/['\n\r\u2028\u2029\\]/g,Vi="\\ud800-\\udfff",Ra="\\u0300-\\u036f",Aa="\\ufe20-\\ufe2f",Fi="\\u20d0-\\u20ff",Qs=Ra+Aa+Fi,Ys="\\u2700-\\u27bf",Or="a-z\\xdf-\\xf6\\xf8-\\xff",Ta="\\xac\\xb1\\xd7\\xf7",Na="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",$a="\\u2000-\\u206f",Da=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Xs="A-Z\\xc0-\\xd6\\xd8-\\xde",Zs="\\ufe0e\\ufe0f",Pi=Ta+Na+$a+Da,gs="['’]",Si="["+Vi+"]",vs="["+Pi+"]",Oi="["+Qs+"]",en="\\d+",La="["+Ys+"]",tn="["+Or+"]",rn="[^"+Vi+Pi+en+Ys+Or+Xs+"]",Bi="\\ud83c[\\udffb-\\udfff]",qa="(?:"+Oi+"|"+Bi+")",sn="[^"+Vi+"]",Gi="(?:\\ud83c[\\udde6-\\uddff]){2}",ci="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+Xs+"]",nn="\\u200d",an="(?:"+tn+"|"+rn+")",Mr="(?:"+lr+"|"+rn+")",on="(?:"+gs+"(?:d|ll|m|re|s|t|ve))?",cn="(?:"+gs+"(?:D|LL|M|RE|S|T|VE))?",un=qa+"?",hn="["+Zs+"]?",Ma="(?:"+nn+"(?:"+[sn,Gi,ci].join("|")+")"+hn+un+")*",Br="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ln="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",fn=hn+un+Ma,Wi="(?:"+[La,Gi,ci].join("|")+")"+fn,ja="(?:"+[sn+Oi+"?",Oi,Gi,ci,Si].join("|")+")",ys=RegExp(gs,"g"),za=RegExp(Oi,"g"),Ji=RegExp(Bi+"(?="+Bi+")|"+ja+fn,"g"),pn=RegExp([lr+"?"+tn+"+"+on+"(?="+[vs,lr,"$"].join("|")+")",Mr+"+"+cn+"(?="+[vs,lr+an,"$"].join("|")+")",lr+"?"+an+"+"+on,lr+"+"+cn,ln,Br,en,Wi].join("|"),"g"),dn=RegExp("["+nn+Vi+Qs+Zs+"]"),Ci=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,gn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ua=-1,Ve={};Ve[ht]=Ve[Me]=Ve[Pt]=Ve[Dt]=Ve[Ht]=Ve[kt]=Ve[Mt]=Ve[Jt]=Ve[rr]=!0,Ve[_e]=Ve[It]=Ve[Ne]=Ve[T]=Ve[Ke]=Ve[S]=Ve[b]=Ve[Z]=Ve[me]=Ve[Te]=Ve[xe]=Ve[nt]=Ve[Le]=Ve[Je]=Ve[Ue]=!1;var He={};He[_e]=He[It]=He[Ne]=He[Ke]=He[T]=He[S]=He[ht]=He[Me]=He[Pt]=He[Dt]=He[Ht]=He[me]=He[Te]=He[xe]=He[nt]=He[Le]=He[Je]=He[Qe]=He[kt]=He[Mt]=He[Jt]=He[rr]=!0,He[b]=He[Z]=He[Ue]=!1;var g={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fe=parseFloat,de=parseInt,Xe=typeof Us=="object"&&Us&&Us.Object===Object&&Us,Tt=typeof self=="object"&&self&&self.Object===Object&&self,Oe=Xe||Tt||Function("return this")(),Be=i&&!i.nodeType&&i,_t=Be&&!0&&c&&!c.nodeType&&c,ir=_t&&_t.exports===Be,Nt=ir&&Xe.process,Ze=function(){try{var x=_t&&_t.require&&_t.require("util").types;return x||Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Yt=Ze&&Ze.isArrayBuffer,Cr=Ze&&Ze.isDate,mr=Ze&&Ze.isMap,jr=Ze&&Ze.isRegExp,ms=Ze&&Ze.isSet,Ri=Ze&&Ze.isTypedArray;function jt(x,L,C){switch(C.length){case 0:return x.call(L);case 1:return x.call(L,C[0]);case 2:return x.call(L,C[0],C[1]);case 3:return x.call(L,C[0],C[1],C[2])}return x.apply(L,C)}function vf(x,L,C,X){for(var le=-1,De=x==null?0:x.length;++le<De;){var Lt=x[le];L(X,Lt,C(Lt),x)}return X}function wr(x,L){for(var C=-1,X=x==null?0:x.length;++C<X&&L(x[C],C,x)!==!1;);return x}function yf(x,L){for(var C=x==null?0:x.length;C--&&L(x[C],C,x)!==!1;);return x}function Cc(x,L){for(var C=-1,X=x==null?0:x.length;++C<X;)if(!L(x[C],C,x))return!1;return!0}function ui(x,L){for(var C=-1,X=x==null?0:x.length,le=0,De=[];++C<X;){var Lt=x[C];L(Lt,C,x)&&(De[le++]=Lt)}return De}function vn(x,L){var C=x==null?0:x.length;return!!C&&Qi(x,L,0)>-1}function Ha(x,L,C){for(var X=-1,le=x==null?0:x.length;++X<le;)if(C(L,x[X]))return!0;return!1}function it(x,L){for(var C=-1,X=x==null?0:x.length,le=Array(X);++C<X;)le[C]=L(x[C],C,x);return le}function hi(x,L){for(var C=-1,X=L.length,le=x.length;++C<X;)x[le+C]=L[C];return x}function ka(x,L,C,X){var le=-1,De=x==null?0:x.length;for(X&&De&&(C=x[++le]);++le<De;)C=L(C,x[le],le,x);return C}function mf(x,L,C,X){var le=x==null?0:x.length;for(X&&le&&(C=x[--le]);le--;)C=L(C,x[le],le,x);return C}function Ka(x,L){for(var C=-1,X=x==null?0:x.length;++C<X;)if(L(x[C],C,x))return!0;return!1}var wf=Va("length");function _f(x){return x.split("")}function bf(x){return x.match(At)||[]}function Rc(x,L,C){var X;return C(x,function(le,De,Lt){if(L(le,De,Lt))return X=De,!1}),X}function yn(x,L,C,X){for(var le=x.length,De=C+(X?1:-1);X?De--:++De<le;)if(L(x[De],De,x))return De;return-1}function Qi(x,L,C){return L===L?$f(x,L,C):yn(x,Ac,C)}function Ef(x,L,C,X){for(var le=C-1,De=x.length;++le<De;)if(X(x[le],L))return le;return-1}function Ac(x){return x!==x}function Tc(x,L){var C=x==null?0:x.length;return C?Ba(x,L)/C:K}function Va(x){return function(L){return L==null?r:L[x]}}function Fa(x){return function(L){return x==null?r:x[L]}}function Nc(x,L,C,X,le){return le(x,function(De,Lt,Ge){C=X?(X=!1,De):L(C,De,Lt,Ge)}),C}function If(x,L){var C=x.length;for(x.sort(L);C--;)x[C]=x[C].value;return x}function Ba(x,L){for(var C,X=-1,le=x.length;++X<le;){var De=L(x[X]);De!==r&&(C=C===r?De:C+De)}return C}function Ga(x,L){for(var C=-1,X=Array(x);++C<x;)X[C]=L(C);return X}function xf(x,L){return it(L,function(C){return[C,x[C]]})}function $c(x){return x&&x.slice(0,Mc(x)+1).replace(gt,"")}function fr(x){return function(L){return x(L)}}function Wa(x,L){return it(L,function(C){return x[C]})}function ws(x,L){return x.has(L)}function Dc(x,L){for(var C=-1,X=x.length;++C<X&&Qi(L,x[C],0)>-1;);return C}function Lc(x,L){for(var C=x.length;C--&&Qi(L,x[C],0)>-1;);return C}function Pf(x,L){for(var C=x.length,X=0;C--;)x[C]===L&&++X;return X}var Sf=Fa(g),Of=Fa(I);function Cf(x){return"\\"+Q[x]}function Rf(x,L){return x==null?r:x[L]}function Yi(x){return dn.test(x)}function Af(x){return Ci.test(x)}function Tf(x){for(var L,C=[];!(L=x.next()).done;)C.push(L.value);return C}function Ja(x){var L=-1,C=Array(x.size);return x.forEach(function(X,le){C[++L]=[le,X]}),C}function qc(x,L){return function(C){return x(L(C))}}function li(x,L){for(var C=-1,X=x.length,le=0,De=[];++C<X;){var Lt=x[C];(Lt===L||Lt===E)&&(x[C]=E,De[le++]=C)}return De}function mn(x){var L=-1,C=Array(x.size);return x.forEach(function(X){C[++L]=X}),C}function Nf(x){var L=-1,C=Array(x.size);return x.forEach(function(X){C[++L]=[X,X]}),C}function $f(x,L,C){for(var X=C-1,le=x.length;++X<le;)if(x[X]===L)return X;return-1}function Df(x,L,C){for(var X=C+1;X--;)if(x[X]===L)return X;return X}function Xi(x){return Yi(x)?qf(x):wf(x)}function Rr(x){return Yi(x)?Mf(x):_f(x)}function Mc(x){for(var L=x.length;L--&&wt.test(x.charAt(L)););return L}var Lf=Fa(U);function qf(x){for(var L=Ji.lastIndex=0;Ji.test(x);)++L;return L}function Mf(x){return x.match(Ji)||[]}function jf(x){return x.match(pn)||[]}var zf=function x(L){L=L==null?Oe:Zi.defaults(Oe.Object(),L,Zi.pick(Oe,gn));var C=L.Array,X=L.Date,le=L.Error,De=L.Function,Lt=L.Math,Ge=L.Object,Qa=L.RegExp,Uf=L.String,_r=L.TypeError,wn=C.prototype,Hf=De.prototype,es=Ge.prototype,_n=L["__core-js_shared__"],bn=Hf.toString,je=es.hasOwnProperty,kf=0,jc=function(){var e=/[^.]+$/.exec(_n&&_n.keys&&_n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),En=es.toString,Kf=bn.call(Ge),Vf=Oe._,Ff=Qa("^"+bn.call(je).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),In=ir?L.Buffer:r,fi=L.Symbol,xn=L.Uint8Array,zc=In?In.allocUnsafe:r,Pn=qc(Ge.getPrototypeOf,Ge),Uc=Ge.create,Hc=es.propertyIsEnumerable,Sn=wn.splice,kc=fi?fi.isConcatSpreadable:r,_s=fi?fi.iterator:r,Ai=fi?fi.toStringTag:r,On=function(){try{var e=Li(Ge,"defineProperty");return e({},"",{}),e}catch{}}(),Bf=L.clearTimeout!==Oe.clearTimeout&&L.clearTimeout,Gf=X&&X.now!==Oe.Date.now&&X.now,Wf=L.setTimeout!==Oe.setTimeout&&L.setTimeout,Cn=Lt.ceil,Rn=Lt.floor,Ya=Ge.getOwnPropertySymbols,Jf=In?In.isBuffer:r,Kc=L.isFinite,Qf=wn.join,Yf=qc(Ge.keys,Ge),qt=Lt.max,Ft=Lt.min,Xf=X.now,Zf=L.parseInt,Vc=Lt.random,ep=wn.reverse,Xa=Li(L,"DataView"),bs=Li(L,"Map"),Za=Li(L,"Promise"),ts=Li(L,"Set"),Es=Li(L,"WeakMap"),Is=Li(Ge,"create"),An=Es&&new Es,rs={},tp=qi(Xa),rp=qi(bs),ip=qi(Za),sp=qi(ts),np=qi(Es),Tn=fi?fi.prototype:r,xs=Tn?Tn.valueOf:r,Fc=Tn?Tn.toString:r;function f(e){if(yt(e)&&!ge(e)&&!(e instanceof Pe)){if(e instanceof br)return e;if(je.call(e,"__wrapped__"))return Bu(e)}return new br(e)}var is=function(){function e(){}return function(t){if(!ct(t))return{};if(Uc)return Uc(t);e.prototype=t;var s=new e;return e.prototype=r,s}}();function Nn(){}function br(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}f.templateSettings={escape:ft,evaluate:pt,interpolate:ot,variable:"",imports:{_:f}},f.prototype=Nn.prototype,f.prototype.constructor=f,br.prototype=is(Nn.prototype),br.prototype.constructor=br;function Pe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=B,this.__views__=[]}function ap(){var e=new Pe(this.__wrapped__);return e.__actions__=sr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=sr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=sr(this.__views__),e}function op(){if(this.__filtered__){var e=new Pe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function cp(){var e=this.__wrapped__.value(),t=this.__dir__,s=ge(e),o=t<0,h=s?e.length:0,p=_d(0,h,this.__views__),m=p.start,_=p.end,P=_-m,q=o?_:m-1,M=this.__iteratees__,H=M.length,G=0,ee=Ft(P,this.__takeCount__);if(!s||!o&&h==P&&ee==P)return gu(e,this.__actions__);var ne=[];e:for(;P--&&G<ee;){q+=t;for(var we=-1,ae=e[q];++we<H;){var Ie=M[we],Ce=Ie.iteratee,gr=Ie.type,er=Ce(ae);if(gr==j)ae=er;else if(!er){if(gr==A)continue e;break e}}ne[G++]=ae}return ne}Pe.prototype=is(Nn.prototype),Pe.prototype.constructor=Pe;function Ti(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var o=e[t];this.set(o[0],o[1])}}function up(){this.__data__=Is?Is(null):{},this.size=0}function hp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function lp(e){var t=this.__data__;if(Is){var s=t[e];return s===w?r:s}return je.call(t,e)?t[e]:r}function fp(e){var t=this.__data__;return Is?t[e]!==r:je.call(t,e)}function pp(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Is&&t===r?w:t,this}Ti.prototype.clear=up,Ti.prototype.delete=hp,Ti.prototype.get=lp,Ti.prototype.has=fp,Ti.prototype.set=pp;function Gr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var o=e[t];this.set(o[0],o[1])}}function dp(){this.__data__=[],this.size=0}function gp(e){var t=this.__data__,s=$n(t,e);if(s<0)return!1;var o=t.length-1;return s==o?t.pop():Sn.call(t,s,1),--this.size,!0}function vp(e){var t=this.__data__,s=$n(t,e);return s<0?r:t[s][1]}function yp(e){return $n(this.__data__,e)>-1}function mp(e,t){var s=this.__data__,o=$n(s,e);return o<0?(++this.size,s.push([e,t])):s[o][1]=t,this}Gr.prototype.clear=dp,Gr.prototype.delete=gp,Gr.prototype.get=vp,Gr.prototype.has=yp,Gr.prototype.set=mp;function Wr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var o=e[t];this.set(o[0],o[1])}}function wp(){this.size=0,this.__data__={hash:new Ti,map:new(bs||Gr),string:new Ti}}function _p(e){var t=Fn(this,e).delete(e);return this.size-=t?1:0,t}function bp(e){return Fn(this,e).get(e)}function Ep(e){return Fn(this,e).has(e)}function Ip(e,t){var s=Fn(this,e),o=s.size;return s.set(e,t),this.size+=s.size==o?0:1,this}Wr.prototype.clear=wp,Wr.prototype.delete=_p,Wr.prototype.get=bp,Wr.prototype.has=Ep,Wr.prototype.set=Ip;function Ni(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Wr;++t<s;)this.add(e[t])}function xp(e){return this.__data__.set(e,w),this}function Pp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=xp,Ni.prototype.has=Pp;function Ar(e){var t=this.__data__=new Gr(e);this.size=t.size}function Sp(){this.__data__=new Gr,this.size=0}function Op(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function Cp(e){return this.__data__.get(e)}function Rp(e){return this.__data__.has(e)}function Ap(e,t){var s=this.__data__;if(s instanceof Gr){var o=s.__data__;if(!bs||o.length<a-1)return o.push([e,t]),this.size=++s.size,this;s=this.__data__=new Wr(o)}return s.set(e,t),this.size=s.size,this}Ar.prototype.clear=Sp,Ar.prototype.delete=Op,Ar.prototype.get=Cp,Ar.prototype.has=Rp,Ar.prototype.set=Ap;function Bc(e,t){var s=ge(e),o=!s&&Mi(e),h=!s&&!o&&yi(e),p=!s&&!o&&!h&&os(e),m=s||o||h||p,_=m?Ga(e.length,Uf):[],P=_.length;for(var q in e)(t||je.call(e,q))&&!(m&&(q=="length"||h&&(q=="offset"||q=="parent")||p&&(q=="buffer"||q=="byteLength"||q=="byteOffset")||Xr(q,P)))&&_.push(q);return _}function Gc(e){var t=e.length;return t?e[ho(0,t-1)]:r}function Tp(e,t){return Bn(sr(e),$i(t,0,e.length))}function Np(e){return Bn(sr(e))}function eo(e,t,s){(s!==r&&!Tr(e[t],s)||s===r&&!(t in e))&&Jr(e,t,s)}function Ps(e,t,s){var o=e[t];(!(je.call(e,t)&&Tr(o,s))||s===r&&!(t in e))&&Jr(e,t,s)}function $n(e,t){for(var s=e.length;s--;)if(Tr(e[s][0],t))return s;return-1}function $p(e,t,s,o){return pi(e,function(h,p,m){t(o,h,s(h),m)}),o}function Wc(e,t){return e&&Ur(t,zt(t),e)}function Dp(e,t){return e&&Ur(t,ar(t),e)}function Jr(e,t,s){t=="__proto__"&&On?On(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function to(e,t){for(var s=-1,o=t.length,h=C(o),p=e==null;++s<o;)h[s]=p?r:qo(e,t[s]);return h}function $i(e,t,s){return e===e&&(s!==r&&(e=e<=s?e:s),t!==r&&(e=e>=t?e:t)),e}function Er(e,t,s,o,h,p){var m,_=t&O,P=t&R,q=t&z;if(s&&(m=h?s(e,o,h,p):s(e)),m!==r)return m;if(!ct(e))return e;var M=ge(e);if(M){if(m=Ed(e),!_)return sr(e,m)}else{var H=Bt(e),G=H==Z||H==oe;if(yi(e))return mu(e,_);if(H==xe||H==_e||G&&!h){if(m=P||G?{}:Mu(e),!_)return P?ld(e,Dp(m,e)):hd(e,Wc(m,e))}else{if(!He[H])return h?e:{};m=Id(e,H,_)}}p||(p=new Ar);var ee=p.get(e);if(ee)return ee;p.set(e,m),fh(e)?e.forEach(function(ae){m.add(Er(ae,t,s,ae,e,p))}):hh(e)&&e.forEach(function(ae,Ie){m.set(Ie,Er(ae,t,s,Ie,e,p))});var ne=q?P?Eo:bo:P?ar:zt,we=M?r:ne(e);return wr(we||e,function(ae,Ie){we&&(Ie=ae,ae=e[Ie]),Ps(m,Ie,Er(ae,t,s,Ie,e,p))}),m}function Lp(e){var t=zt(e);return function(s){return Jc(s,e,t)}}function Jc(e,t,s){var o=s.length;if(e==null)return!o;for(e=Ge(e);o--;){var h=s[o],p=t[h],m=e[h];if(m===r&&!(h in e)||!p(m))return!1}return!0}function Qc(e,t,s){if(typeof e!="function")throw new _r(d);return Ns(function(){e.apply(r,s)},t)}function Ss(e,t,s,o){var h=-1,p=vn,m=!0,_=e.length,P=[],q=t.length;if(!_)return P;s&&(t=it(t,fr(s))),o?(p=Ha,m=!1):t.length>=a&&(p=ws,m=!1,t=new Ni(t));e:for(;++h<_;){var M=e[h],H=s==null?M:s(M);if(M=o||M!==0?M:0,m&&H===H){for(var G=q;G--;)if(t[G]===H)continue e;P.push(M)}else p(t,H,o)||P.push(M)}return P}var pi=Iu(zr),Yc=Iu(io,!0);function qp(e,t){var s=!0;return pi(e,function(o,h,p){return s=!!t(o,h,p),s}),s}function Dn(e,t,s){for(var o=-1,h=e.length;++o<h;){var p=e[o],m=t(p);if(m!=null&&(_===r?m===m&&!dr(m):s(m,_)))var _=m,P=p}return P}function Mp(e,t,s,o){var h=e.length;for(s=ye(s),s<0&&(s=-s>h?0:h+s),o=o===r||o>h?h:ye(o),o<0&&(o+=h),o=s>o?0:dh(o);s<o;)e[s++]=t;return e}function Xc(e,t){var s=[];return pi(e,function(o,h,p){t(o,h,p)&&s.push(o)}),s}function Kt(e,t,s,o,h){var p=-1,m=e.length;for(s||(s=Pd),h||(h=[]);++p<m;){var _=e[p];t>0&&s(_)?t>1?Kt(_,t-1,s,o,h):hi(h,_):o||(h[h.length]=_)}return h}var ro=xu(),Zc=xu(!0);function zr(e,t){return e&&ro(e,t,zt)}function io(e,t){return e&&Zc(e,t,zt)}function Ln(e,t){return ui(t,function(s){return Zr(e[s])})}function Di(e,t){t=gi(t,e);for(var s=0,o=t.length;e!=null&&s<o;)e=e[Hr(t[s++])];return s&&s==o?e:r}function eu(e,t,s){var o=t(e);return ge(e)?o:hi(o,s(e))}function Xt(e){return e==null?e===r?at:$e:Ai&&Ai in Ge(e)?wd(e):Nd(e)}function so(e,t){return e>t}function jp(e,t){return e!=null&&je.call(e,t)}function zp(e,t){return e!=null&&t in Ge(e)}function Up(e,t,s){return e>=Ft(t,s)&&e<qt(t,s)}function no(e,t,s){for(var o=s?Ha:vn,h=e[0].length,p=e.length,m=p,_=C(p),P=1/0,q=[];m--;){var M=e[m];m&&t&&(M=it(M,fr(t))),P=Ft(M.length,P),_[m]=!s&&(t||h>=120&&M.length>=120)?new Ni(m&&M):r}M=e[0];var H=-1,G=_[0];e:for(;++H<h&&q.length<P;){var ee=M[H],ne=t?t(ee):ee;if(ee=s||ee!==0?ee:0,!(G?ws(G,ne):o(q,ne,s))){for(m=p;--m;){var we=_[m];if(!(we?ws(we,ne):o(e[m],ne,s)))continue e}G&&G.push(ne),q.push(ee)}}return q}function Hp(e,t,s,o){return zr(e,function(h,p,m){t(o,s(h),p,m)}),o}function Os(e,t,s){t=gi(t,e),e=Hu(e,t);var o=e==null?e:e[Hr(xr(t))];return o==null?r:jt(o,e,s)}function tu(e){return yt(e)&&Xt(e)==_e}function kp(e){return yt(e)&&Xt(e)==Ne}function Kp(e){return yt(e)&&Xt(e)==S}function Cs(e,t,s,o,h){return e===t?!0:e==null||t==null||!yt(e)&&!yt(t)?e!==e&&t!==t:Vp(e,t,s,o,Cs,h)}function Vp(e,t,s,o,h,p){var m=ge(e),_=ge(t),P=m?It:Bt(e),q=_?It:Bt(t);P=P==_e?xe:P,q=q==_e?xe:q;var M=P==xe,H=q==xe,G=P==q;if(G&&yi(e)){if(!yi(t))return!1;m=!0,M=!1}if(G&&!M)return p||(p=new Ar),m||os(e)?Du(e,t,s,o,h,p):yd(e,t,P,s,o,h,p);if(!(s&D)){var ee=M&&je.call(e,"__wrapped__"),ne=H&&je.call(t,"__wrapped__");if(ee||ne){var we=ee?e.value():e,ae=ne?t.value():t;return p||(p=new Ar),h(we,ae,s,o,p)}}return G?(p||(p=new Ar),md(e,t,s,o,h,p)):!1}function Fp(e){return yt(e)&&Bt(e)==me}function ao(e,t,s,o){var h=s.length,p=h,m=!o;if(e==null)return!p;for(e=Ge(e);h--;){var _=s[h];if(m&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++h<p;){_=s[h];var P=_[0],q=e[P],M=_[1];if(m&&_[2]){if(q===r&&!(P in e))return!1}else{var H=new Ar;if(o)var G=o(q,M,P,e,t,H);if(!(G===r?Cs(M,q,D|V,o,H):G))return!1}}return!0}function ru(e){if(!ct(e)||Od(e))return!1;var t=Zr(e)?Ff:Pa;return t.test(qi(e))}function Bp(e){return yt(e)&&Xt(e)==nt}function Gp(e){return yt(e)&&Bt(e)==Le}function Wp(e){return yt(e)&&Xn(e.length)&&!!Ve[Xt(e)]}function iu(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?ge(e)?au(e[0],e[1]):nu(e):Ph(e)}function oo(e){if(!Ts(e))return Yf(e);var t=[];for(var s in Ge(e))je.call(e,s)&&s!="constructor"&&t.push(s);return t}function Jp(e){if(!ct(e))return Td(e);var t=Ts(e),s=[];for(var o in e)o=="constructor"&&(t||!je.call(e,o))||s.push(o);return s}function co(e,t){return e<t}function su(e,t){var s=-1,o=nr(e)?C(e.length):[];return pi(e,function(h,p,m){o[++s]=t(h,p,m)}),o}function nu(e){var t=xo(e);return t.length==1&&t[0][2]?zu(t[0][0],t[0][1]):function(s){return s===e||ao(s,e,t)}}function au(e,t){return So(e)&&ju(t)?zu(Hr(e),t):function(s){var o=qo(s,e);return o===r&&o===t?Mo(s,e):Cs(t,o,D|V)}}function qn(e,t,s,o,h){e!==t&&ro(t,function(p,m){if(h||(h=new Ar),ct(p))Qp(e,t,m,s,qn,o,h);else{var _=o?o(Co(e,m),p,m+"",e,t,h):r;_===r&&(_=p),eo(e,m,_)}},ar)}function Qp(e,t,s,o,h,p,m){var _=Co(e,s),P=Co(t,s),q=m.get(P);if(q){eo(e,s,q);return}var M=p?p(_,P,s+"",e,t,m):r,H=M===r;if(H){var G=ge(P),ee=!G&&yi(P),ne=!G&&!ee&&os(P);M=P,G||ee||ne?ge(_)?M=_:bt(_)?M=sr(_):ee?(H=!1,M=mu(P,!0)):ne?(H=!1,M=wu(P,!0)):M=[]:$s(P)||Mi(P)?(M=_,Mi(_)?M=gh(_):(!ct(_)||Zr(_))&&(M=Mu(P))):H=!1}H&&(m.set(P,M),h(M,P,o,p,m),m.delete(P)),eo(e,s,M)}function ou(e,t){var s=e.length;if(s)return t+=t<0?s:0,Xr(t,s)?e[t]:r}function cu(e,t,s){t.length?t=it(t,function(p){return ge(p)?function(m){return Di(m,p.length===1?p[0]:p)}:p}):t=[or];var o=-1;t=it(t,fr(se()));var h=su(e,function(p,m,_){var P=it(t,function(q){return q(p)});return{criteria:P,index:++o,value:p}});return If(h,function(p,m){return ud(p,m,s)})}function Yp(e,t){return uu(e,t,function(s,o){return Mo(e,o)})}function uu(e,t,s){for(var o=-1,h=t.length,p={};++o<h;){var m=t[o],_=Di(e,m);s(_,m)&&Rs(p,gi(m,e),_)}return p}function Xp(e){return function(t){return Di(t,e)}}function uo(e,t,s,o){var h=o?Ef:Qi,p=-1,m=t.length,_=e;for(e===t&&(t=sr(t)),s&&(_=it(e,fr(s)));++p<m;)for(var P=0,q=t[p],M=s?s(q):q;(P=h(_,M,P,o))>-1;)_!==e&&Sn.call(_,P,1),Sn.call(e,P,1);return e}function hu(e,t){for(var s=e?t.length:0,o=s-1;s--;){var h=t[s];if(s==o||h!==p){var p=h;Xr(h)?Sn.call(e,h,1):po(e,h)}}return e}function ho(e,t){return e+Rn(Vc()*(t-e+1))}function Zp(e,t,s,o){for(var h=-1,p=qt(Cn((t-e)/(s||1)),0),m=C(p);p--;)m[o?p:++h]=e,e+=s;return m}function lo(e,t){var s="";if(!e||t<1||t>J)return s;do t%2&&(s+=e),t=Rn(t/2),t&&(e+=e);while(t);return s}function be(e,t){return Ro(Uu(e,t,or),e+"")}function ed(e){return Gc(cs(e))}function td(e,t){var s=cs(e);return Bn(s,$i(t,0,s.length))}function Rs(e,t,s,o){if(!ct(e))return e;t=gi(t,e);for(var h=-1,p=t.length,m=p-1,_=e;_!=null&&++h<p;){var P=Hr(t[h]),q=s;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(h!=m){var M=_[P];q=o?o(M,P,_):r,q===r&&(q=ct(M)?M:Xr(t[h+1])?[]:{})}Ps(_,P,q),_=_[P]}return e}var lu=An?function(e,t){return An.set(e,t),e}:or,rd=On?function(e,t){return On(e,"toString",{configurable:!0,enumerable:!1,value:zo(t),writable:!0})}:or;function id(e){return Bn(cs(e))}function Ir(e,t,s){var o=-1,h=e.length;t<0&&(t=-t>h?0:h+t),s=s>h?h:s,s<0&&(s+=h),h=t>s?0:s-t>>>0,t>>>=0;for(var p=C(h);++o<h;)p[o]=e[o+t];return p}function sd(e,t){var s;return pi(e,function(o,h,p){return s=t(o,h,p),!s}),!!s}function Mn(e,t,s){var o=0,h=e==null?o:e.length;if(typeof t=="number"&&t===t&&h<=ke){for(;o<h;){var p=o+h>>>1,m=e[p];m!==null&&!dr(m)&&(s?m<=t:m<t)?o=p+1:h=p}return h}return fo(e,t,or,s)}function fo(e,t,s,o){var h=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var m=t!==t,_=t===null,P=dr(t),q=t===r;h<p;){var M=Rn((h+p)/2),H=s(e[M]),G=H!==r,ee=H===null,ne=H===H,we=dr(H);if(m)var ae=o||ne;else q?ae=ne&&(o||G):_?ae=ne&&G&&(o||!ee):P?ae=ne&&G&&!ee&&(o||!we):ee||we?ae=!1:ae=o?H<=t:H<t;ae?h=M+1:p=M}return Ft(p,ut)}function fu(e,t){for(var s=-1,o=e.length,h=0,p=[];++s<o;){var m=e[s],_=t?t(m):m;if(!s||!Tr(_,P)){var P=_;p[h++]=m===0?0:m}}return p}function pu(e){return typeof e=="number"?e:dr(e)?K:+e}function pr(e){if(typeof e=="string")return e;if(ge(e))return it(e,pr)+"";if(dr(e))return Fc?Fc.call(e):"";var t=e+"";return t=="0"&&1/e==-Ae?"-0":t}function di(e,t,s){var o=-1,h=vn,p=e.length,m=!0,_=[],P=_;if(s)m=!1,h=Ha;else if(p>=a){var q=t?null:gd(e);if(q)return mn(q);m=!1,h=ws,P=new Ni}else P=t?[]:_;e:for(;++o<p;){var M=e[o],H=t?t(M):M;if(M=s||M!==0?M:0,m&&H===H){for(var G=P.length;G--;)if(P[G]===H)continue e;t&&P.push(H),_.push(M)}else h(P,H,s)||(P!==_&&P.push(H),_.push(M))}return _}function po(e,t){return t=gi(t,e),e=Hu(e,t),e==null||delete e[Hr(xr(t))]}function du(e,t,s,o){return Rs(e,t,s(Di(e,t)),o)}function jn(e,t,s,o){for(var h=e.length,p=o?h:-1;(o?p--:++p<h)&&t(e[p],p,e););return s?Ir(e,o?0:p,o?p+1:h):Ir(e,o?p+1:0,o?h:p)}function gu(e,t){var s=e;return s instanceof Pe&&(s=s.value()),ka(t,function(o,h){return h.func.apply(h.thisArg,hi([o],h.args))},s)}function go(e,t,s){var o=e.length;if(o<2)return o?di(e[0]):[];for(var h=-1,p=C(o);++h<o;)for(var m=e[h],_=-1;++_<o;)_!=h&&(p[h]=Ss(p[h]||m,e[_],t,s));return di(Kt(p,1),t,s)}function vu(e,t,s){for(var o=-1,h=e.length,p=t.length,m={};++o<h;){var _=o<p?t[o]:r;s(m,e[o],_)}return m}function vo(e){return bt(e)?e:[]}function yo(e){return typeof e=="function"?e:or}function gi(e,t){return ge(e)?e:So(e,t)?[e]:Fu(qe(e))}var nd=be;function vi(e,t,s){var o=e.length;return s=s===r?o:s,!t&&s>=o?e:Ir(e,t,s)}var yu=Bf||function(e){return Oe.clearTimeout(e)};function mu(e,t){if(t)return e.slice();var s=e.length,o=zc?zc(s):new e.constructor(s);return e.copy(o),o}function mo(e){var t=new e.constructor(e.byteLength);return new xn(t).set(new xn(e)),t}function ad(e,t){var s=t?mo(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function od(e){var t=new e.constructor(e.source,yr.exec(e));return t.lastIndex=e.lastIndex,t}function cd(e){return xs?Ge(xs.call(e)):{}}function wu(e,t){var s=t?mo(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function _u(e,t){if(e!==t){var s=e!==r,o=e===null,h=e===e,p=dr(e),m=t!==r,_=t===null,P=t===t,q=dr(t);if(!_&&!q&&!p&&e>t||p&&m&&P&&!_&&!q||o&&m&&P||!s&&P||!h)return 1;if(!o&&!p&&!q&&e<t||q&&s&&h&&!o&&!p||_&&s&&h||!m&&h||!P)return-1}return 0}function ud(e,t,s){for(var o=-1,h=e.criteria,p=t.criteria,m=h.length,_=s.length;++o<m;){var P=_u(h[o],p[o]);if(P){if(o>=_)return P;var q=s[o];return P*(q=="desc"?-1:1)}}return e.index-t.index}function bu(e,t,s,o){for(var h=-1,p=e.length,m=s.length,_=-1,P=t.length,q=qt(p-m,0),M=C(P+q),H=!o;++_<P;)M[_]=t[_];for(;++h<m;)(H||h<p)&&(M[s[h]]=e[h]);for(;q--;)M[_++]=e[h++];return M}function Eu(e,t,s,o){for(var h=-1,p=e.length,m=-1,_=s.length,P=-1,q=t.length,M=qt(p-_,0),H=C(M+q),G=!o;++h<M;)H[h]=e[h];for(var ee=h;++P<q;)H[ee+P]=t[P];for(;++m<_;)(G||h<p)&&(H[ee+s[m]]=e[h++]);return H}function sr(e,t){var s=-1,o=e.length;for(t||(t=C(o));++s<o;)t[s]=e[s];return t}function Ur(e,t,s,o){var h=!s;s||(s={});for(var p=-1,m=t.length;++p<m;){var _=t[p],P=o?o(s[_],e[_],_,s,e):r;P===r&&(P=e[_]),h?Jr(s,_,P):Ps(s,_,P)}return s}function hd(e,t){return Ur(e,Po(e),t)}function ld(e,t){return Ur(e,Lu(e),t)}function zn(e,t){return function(s,o){var h=ge(s)?vf:$p,p=t?t():{};return h(s,e,se(o,2),p)}}function ss(e){return be(function(t,s){var o=-1,h=s.length,p=h>1?s[h-1]:r,m=h>2?s[2]:r;for(p=e.length>3&&typeof p=="function"?(h--,p):r,m&&Zt(s[0],s[1],m)&&(p=h<3?r:p,h=1),t=Ge(t);++o<h;){var _=s[o];_&&e(t,_,o,p)}return t})}function Iu(e,t){return function(s,o){if(s==null)return s;if(!nr(s))return e(s,o);for(var h=s.length,p=t?h:-1,m=Ge(s);(t?p--:++p<h)&&o(m[p],p,m)!==!1;);return s}}function xu(e){return function(t,s,o){for(var h=-1,p=Ge(t),m=o(t),_=m.length;_--;){var P=m[e?_:++h];if(s(p[P],P,p)===!1)break}return t}}function fd(e,t,s){var o=t&re,h=As(e);function p(){var m=this&&this!==Oe&&this instanceof p?h:e;return m.apply(o?s:this,arguments)}return p}function Pu(e){return function(t){t=qe(t);var s=Yi(t)?Rr(t):r,o=s?s[0]:t.charAt(0),h=s?vi(s,1).join(""):t.slice(1);return o[e]()+h}}function ns(e){return function(t){return ka(Ih(Eh(t).replace(ys,"")),e,"")}}function As(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=is(e.prototype),o=e.apply(s,t);return ct(o)?o:s}}function pd(e,t,s){var o=As(e);function h(){for(var p=arguments.length,m=C(p),_=p,P=as(h);_--;)m[_]=arguments[_];var q=p<3&&m[0]!==P&&m[p-1]!==P?[]:li(m,P);if(p-=q.length,p<s)return Au(e,t,Un,h.placeholder,r,m,q,r,r,s-p);var M=this&&this!==Oe&&this instanceof h?o:e;return jt(M,this,m)}return h}function Su(e){return function(t,s,o){var h=Ge(t);if(!nr(t)){var p=se(s,3);t=zt(t),s=function(_){return p(h[_],_,h)}}var m=e(t,s,o);return m>-1?h[p?t[m]:m]:r}}function Ou(e){return Yr(function(t){var s=t.length,o=s,h=br.prototype.thru;for(e&&t.reverse();o--;){var p=t[o];if(typeof p!="function")throw new _r(d);if(h&&!m&&Vn(p)=="wrapper")var m=new br([],!0)}for(o=m?o:s;++o<s;){p=t[o];var _=Vn(p),P=_=="wrapper"?Io(p):r;P&&Oo(P[0])&&P[1]==(k|he|pe|W)&&!P[4].length&&P[9]==1?m=m[Vn(P[0])].apply(m,P[3]):m=p.length==1&&Oo(p)?m[_]():m.thru(p)}return function(){var q=arguments,M=q[0];if(m&&q.length==1&&ge(M))return m.plant(M).value();for(var H=0,G=s?t[H].apply(this,q):M;++H<s;)G=t[H].call(this,G);return G}})}function Un(e,t,s,o,h,p,m,_,P,q){var M=t&k,H=t&re,G=t&ce,ee=t&(he|fe),ne=t&ve,we=G?r:As(e);function ae(){for(var Ie=arguments.length,Ce=C(Ie),gr=Ie;gr--;)Ce[gr]=arguments[gr];if(ee)var er=as(ae),vr=Pf(Ce,er);if(o&&(Ce=bu(Ce,o,h,ee)),p&&(Ce=Eu(Ce,p,m,ee)),Ie-=vr,ee&&Ie<q){var Et=li(Ce,er);return Au(e,t,Un,ae.placeholder,s,Ce,Et,_,P,q-Ie)}var Nr=H?s:this,ti=G?Nr[e]:e;return Ie=Ce.length,_?Ce=$d(Ce,_):ne&&Ie>1&&Ce.reverse(),M&&P<Ie&&(Ce.length=P),this&&this!==Oe&&this instanceof ae&&(ti=we||As(ti)),ti.apply(Nr,Ce)}return ae}function Cu(e,t){return function(s,o){return Hp(s,e,t(o),{})}}function Hn(e,t){return function(s,o){var h;if(s===r&&o===r)return t;if(s!==r&&(h=s),o!==r){if(h===r)return o;typeof s=="string"||typeof o=="string"?(s=pr(s),o=pr(o)):(s=pu(s),o=pu(o)),h=e(s,o)}return h}}function wo(e){return Yr(function(t){return t=it(t,fr(se())),be(function(s){var o=this;return e(t,function(h){return jt(h,o,s)})})})}function kn(e,t){t=t===r?" ":pr(t);var s=t.length;if(s<2)return s?lo(t,e):t;var o=lo(t,Cn(e/Xi(t)));return Yi(t)?vi(Rr(o),0,e).join(""):o.slice(0,e)}function dd(e,t,s,o){var h=t&re,p=As(e);function m(){for(var _=-1,P=arguments.length,q=-1,M=o.length,H=C(M+P),G=this&&this!==Oe&&this instanceof m?p:e;++q<M;)H[q]=o[q];for(;P--;)H[q++]=arguments[++_];return jt(G,h?s:this,H)}return m}function Ru(e){return function(t,s,o){return o&&typeof o!="number"&&Zt(t,s,o)&&(s=o=r),t=ei(t),s===r?(s=t,t=0):s=ei(s),o=o===r?t<s?1:-1:ei(o),Zp(t,s,o,e)}}function Kn(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=Pr(t),s=Pr(s)),e(t,s)}}function Au(e,t,s,o,h,p,m,_,P,q){var M=t&he,H=M?m:r,G=M?r:m,ee=M?p:r,ne=M?r:p;t|=M?pe:$,t&=~(M?$:pe),t&ue||(t&=~(re|ce));var we=[e,t,h,ee,H,ne,G,_,P,q],ae=s.apply(r,we);return Oo(e)&&ku(ae,we),ae.placeholder=o,Ku(ae,e,t)}function _o(e){var t=Lt[e];return function(s,o){if(s=Pr(s),o=o==null?0:Ft(ye(o),292),o&&Kc(s)){var h=(qe(s)+"e").split("e"),p=t(h[0]+"e"+(+h[1]+o));return h=(qe(p)+"e").split("e"),+(h[0]+"e"+(+h[1]-o))}return t(s)}}var gd=ts&&1/mn(new ts([,-0]))[1]==Ae?function(e){return new ts(e)}:ko;function Tu(e){return function(t){var s=Bt(t);return s==me?Ja(t):s==Le?Nf(t):xf(t,e(t))}}function Qr(e,t,s,o,h,p,m,_){var P=t&ce;if(!P&&typeof e!="function")throw new _r(d);var q=o?o.length:0;if(q||(t&=~(pe|$),o=h=r),m=m===r?m:qt(ye(m),0),_=_===r?_:ye(_),q-=h?h.length:0,t&$){var M=o,H=h;o=h=r}var G=P?r:Io(e),ee=[e,t,s,o,h,M,H,p,m,_];if(G&&Ad(ee,G),e=ee[0],t=ee[1],s=ee[2],o=ee[3],h=ee[4],_=ee[9]=ee[9]===r?P?0:e.length:qt(ee[9]-q,0),!_&&t&(he|fe)&&(t&=~(he|fe)),!t||t==re)var ne=fd(e,t,s);else t==he||t==fe?ne=pd(e,t,_):(t==pe||t==(re|pe))&&!h.length?ne=dd(e,t,s,o):ne=Un.apply(r,ee);var we=G?lu:ku;return Ku(we(ne,ee),e,t)}function Nu(e,t,s,o){return e===r||Tr(e,es[s])&&!je.call(o,s)?t:e}function $u(e,t,s,o,h,p){return ct(e)&&ct(t)&&(p.set(t,e),qn(e,t,r,$u,p),p.delete(t)),e}function vd(e){return $s(e)?r:e}function Du(e,t,s,o,h,p){var m=s&D,_=e.length,P=t.length;if(_!=P&&!(m&&P>_))return!1;var q=p.get(e),M=p.get(t);if(q&&M)return q==t&&M==e;var H=-1,G=!0,ee=s&V?new Ni:r;for(p.set(e,t),p.set(t,e);++H<_;){var ne=e[H],we=t[H];if(o)var ae=m?o(we,ne,H,t,e,p):o(ne,we,H,e,t,p);if(ae!==r){if(ae)continue;G=!1;break}if(ee){if(!Ka(t,function(Ie,Ce){if(!ws(ee,Ce)&&(ne===Ie||h(ne,Ie,s,o,p)))return ee.push(Ce)})){G=!1;break}}else if(!(ne===we||h(ne,we,s,o,p))){G=!1;break}}return p.delete(e),p.delete(t),G}function yd(e,t,s,o,h,p,m){switch(s){case Ke:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ne:return!(e.byteLength!=t.byteLength||!p(new xn(e),new xn(t)));case T:case S:case Te:return Tr(+e,+t);case b:return e.name==t.name&&e.message==t.message;case nt:case Je:return e==t+"";case me:var _=Ja;case Le:var P=o&D;if(_||(_=mn),e.size!=t.size&&!P)return!1;var q=m.get(e);if(q)return q==t;o|=V,m.set(e,t);var M=Du(_(e),_(t),o,h,p,m);return m.delete(e),M;case Qe:if(xs)return xs.call(e)==xs.call(t)}return!1}function md(e,t,s,o,h,p){var m=s&D,_=bo(e),P=_.length,q=bo(t),M=q.length;if(P!=M&&!m)return!1;for(var H=P;H--;){var G=_[H];if(!(m?G in t:je.call(t,G)))return!1}var ee=p.get(e),ne=p.get(t);if(ee&&ne)return ee==t&&ne==e;var we=!0;p.set(e,t),p.set(t,e);for(var ae=m;++H<P;){G=_[H];var Ie=e[G],Ce=t[G];if(o)var gr=m?o(Ce,Ie,G,t,e,p):o(Ie,Ce,G,e,t,p);if(!(gr===r?Ie===Ce||h(Ie,Ce,s,o,p):gr)){we=!1;break}ae||(ae=G=="constructor")}if(we&&!ae){var er=e.constructor,vr=t.constructor;er!=vr&&"constructor"in e&&"constructor"in t&&!(typeof er=="function"&&er instanceof er&&typeof vr=="function"&&vr instanceof vr)&&(we=!1)}return p.delete(e),p.delete(t),we}function Yr(e){return Ro(Uu(e,r,Ju),e+"")}function bo(e){return eu(e,zt,Po)}function Eo(e){return eu(e,ar,Lu)}var Io=An?function(e){return An.get(e)}:ko;function Vn(e){for(var t=e.name+"",s=rs[t],o=je.call(rs,t)?s.length:0;o--;){var h=s[o],p=h.func;if(p==null||p==e)return h.name}return t}function as(e){var t=je.call(f,"placeholder")?f:e;return t.placeholder}function se(){var e=f.iteratee||Uo;return e=e===Uo?iu:e,arguments.length?e(arguments[0],arguments[1]):e}function Fn(e,t){var s=e.__data__;return Sd(t)?s[typeof t=="string"?"string":"hash"]:s.map}function xo(e){for(var t=zt(e),s=t.length;s--;){var o=t[s],h=e[o];t[s]=[o,h,ju(h)]}return t}function Li(e,t){var s=Rf(e,t);return ru(s)?s:r}function wd(e){var t=je.call(e,Ai),s=e[Ai];try{e[Ai]=r;var o=!0}catch{}var h=En.call(e);return o&&(t?e[Ai]=s:delete e[Ai]),h}var Po=Ya?function(e){return e==null?[]:(e=Ge(e),ui(Ya(e),function(t){return Hc.call(e,t)}))}:Ko,Lu=Ya?function(e){for(var t=[];e;)hi(t,Po(e)),e=Pn(e);return t}:Ko,Bt=Xt;(Xa&&Bt(new Xa(new ArrayBuffer(1)))!=Ke||bs&&Bt(new bs)!=me||Za&&Bt(Za.resolve())!=xt||ts&&Bt(new ts)!=Le||Es&&Bt(new Es)!=Ue)&&(Bt=function(e){var t=Xt(e),s=t==xe?e.constructor:r,o=s?qi(s):"";if(o)switch(o){case tp:return Ke;case rp:return me;case ip:return xt;case sp:return Le;case np:return Ue}return t});function _d(e,t,s){for(var o=-1,h=s.length;++o<h;){var p=s[o],m=p.size;switch(p.type){case"drop":e+=m;break;case"dropRight":t-=m;break;case"take":t=Ft(t,e+m);break;case"takeRight":e=qt(e,t-m);break}}return{start:e,end:t}}function bd(e){var t=e.match(We);return t?t[1].split(Rt):[]}function qu(e,t,s){t=gi(t,e);for(var o=-1,h=t.length,p=!1;++o<h;){var m=Hr(t[o]);if(!(p=e!=null&&s(e,m)))break;e=e[m]}return p||++o!=h?p:(h=e==null?0:e.length,!!h&&Xn(h)&&Xr(m,h)&&(ge(e)||Mi(e)))}function Ed(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&je.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Mu(e){return typeof e.constructor=="function"&&!Ts(e)?is(Pn(e)):{}}function Id(e,t,s){var o=e.constructor;switch(t){case Ne:return mo(e);case T:case S:return new o(+e);case Ke:return ad(e,s);case ht:case Me:case Pt:case Dt:case Ht:case kt:case Mt:case Jt:case rr:return wu(e,s);case me:return new o;case Te:case Je:return new o(e);case nt:return od(e);case Le:return new o;case Qe:return cd(e)}}function xd(e,t){var s=t.length;if(!s)return e;var o=s-1;return t[o]=(s>1?"& ":"")+t[o],t=t.join(s>2?", ":" "),e.replace(vt,`{
/* [wrapped with `+t+`] */
`)}function Pd(e){return ge(e)||Mi(e)||!!(kc&&e&&e[kc])}function Xr(e,t){var s=typeof e;return t=t??J,!!t&&(s=="number"||s!="symbol"&&Oa.test(e))&&e>-1&&e%1==0&&e<t}function Zt(e,t,s){if(!ct(s))return!1;var o=typeof t;return(o=="number"?nr(s)&&Xr(t,s.length):o=="string"&&t in s)?Tr(s[t],e):!1}function So(e,t){if(ge(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||dr(e)?!0:St.test(e)||!rt.test(e)||t!=null&&e in Ge(t)}function Sd(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Oo(e){var t=Vn(e),s=f[t];if(typeof s!="function"||!(t in Pe.prototype))return!1;if(e===s)return!0;var o=Io(s);return!!o&&e===o[0]}function Od(e){return!!jc&&jc in e}var Cd=_n?Zr:Vo;function Ts(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||es;return e===s}function ju(e){return e===e&&!ct(e)}function zu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==r||e in Ge(s))}}function Rd(e){var t=Qn(e,function(o){return s.size===y&&s.clear(),o}),s=t.cache;return t}function Ad(e,t){var s=e[1],o=t[1],h=s|o,p=h<(re|ce|k),m=o==k&&s==he||o==k&&s==W&&e[7].length<=t[8]||o==(k|W)&&t[7].length<=t[8]&&s==he;if(!(p||m))return e;o&re&&(e[2]=t[2],h|=s&re?0:ue);var _=t[3];if(_){var P=e[3];e[3]=P?bu(P,_,t[4]):_,e[4]=P?li(e[3],E):t[4]}return _=t[5],_&&(P=e[5],e[5]=P?Eu(P,_,t[6]):_,e[6]=P?li(e[5],E):t[6]),_=t[7],_&&(e[7]=_),o&k&&(e[8]=e[8]==null?t[8]:Ft(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=h,e}function Td(e){var t=[];if(e!=null)for(var s in Ge(e))t.push(s);return t}function Nd(e){return En.call(e)}function Uu(e,t,s){return t=qt(t===r?e.length-1:t,0),function(){for(var o=arguments,h=-1,p=qt(o.length-t,0),m=C(p);++h<p;)m[h]=o[t+h];h=-1;for(var _=C(t+1);++h<t;)_[h]=o[h];return _[t]=s(m),jt(e,this,_)}}function Hu(e,t){return t.length<2?e:Di(e,Ir(t,0,-1))}function $d(e,t){for(var s=e.length,o=Ft(t.length,s),h=sr(e);o--;){var p=t[o];e[o]=Xr(p,s)?h[p]:r}return e}function Co(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var ku=Vu(lu),Ns=Wf||function(e,t){return Oe.setTimeout(e,t)},Ro=Vu(rd);function Ku(e,t,s){var o=t+"";return Ro(e,xd(o,Dd(bd(o),s)))}function Vu(e){var t=0,s=0;return function(){var o=Xf(),h=et-(o-s);if(s=o,h>0){if(++t>=Re)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Bn(e,t){var s=-1,o=e.length,h=o-1;for(t=t===r?o:t;++s<t;){var p=ho(s,h),m=e[p];e[p]=e[s],e[s]=m}return e.length=t,e}var Fu=Rd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ot,function(s,o,h,p){t.push(h?p.replace(ba,"$1"):o||s)}),t});function Hr(e){if(typeof e=="string"||dr(e))return e;var t=e+"";return t=="0"&&1/e==-Ae?"-0":t}function qi(e){if(e!=null){try{return bn.call(e)}catch{}try{return e+""}catch{}}return""}function Dd(e,t){return wr(Lr,function(s){var o="_."+s[0];t&s[1]&&!vn(e,o)&&e.push(o)}),e.sort()}function Bu(e){if(e instanceof Pe)return e.clone();var t=new br(e.__wrapped__,e.__chain__);return t.__actions__=sr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Ld(e,t,s){(s?Zt(e,t,s):t===r)?t=1:t=qt(ye(t),0);var o=e==null?0:e.length;if(!o||t<1)return[];for(var h=0,p=0,m=C(Cn(o/t));h<o;)m[p++]=Ir(e,h,h+=t);return m}function qd(e){for(var t=-1,s=e==null?0:e.length,o=0,h=[];++t<s;){var p=e[t];p&&(h[o++]=p)}return h}function Md(){var e=arguments.length;if(!e)return[];for(var t=C(e-1),s=arguments[0],o=e;o--;)t[o-1]=arguments[o];return hi(ge(s)?sr(s):[s],Kt(t,1))}var jd=be(function(e,t){return bt(e)?Ss(e,Kt(t,1,bt,!0)):[]}),zd=be(function(e,t){var s=xr(t);return bt(s)&&(s=r),bt(e)?Ss(e,Kt(t,1,bt,!0),se(s,2)):[]}),Ud=be(function(e,t){var s=xr(t);return bt(s)&&(s=r),bt(e)?Ss(e,Kt(t,1,bt,!0),r,s):[]});function Hd(e,t,s){var o=e==null?0:e.length;return o?(t=s||t===r?1:ye(t),Ir(e,t<0?0:t,o)):[]}function kd(e,t,s){var o=e==null?0:e.length;return o?(t=s||t===r?1:ye(t),t=o-t,Ir(e,0,t<0?0:t)):[]}function Kd(e,t){return e&&e.length?jn(e,se(t,3),!0,!0):[]}function Vd(e,t){return e&&e.length?jn(e,se(t,3),!0):[]}function Fd(e,t,s,o){var h=e==null?0:e.length;return h?(s&&typeof s!="number"&&Zt(e,t,s)&&(s=0,o=h),Mp(e,t,s,o)):[]}function Gu(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=s==null?0:ye(s);return h<0&&(h=qt(o+h,0)),yn(e,se(t,3),h)}function Wu(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=o-1;return s!==r&&(h=ye(s),h=s<0?qt(o+h,0):Ft(h,o-1)),yn(e,se(t,3),h,!0)}function Ju(e){var t=e==null?0:e.length;return t?Kt(e,1):[]}function Bd(e){var t=e==null?0:e.length;return t?Kt(e,Ae):[]}function Gd(e,t){var s=e==null?0:e.length;return s?(t=t===r?1:ye(t),Kt(e,t)):[]}function Wd(e){for(var t=-1,s=e==null?0:e.length,o={};++t<s;){var h=e[t];o[h[0]]=h[1]}return o}function Qu(e){return e&&e.length?e[0]:r}function Jd(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=s==null?0:ye(s);return h<0&&(h=qt(o+h,0)),Qi(e,t,h)}function Qd(e){var t=e==null?0:e.length;return t?Ir(e,0,-1):[]}var Yd=be(function(e){var t=it(e,vo);return t.length&&t[0]===e[0]?no(t):[]}),Xd=be(function(e){var t=xr(e),s=it(e,vo);return t===xr(s)?t=r:s.pop(),s.length&&s[0]===e[0]?no(s,se(t,2)):[]}),Zd=be(function(e){var t=xr(e),s=it(e,vo);return t=typeof t=="function"?t:r,t&&s.pop(),s.length&&s[0]===e[0]?no(s,r,t):[]});function eg(e,t){return e==null?"":Qf.call(e,t)}function xr(e){var t=e==null?0:e.length;return t?e[t-1]:r}function tg(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=o;return s!==r&&(h=ye(s),h=h<0?qt(o+h,0):Ft(h,o-1)),t===t?Df(e,t,h):yn(e,Ac,h,!0)}function rg(e,t){return e&&e.length?ou(e,ye(t)):r}var ig=be(Yu);function Yu(e,t){return e&&e.length&&t&&t.length?uo(e,t):e}function sg(e,t,s){return e&&e.length&&t&&t.length?uo(e,t,se(s,2)):e}function ng(e,t,s){return e&&e.length&&t&&t.length?uo(e,t,r,s):e}var ag=Yr(function(e,t){var s=e==null?0:e.length,o=to(e,t);return hu(e,it(t,function(h){return Xr(h,s)?+h:h}).sort(_u)),o});function og(e,t){var s=[];if(!(e&&e.length))return s;var o=-1,h=[],p=e.length;for(t=se(t,3);++o<p;){var m=e[o];t(m,o,e)&&(s.push(m),h.push(o))}return hu(e,h),s}function Ao(e){return e==null?e:ep.call(e)}function cg(e,t,s){var o=e==null?0:e.length;return o?(s&&typeof s!="number"&&Zt(e,t,s)?(t=0,s=o):(t=t==null?0:ye(t),s=s===r?o:ye(s)),Ir(e,t,s)):[]}function ug(e,t){return Mn(e,t)}function hg(e,t,s){return fo(e,t,se(s,2))}function lg(e,t){var s=e==null?0:e.length;if(s){var o=Mn(e,t);if(o<s&&Tr(e[o],t))return o}return-1}function fg(e,t){return Mn(e,t,!0)}function pg(e,t,s){return fo(e,t,se(s,2),!0)}function dg(e,t){var s=e==null?0:e.length;if(s){var o=Mn(e,t,!0)-1;if(Tr(e[o],t))return o}return-1}function gg(e){return e&&e.length?fu(e):[]}function vg(e,t){return e&&e.length?fu(e,se(t,2)):[]}function yg(e){var t=e==null?0:e.length;return t?Ir(e,1,t):[]}function mg(e,t,s){return e&&e.length?(t=s||t===r?1:ye(t),Ir(e,0,t<0?0:t)):[]}function wg(e,t,s){var o=e==null?0:e.length;return o?(t=s||t===r?1:ye(t),t=o-t,Ir(e,t<0?0:t,o)):[]}function _g(e,t){return e&&e.length?jn(e,se(t,3),!1,!0):[]}function bg(e,t){return e&&e.length?jn(e,se(t,3)):[]}var Eg=be(function(e){return di(Kt(e,1,bt,!0))}),Ig=be(function(e){var t=xr(e);return bt(t)&&(t=r),di(Kt(e,1,bt,!0),se(t,2))}),xg=be(function(e){var t=xr(e);return t=typeof t=="function"?t:r,di(Kt(e,1,bt,!0),r,t)});function Pg(e){return e&&e.length?di(e):[]}function Sg(e,t){return e&&e.length?di(e,se(t,2)):[]}function Og(e,t){return t=typeof t=="function"?t:r,e&&e.length?di(e,r,t):[]}function To(e){if(!(e&&e.length))return[];var t=0;return e=ui(e,function(s){if(bt(s))return t=qt(s.length,t),!0}),Ga(t,function(s){return it(e,Va(s))})}function Xu(e,t){if(!(e&&e.length))return[];var s=To(e);return t==null?s:it(s,function(o){return jt(t,r,o)})}var Cg=be(function(e,t){return bt(e)?Ss(e,t):[]}),Rg=be(function(e){return go(ui(e,bt))}),Ag=be(function(e){var t=xr(e);return bt(t)&&(t=r),go(ui(e,bt),se(t,2))}),Tg=be(function(e){var t=xr(e);return t=typeof t=="function"?t:r,go(ui(e,bt),r,t)}),Ng=be(To);function $g(e,t){return vu(e||[],t||[],Ps)}function Dg(e,t){return vu(e||[],t||[],Rs)}var Lg=be(function(e){var t=e.length,s=t>1?e[t-1]:r;return s=typeof s=="function"?(e.pop(),s):r,Xu(e,s)});function Zu(e){var t=f(e);return t.__chain__=!0,t}function qg(e,t){return t(e),e}function Gn(e,t){return t(e)}var Mg=Yr(function(e){var t=e.length,s=t?e[0]:0,o=this.__wrapped__,h=function(p){return to(p,e)};return t>1||this.__actions__.length||!(o instanceof Pe)||!Xr(s)?this.thru(h):(o=o.slice(s,+s+(t?1:0)),o.__actions__.push({func:Gn,args:[h],thisArg:r}),new br(o,this.__chain__).thru(function(p){return t&&!p.length&&p.push(r),p}))});function jg(){return Zu(this)}function zg(){return new br(this.value(),this.__chain__)}function Ug(){this.__values__===r&&(this.__values__=ph(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function Hg(){return this}function kg(e){for(var t,s=this;s instanceof Nn;){var o=Bu(s);o.__index__=0,o.__values__=r,t?h.__wrapped__=o:t=o;var h=o;s=s.__wrapped__}return h.__wrapped__=e,t}function Kg(){var e=this.__wrapped__;if(e instanceof Pe){var t=e;return this.__actions__.length&&(t=new Pe(this)),t=t.reverse(),t.__actions__.push({func:Gn,args:[Ao],thisArg:r}),new br(t,this.__chain__)}return this.thru(Ao)}function Vg(){return gu(this.__wrapped__,this.__actions__)}var Fg=zn(function(e,t,s){je.call(e,s)?++e[s]:Jr(e,s,1)});function Bg(e,t,s){var o=ge(e)?Cc:qp;return s&&Zt(e,t,s)&&(t=r),o(e,se(t,3))}function Gg(e,t){var s=ge(e)?ui:Xc;return s(e,se(t,3))}var Wg=Su(Gu),Jg=Su(Wu);function Qg(e,t){return Kt(Wn(e,t),1)}function Yg(e,t){return Kt(Wn(e,t),Ae)}function Xg(e,t,s){return s=s===r?1:ye(s),Kt(Wn(e,t),s)}function eh(e,t){var s=ge(e)?wr:pi;return s(e,se(t,3))}function th(e,t){var s=ge(e)?yf:Yc;return s(e,se(t,3))}var Zg=zn(function(e,t,s){je.call(e,s)?e[s].push(t):Jr(e,s,[t])});function ev(e,t,s,o){e=nr(e)?e:cs(e),s=s&&!o?ye(s):0;var h=e.length;return s<0&&(s=qt(h+s,0)),Zn(e)?s<=h&&e.indexOf(t,s)>-1:!!h&&Qi(e,t,s)>-1}var tv=be(function(e,t,s){var o=-1,h=typeof t=="function",p=nr(e)?C(e.length):[];return pi(e,function(m){p[++o]=h?jt(t,m,s):Os(m,t,s)}),p}),rv=zn(function(e,t,s){Jr(e,s,t)});function Wn(e,t){var s=ge(e)?it:su;return s(e,se(t,3))}function iv(e,t,s,o){return e==null?[]:(ge(t)||(t=t==null?[]:[t]),s=o?r:s,ge(s)||(s=s==null?[]:[s]),cu(e,t,s))}var sv=zn(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function nv(e,t,s){var o=ge(e)?ka:Nc,h=arguments.length<3;return o(e,se(t,4),s,h,pi)}function av(e,t,s){var o=ge(e)?mf:Nc,h=arguments.length<3;return o(e,se(t,4),s,h,Yc)}function ov(e,t){var s=ge(e)?ui:Xc;return s(e,Yn(se(t,3)))}function cv(e){var t=ge(e)?Gc:ed;return t(e)}function uv(e,t,s){(s?Zt(e,t,s):t===r)?t=1:t=ye(t);var o=ge(e)?Tp:td;return o(e,t)}function hv(e){var t=ge(e)?Np:id;return t(e)}function lv(e){if(e==null)return 0;if(nr(e))return Zn(e)?Xi(e):e.length;var t=Bt(e);return t==me||t==Le?e.size:oo(e).length}function fv(e,t,s){var o=ge(e)?Ka:sd;return s&&Zt(e,t,s)&&(t=r),o(e,se(t,3))}var pv=be(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Zt(e,t[0],t[1])?t=[]:s>2&&Zt(t[0],t[1],t[2])&&(t=[t[0]]),cu(e,Kt(t,1),[])}),Jn=Gf||function(){return Oe.Date.now()};function dv(e,t){if(typeof t!="function")throw new _r(d);return e=ye(e),function(){if(--e<1)return t.apply(this,arguments)}}function rh(e,t,s){return t=s?r:t,t=e&&t==null?e.length:t,Qr(e,k,r,r,r,r,t)}function ih(e,t){var s;if(typeof t!="function")throw new _r(d);return e=ye(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=r),s}}var No=be(function(e,t,s){var o=re;if(s.length){var h=li(s,as(No));o|=pe}return Qr(e,o,t,s,h)}),sh=be(function(e,t,s){var o=re|ce;if(s.length){var h=li(s,as(sh));o|=pe}return Qr(t,o,e,s,h)});function nh(e,t,s){t=s?r:t;var o=Qr(e,he,r,r,r,r,r,t);return o.placeholder=nh.placeholder,o}function ah(e,t,s){t=s?r:t;var o=Qr(e,fe,r,r,r,r,r,t);return o.placeholder=ah.placeholder,o}function oh(e,t,s){var o,h,p,m,_,P,q=0,M=!1,H=!1,G=!0;if(typeof e!="function")throw new _r(d);t=Pr(t)||0,ct(s)&&(M=!!s.leading,H="maxWait"in s,p=H?qt(Pr(s.maxWait)||0,t):p,G="trailing"in s?!!s.trailing:G);function ee(Et){var Nr=o,ti=h;return o=h=r,q=Et,m=e.apply(ti,Nr),m}function ne(Et){return q=Et,_=Ns(Ie,t),M?ee(Et):m}function we(Et){var Nr=Et-P,ti=Et-q,Sh=t-Nr;return H?Ft(Sh,p-ti):Sh}function ae(Et){var Nr=Et-P,ti=Et-q;return P===r||Nr>=t||Nr<0||H&&ti>=p}function Ie(){var Et=Jn();if(ae(Et))return Ce(Et);_=Ns(Ie,we(Et))}function Ce(Et){return _=r,G&&o?ee(Et):(o=h=r,m)}function gr(){_!==r&&yu(_),q=0,o=P=h=_=r}function er(){return _===r?m:Ce(Jn())}function vr(){var Et=Jn(),Nr=ae(Et);if(o=arguments,h=this,P=Et,Nr){if(_===r)return ne(P);if(H)return yu(_),_=Ns(Ie,t),ee(P)}return _===r&&(_=Ns(Ie,t)),m}return vr.cancel=gr,vr.flush=er,vr}var gv=be(function(e,t){return Qc(e,1,t)}),vv=be(function(e,t,s){return Qc(e,Pr(t)||0,s)});function yv(e){return Qr(e,ve)}function Qn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new _r(d);var s=function(){var o=arguments,h=t?t.apply(this,o):o[0],p=s.cache;if(p.has(h))return p.get(h);var m=e.apply(this,o);return s.cache=p.set(h,m)||p,m};return s.cache=new(Qn.Cache||Wr),s}Qn.Cache=Wr;function Yn(e){if(typeof e!="function")throw new _r(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function mv(e){return ih(2,e)}var wv=nd(function(e,t){t=t.length==1&&ge(t[0])?it(t[0],fr(se())):it(Kt(t,1),fr(se()));var s=t.length;return be(function(o){for(var h=-1,p=Ft(o.length,s);++h<p;)o[h]=t[h].call(this,o[h]);return jt(e,this,o)})}),$o=be(function(e,t){var s=li(t,as($o));return Qr(e,pe,r,t,s)}),ch=be(function(e,t){var s=li(t,as(ch));return Qr(e,$,r,t,s)}),_v=Yr(function(e,t){return Qr(e,W,r,r,r,t)});function bv(e,t){if(typeof e!="function")throw new _r(d);return t=t===r?t:ye(t),be(e,t)}function Ev(e,t){if(typeof e!="function")throw new _r(d);return t=t==null?0:qt(ye(t),0),be(function(s){var o=s[t],h=vi(s,0,t);return o&&hi(h,o),jt(e,this,h)})}function Iv(e,t,s){var o=!0,h=!0;if(typeof e!="function")throw new _r(d);return ct(s)&&(o="leading"in s?!!s.leading:o,h="trailing"in s?!!s.trailing:h),oh(e,t,{leading:o,maxWait:t,trailing:h})}function xv(e){return rh(e,1)}function Pv(e,t){return $o(yo(t),e)}function Sv(){if(!arguments.length)return[];var e=arguments[0];return ge(e)?e:[e]}function Ov(e){return Er(e,z)}function Cv(e,t){return t=typeof t=="function"?t:r,Er(e,z,t)}function Rv(e){return Er(e,O|z)}function Av(e,t){return t=typeof t=="function"?t:r,Er(e,O|z,t)}function Tv(e,t){return t==null||Jc(e,t,zt(t))}function Tr(e,t){return e===t||e!==e&&t!==t}var Nv=Kn(so),$v=Kn(function(e,t){return e>=t}),Mi=tu(function(){return arguments}())?tu:function(e){return yt(e)&&je.call(e,"callee")&&!Hc.call(e,"callee")},ge=C.isArray,Dv=Yt?fr(Yt):kp;function nr(e){return e!=null&&Xn(e.length)&&!Zr(e)}function bt(e){return yt(e)&&nr(e)}function Lv(e){return e===!0||e===!1||yt(e)&&Xt(e)==T}var yi=Jf||Vo,qv=Cr?fr(Cr):Kp;function Mv(e){return yt(e)&&e.nodeType===1&&!$s(e)}function jv(e){if(e==null)return!0;if(nr(e)&&(ge(e)||typeof e=="string"||typeof e.splice=="function"||yi(e)||os(e)||Mi(e)))return!e.length;var t=Bt(e);if(t==me||t==Le)return!e.size;if(Ts(e))return!oo(e).length;for(var s in e)if(je.call(e,s))return!1;return!0}function zv(e,t){return Cs(e,t)}function Uv(e,t,s){s=typeof s=="function"?s:r;var o=s?s(e,t):r;return o===r?Cs(e,t,r,s):!!o}function Do(e){if(!yt(e))return!1;var t=Xt(e);return t==b||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!$s(e)}function Hv(e){return typeof e=="number"&&Kc(e)}function Zr(e){if(!ct(e))return!1;var t=Xt(e);return t==Z||t==oe||t==N||t==mt}function uh(e){return typeof e=="number"&&e==ye(e)}function Xn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=J}function ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function yt(e){return e!=null&&typeof e=="object"}var hh=mr?fr(mr):Fp;function kv(e,t){return e===t||ao(e,t,xo(t))}function Kv(e,t,s){return s=typeof s=="function"?s:r,ao(e,t,xo(t),s)}function Vv(e){return lh(e)&&e!=+e}function Fv(e){if(Cd(e))throw new le(l);return ru(e)}function Bv(e){return e===null}function Gv(e){return e==null}function lh(e){return typeof e=="number"||yt(e)&&Xt(e)==Te}function $s(e){if(!yt(e)||Xt(e)!=xe)return!1;var t=Pn(e);if(t===null)return!0;var s=je.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&bn.call(s)==Kf}var Lo=jr?fr(jr):Bp;function Wv(e){return uh(e)&&e>=-J&&e<=J}var fh=ms?fr(ms):Gp;function Zn(e){return typeof e=="string"||!ge(e)&&yt(e)&&Xt(e)==Je}function dr(e){return typeof e=="symbol"||yt(e)&&Xt(e)==Qe}var os=Ri?fr(Ri):Wp;function Jv(e){return e===r}function Qv(e){return yt(e)&&Bt(e)==Ue}function Yv(e){return yt(e)&&Xt(e)==Ye}var Xv=Kn(co),Zv=Kn(function(e,t){return e<=t});function ph(e){if(!e)return[];if(nr(e))return Zn(e)?Rr(e):sr(e);if(_s&&e[_s])return Tf(e[_s]());var t=Bt(e),s=t==me?Ja:t==Le?mn:cs;return s(e)}function ei(e){if(!e)return e===0?e:0;if(e=Pr(e),e===Ae||e===-Ae){var t=e<0?-1:1;return t*F}return e===e?e:0}function ye(e){var t=ei(e),s=t%1;return t===t?s?t-s:t:0}function dh(e){return e?$i(ye(e),0,B):0}function Pr(e){if(typeof e=="number")return e;if(dr(e))return K;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=$c(e);var s=xa.test(e);return s||Sa.test(e)?de(e.slice(2),s?2:8):Ia.test(e)?K:+e}function gh(e){return Ur(e,ar(e))}function ey(e){return e?$i(ye(e),-J,J):e===0?e:0}function qe(e){return e==null?"":pr(e)}var ty=ss(function(e,t){if(Ts(t)||nr(t)){Ur(t,zt(t),e);return}for(var s in t)je.call(t,s)&&Ps(e,s,t[s])}),vh=ss(function(e,t){Ur(t,ar(t),e)}),ea=ss(function(e,t,s,o){Ur(t,ar(t),e,o)}),ry=ss(function(e,t,s,o){Ur(t,zt(t),e,o)}),iy=Yr(to);function sy(e,t){var s=is(e);return t==null?s:Wc(s,t)}var ny=be(function(e,t){e=Ge(e);var s=-1,o=t.length,h=o>2?t[2]:r;for(h&&Zt(t[0],t[1],h)&&(o=1);++s<o;)for(var p=t[s],m=ar(p),_=-1,P=m.length;++_<P;){var q=m[_],M=e[q];(M===r||Tr(M,es[q])&&!je.call(e,q))&&(e[q]=p[q])}return e}),ay=be(function(e){return e.push(r,$u),jt(yh,r,e)});function oy(e,t){return Rc(e,se(t,3),zr)}function cy(e,t){return Rc(e,se(t,3),io)}function uy(e,t){return e==null?e:ro(e,se(t,3),ar)}function hy(e,t){return e==null?e:Zc(e,se(t,3),ar)}function ly(e,t){return e&&zr(e,se(t,3))}function fy(e,t){return e&&io(e,se(t,3))}function py(e){return e==null?[]:Ln(e,zt(e))}function dy(e){return e==null?[]:Ln(e,ar(e))}function qo(e,t,s){var o=e==null?r:Di(e,t);return o===r?s:o}function gy(e,t){return e!=null&&qu(e,t,jp)}function Mo(e,t){return e!=null&&qu(e,t,zp)}var vy=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=En.call(t)),e[t]=s},zo(or)),yy=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=En.call(t)),je.call(e,t)?e[t].push(s):e[t]=[s]},se),my=be(Os);function zt(e){return nr(e)?Bc(e):oo(e)}function ar(e){return nr(e)?Bc(e,!0):Jp(e)}function wy(e,t){var s={};return t=se(t,3),zr(e,function(o,h,p){Jr(s,t(o,h,p),o)}),s}function _y(e,t){var s={};return t=se(t,3),zr(e,function(o,h,p){Jr(s,h,t(o,h,p))}),s}var by=ss(function(e,t,s){qn(e,t,s)}),yh=ss(function(e,t,s,o){qn(e,t,s,o)}),Ey=Yr(function(e,t){var s={};if(e==null)return s;var o=!1;t=it(t,function(p){return p=gi(p,e),o||(o=p.length>1),p}),Ur(e,Eo(e),s),o&&(s=Er(s,O|R|z,vd));for(var h=t.length;h--;)po(s,t[h]);return s});function Iy(e,t){return mh(e,Yn(se(t)))}var xy=Yr(function(e,t){return e==null?{}:Yp(e,t)});function mh(e,t){if(e==null)return{};var s=it(Eo(e),function(o){return[o]});return t=se(t),uu(e,s,function(o,h){return t(o,h[0])})}function Py(e,t,s){t=gi(t,e);var o=-1,h=t.length;for(h||(h=1,e=r);++o<h;){var p=e==null?r:e[Hr(t[o])];p===r&&(o=h,p=s),e=Zr(p)?p.call(e):p}return e}function Sy(e,t,s){return e==null?e:Rs(e,t,s)}function Oy(e,t,s,o){return o=typeof o=="function"?o:r,e==null?e:Rs(e,t,s,o)}var wh=Tu(zt),_h=Tu(ar);function Cy(e,t,s){var o=ge(e),h=o||yi(e)||os(e);if(t=se(t,4),s==null){var p=e&&e.constructor;h?s=o?new p:[]:ct(e)?s=Zr(p)?is(Pn(e)):{}:s={}}return(h?wr:zr)(e,function(m,_,P){return t(s,m,_,P)}),s}function Ry(e,t){return e==null?!0:po(e,t)}function Ay(e,t,s){return e==null?e:du(e,t,yo(s))}function Ty(e,t,s,o){return o=typeof o=="function"?o:r,e==null?e:du(e,t,yo(s),o)}function cs(e){return e==null?[]:Wa(e,zt(e))}function Ny(e){return e==null?[]:Wa(e,ar(e))}function $y(e,t,s){return s===r&&(s=t,t=r),s!==r&&(s=Pr(s),s=s===s?s:0),t!==r&&(t=Pr(t),t=t===t?t:0),$i(Pr(e),t,s)}function Dy(e,t,s){return t=ei(t),s===r?(s=t,t=0):s=ei(s),e=Pr(e),Up(e,t,s)}function Ly(e,t,s){if(s&&typeof s!="boolean"&&Zt(e,t,s)&&(t=s=r),s===r&&(typeof t=="boolean"?(s=t,t=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ei(e),t===r?(t=e,e=0):t=ei(t)),e>t){var o=e;e=t,t=o}if(s||e%1||t%1){var h=Vc();return Ft(e+h*(t-e+Fe("1e-"+((h+"").length-1))),t)}return ho(e,t)}var qy=ns(function(e,t,s){return t=t.toLowerCase(),e+(s?bh(t):t)});function bh(e){return jo(qe(e).toLowerCase())}function Eh(e){return e=qe(e),e&&e.replace(Fr,Sf).replace(za,"")}function My(e,t,s){e=qe(e),t=pr(t);var o=e.length;s=s===r?o:$i(ye(s),0,o);var h=s;return s-=t.length,s>=0&&e.slice(s,h)==t}function jy(e){return e=qe(e),e&&tt.test(e)?e.replace(xi,Of):e}function zy(e){return e=qe(e),e&&Ct.test(e)?e.replace(dt,"\\$&"):e}var Uy=ns(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),Hy=ns(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),ky=Pu("toLowerCase");function Ky(e,t,s){e=qe(e),t=ye(t);var o=t?Xi(e):0;if(!t||o>=t)return e;var h=(t-o)/2;return kn(Rn(h),s)+e+kn(Cn(h),s)}function Vy(e,t,s){e=qe(e),t=ye(t);var o=t?Xi(e):0;return t&&o<t?e+kn(t-o,s):e}function Fy(e,t,s){e=qe(e),t=ye(t);var o=t?Xi(e):0;return t&&o<t?kn(t-o,s)+e:e}function By(e,t,s){return s||t==null?t=0:t&&(t=+t),Zf(qe(e).replace(gt,""),t||0)}function Gy(e,t,s){return(s?Zt(e,t,s):t===r)?t=1:t=ye(t),lo(qe(e),t)}function Wy(){var e=arguments,t=qe(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Jy=ns(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function Qy(e,t,s){return s&&typeof s!="number"&&Zt(e,t,s)&&(t=s=r),s=s===r?B:s>>>0,s?(e=qe(e),e&&(typeof t=="string"||t!=null&&!Lo(t))&&(t=pr(t),!t&&Yi(e))?vi(Rr(e),0,s):e.split(t,s)):[]}var Yy=ns(function(e,t,s){return e+(s?" ":"")+jo(t)});function Xy(e,t,s){return e=qe(e),s=s==null?0:$i(ye(s),0,e.length),t=pr(t),e.slice(s,s+t.length)==t}function Zy(e,t,s){var o=f.templateSettings;s&&Zt(e,t,s)&&(t=r),e=qe(e),t=ea({},t,o,Nu);var h=ea({},t.imports,o.imports,Nu),p=zt(h),m=Wa(h,p),_,P,q=0,M=t.interpolate||Ki,H="__p += '",G=Qa((t.escape||Ki).source+"|"+M.source+"|"+(M===ot?Ea:Ki).source+"|"+(t.evaluate||Ki).source+"|$","g"),ee="//# sourceURL="+(je.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ua+"]")+`
`;e.replace(G,function(ae,Ie,Ce,gr,er,vr){return Ce||(Ce=gr),H+=e.slice(q,vr).replace(Ca,Cf),Ie&&(_=!0,H+=`' +
__e(`+Ie+`) +
'`),er&&(P=!0,H+=`';
`+er+`;
__p += '`),Ce&&(H+=`' +
((__t = (`+Ce+`)) == null ? '' : __t) +
'`),q=vr+ae.length,ae}),H+=`';
`;var ne=je.call(t,"variable")&&t.variable;if(!ne)H=`with (obj) {
`+H+`
}
`;else if(_a.test(ne))throw new le(v);H=(P?H.replace(qr,""):H).replace(Qt,"$1").replace(Vr,"$1;"),H="function("+(ne||"obj")+`) {
`+(ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+H+`return __p
}`;var we=xh(function(){return De(p,ee+"return "+H).apply(r,m)});if(we.source=H,Do(we))throw we;return we}function e0(e){return qe(e).toLowerCase()}function t0(e){return qe(e).toUpperCase()}function r0(e,t,s){if(e=qe(e),e&&(s||t===r))return $c(e);if(!e||!(t=pr(t)))return e;var o=Rr(e),h=Rr(t),p=Dc(o,h),m=Lc(o,h)+1;return vi(o,p,m).join("")}function i0(e,t,s){if(e=qe(e),e&&(s||t===r))return e.slice(0,Mc(e)+1);if(!e||!(t=pr(t)))return e;var o=Rr(e),h=Lc(o,Rr(t))+1;return vi(o,0,h).join("")}function s0(e,t,s){if(e=qe(e),e&&(s||t===r))return e.replace(gt,"");if(!e||!(t=pr(t)))return e;var o=Rr(e),h=Dc(o,Rr(t));return vi(o,h).join("")}function n0(e,t){var s=te,o=Ee;if(ct(t)){var h="separator"in t?t.separator:h;s="length"in t?ye(t.length):s,o="omission"in t?pr(t.omission):o}e=qe(e);var p=e.length;if(Yi(e)){var m=Rr(e);p=m.length}if(s>=p)return e;var _=s-Xi(o);if(_<1)return o;var P=m?vi(m,0,_).join(""):e.slice(0,_);if(h===r)return P+o;if(m&&(_+=P.length-_),Lo(h)){if(e.slice(_).search(h)){var q,M=P;for(h.global||(h=Qa(h.source,qe(yr.exec(h))+"g")),h.lastIndex=0;q=h.exec(M);)var H=q.index;P=P.slice(0,H===r?_:H)}}else if(e.indexOf(pr(h),_)!=_){var G=P.lastIndexOf(h);G>-1&&(P=P.slice(0,G))}return P+o}function a0(e){return e=qe(e),e&&lt.test(e)?e.replace(oi,Lf):e}var o0=ns(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),jo=Pu("toUpperCase");function Ih(e,t,s){return e=qe(e),t=s?r:t,t===r?Af(e)?jf(e):bf(e):e.match(t)||[]}var xh=be(function(e,t){try{return jt(e,r,t)}catch(s){return Do(s)?s:new le(s)}}),c0=Yr(function(e,t){return wr(t,function(s){s=Hr(s),Jr(e,s,No(e[s],e))}),e});function u0(e){var t=e==null?0:e.length,s=se();return e=t?it(e,function(o){if(typeof o[1]!="function")throw new _r(d);return[s(o[0]),o[1]]}):[],be(function(o){for(var h=-1;++h<t;){var p=e[h];if(jt(p[0],this,o))return jt(p[1],this,o)}})}function h0(e){return Lp(Er(e,O))}function zo(e){return function(){return e}}function l0(e,t){return e==null||e!==e?t:e}var f0=Ou(),p0=Ou(!0);function or(e){return e}function Uo(e){return iu(typeof e=="function"?e:Er(e,O))}function d0(e){return nu(Er(e,O))}function g0(e,t){return au(e,Er(t,O))}var v0=be(function(e,t){return function(s){return Os(s,e,t)}}),y0=be(function(e,t){return function(s){return Os(e,s,t)}});function Ho(e,t,s){var o=zt(t),h=Ln(t,o);s==null&&!(ct(t)&&(h.length||!o.length))&&(s=t,t=e,e=this,h=Ln(t,zt(t)));var p=!(ct(s)&&"chain"in s)||!!s.chain,m=Zr(e);return wr(h,function(_){var P=t[_];e[_]=P,m&&(e.prototype[_]=function(){var q=this.__chain__;if(p||q){var M=e(this.__wrapped__),H=M.__actions__=sr(this.__actions__);return H.push({func:P,args:arguments,thisArg:e}),M.__chain__=q,M}return P.apply(e,hi([this.value()],arguments))})}),e}function m0(){return Oe._===this&&(Oe._=Vf),this}function ko(){}function w0(e){return e=ye(e),be(function(t){return ou(t,e)})}var _0=wo(it),b0=wo(Cc),E0=wo(Ka);function Ph(e){return So(e)?Va(Hr(e)):Xp(e)}function I0(e){return function(t){return e==null?r:Di(e,t)}}var x0=Ru(),P0=Ru(!0);function Ko(){return[]}function Vo(){return!1}function S0(){return{}}function O0(){return""}function C0(){return!0}function R0(e,t){if(e=ye(e),e<1||e>J)return[];var s=B,o=Ft(e,B);t=se(t),e-=B;for(var h=Ga(o,t);++s<e;)t(s);return h}function A0(e){return ge(e)?it(e,Hr):dr(e)?[e]:sr(Fu(qe(e)))}function T0(e){var t=++kf;return qe(e)+t}var N0=Hn(function(e,t){return e+t},0),$0=_o("ceil"),D0=Hn(function(e,t){return e/t},1),L0=_o("floor");function q0(e){return e&&e.length?Dn(e,or,so):r}function M0(e,t){return e&&e.length?Dn(e,se(t,2),so):r}function j0(e){return Tc(e,or)}function z0(e,t){return Tc(e,se(t,2))}function U0(e){return e&&e.length?Dn(e,or,co):r}function H0(e,t){return e&&e.length?Dn(e,se(t,2),co):r}var k0=Hn(function(e,t){return e*t},1),K0=_o("round"),V0=Hn(function(e,t){return e-t},0);function F0(e){return e&&e.length?Ba(e,or):0}function B0(e,t){return e&&e.length?Ba(e,se(t,2)):0}return f.after=dv,f.ary=rh,f.assign=ty,f.assignIn=vh,f.assignInWith=ea,f.assignWith=ry,f.at=iy,f.before=ih,f.bind=No,f.bindAll=c0,f.bindKey=sh,f.castArray=Sv,f.chain=Zu,f.chunk=Ld,f.compact=qd,f.concat=Md,f.cond=u0,f.conforms=h0,f.constant=zo,f.countBy=Fg,f.create=sy,f.curry=nh,f.curryRight=ah,f.debounce=oh,f.defaults=ny,f.defaultsDeep=ay,f.defer=gv,f.delay=vv,f.difference=jd,f.differenceBy=zd,f.differenceWith=Ud,f.drop=Hd,f.dropRight=kd,f.dropRightWhile=Kd,f.dropWhile=Vd,f.fill=Fd,f.filter=Gg,f.flatMap=Qg,f.flatMapDeep=Yg,f.flatMapDepth=Xg,f.flatten=Ju,f.flattenDeep=Bd,f.flattenDepth=Gd,f.flip=yv,f.flow=f0,f.flowRight=p0,f.fromPairs=Wd,f.functions=py,f.functionsIn=dy,f.groupBy=Zg,f.initial=Qd,f.intersection=Yd,f.intersectionBy=Xd,f.intersectionWith=Zd,f.invert=vy,f.invertBy=yy,f.invokeMap=tv,f.iteratee=Uo,f.keyBy=rv,f.keys=zt,f.keysIn=ar,f.map=Wn,f.mapKeys=wy,f.mapValues=_y,f.matches=d0,f.matchesProperty=g0,f.memoize=Qn,f.merge=by,f.mergeWith=yh,f.method=v0,f.methodOf=y0,f.mixin=Ho,f.negate=Yn,f.nthArg=w0,f.omit=Ey,f.omitBy=Iy,f.once=mv,f.orderBy=iv,f.over=_0,f.overArgs=wv,f.overEvery=b0,f.overSome=E0,f.partial=$o,f.partialRight=ch,f.partition=sv,f.pick=xy,f.pickBy=mh,f.property=Ph,f.propertyOf=I0,f.pull=ig,f.pullAll=Yu,f.pullAllBy=sg,f.pullAllWith=ng,f.pullAt=ag,f.range=x0,f.rangeRight=P0,f.rearg=_v,f.reject=ov,f.remove=og,f.rest=bv,f.reverse=Ao,f.sampleSize=uv,f.set=Sy,f.setWith=Oy,f.shuffle=hv,f.slice=cg,f.sortBy=pv,f.sortedUniq=gg,f.sortedUniqBy=vg,f.split=Qy,f.spread=Ev,f.tail=yg,f.take=mg,f.takeRight=wg,f.takeRightWhile=_g,f.takeWhile=bg,f.tap=qg,f.throttle=Iv,f.thru=Gn,f.toArray=ph,f.toPairs=wh,f.toPairsIn=_h,f.toPath=A0,f.toPlainObject=gh,f.transform=Cy,f.unary=xv,f.union=Eg,f.unionBy=Ig,f.unionWith=xg,f.uniq=Pg,f.uniqBy=Sg,f.uniqWith=Og,f.unset=Ry,f.unzip=To,f.unzipWith=Xu,f.update=Ay,f.updateWith=Ty,f.values=cs,f.valuesIn=Ny,f.without=Cg,f.words=Ih,f.wrap=Pv,f.xor=Rg,f.xorBy=Ag,f.xorWith=Tg,f.zip=Ng,f.zipObject=$g,f.zipObjectDeep=Dg,f.zipWith=Lg,f.entries=wh,f.entriesIn=_h,f.extend=vh,f.extendWith=ea,Ho(f,f),f.add=N0,f.attempt=xh,f.camelCase=qy,f.capitalize=bh,f.ceil=$0,f.clamp=$y,f.clone=Ov,f.cloneDeep=Rv,f.cloneDeepWith=Av,f.cloneWith=Cv,f.conformsTo=Tv,f.deburr=Eh,f.defaultTo=l0,f.divide=D0,f.endsWith=My,f.eq=Tr,f.escape=jy,f.escapeRegExp=zy,f.every=Bg,f.find=Wg,f.findIndex=Gu,f.findKey=oy,f.findLast=Jg,f.findLastIndex=Wu,f.findLastKey=cy,f.floor=L0,f.forEach=eh,f.forEachRight=th,f.forIn=uy,f.forInRight=hy,f.forOwn=ly,f.forOwnRight=fy,f.get=qo,f.gt=Nv,f.gte=$v,f.has=gy,f.hasIn=Mo,f.head=Qu,f.identity=or,f.includes=ev,f.indexOf=Jd,f.inRange=Dy,f.invoke=my,f.isArguments=Mi,f.isArray=ge,f.isArrayBuffer=Dv,f.isArrayLike=nr,f.isArrayLikeObject=bt,f.isBoolean=Lv,f.isBuffer=yi,f.isDate=qv,f.isElement=Mv,f.isEmpty=jv,f.isEqual=zv,f.isEqualWith=Uv,f.isError=Do,f.isFinite=Hv,f.isFunction=Zr,f.isInteger=uh,f.isLength=Xn,f.isMap=hh,f.isMatch=kv,f.isMatchWith=Kv,f.isNaN=Vv,f.isNative=Fv,f.isNil=Gv,f.isNull=Bv,f.isNumber=lh,f.isObject=ct,f.isObjectLike=yt,f.isPlainObject=$s,f.isRegExp=Lo,f.isSafeInteger=Wv,f.isSet=fh,f.isString=Zn,f.isSymbol=dr,f.isTypedArray=os,f.isUndefined=Jv,f.isWeakMap=Qv,f.isWeakSet=Yv,f.join=eg,f.kebabCase=Uy,f.last=xr,f.lastIndexOf=tg,f.lowerCase=Hy,f.lowerFirst=ky,f.lt=Xv,f.lte=Zv,f.max=q0,f.maxBy=M0,f.mean=j0,f.meanBy=z0,f.min=U0,f.minBy=H0,f.stubArray=Ko,f.stubFalse=Vo,f.stubObject=S0,f.stubString=O0,f.stubTrue=C0,f.multiply=k0,f.nth=rg,f.noConflict=m0,f.noop=ko,f.now=Jn,f.pad=Ky,f.padEnd=Vy,f.padStart=Fy,f.parseInt=By,f.random=Ly,f.reduce=nv,f.reduceRight=av,f.repeat=Gy,f.replace=Wy,f.result=Py,f.round=K0,f.runInContext=x,f.sample=cv,f.size=lv,f.snakeCase=Jy,f.some=fv,f.sortedIndex=ug,f.sortedIndexBy=hg,f.sortedIndexOf=lg,f.sortedLastIndex=fg,f.sortedLastIndexBy=pg,f.sortedLastIndexOf=dg,f.startCase=Yy,f.startsWith=Xy,f.subtract=V0,f.sum=F0,f.sumBy=B0,f.template=Zy,f.times=R0,f.toFinite=ei,f.toInteger=ye,f.toLength=dh,f.toLower=e0,f.toNumber=Pr,f.toSafeInteger=ey,f.toString=qe,f.toUpper=t0,f.trim=r0,f.trimEnd=i0,f.trimStart=s0,f.truncate=n0,f.unescape=a0,f.uniqueId=T0,f.upperCase=o0,f.upperFirst=jo,f.each=eh,f.eachRight=th,f.first=Qu,Ho(f,function(){var e={};return zr(f,function(t,s){je.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,wr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),wr(["drop","take"],function(e,t){Pe.prototype[e]=function(s){s=s===r?1:qt(ye(s),0);var o=this.__filtered__&&!t?new Pe(this):this.clone();return o.__filtered__?o.__takeCount__=Ft(s,o.__takeCount__):o.__views__.push({size:Ft(s,B),type:e+(o.__dir__<0?"Right":"")}),o},Pe.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),wr(["filter","map","takeWhile"],function(e,t){var s=t+1,o=s==A||s==ze;Pe.prototype[e]=function(h){var p=this.clone();return p.__iteratees__.push({iteratee:se(h,3),type:s}),p.__filtered__=p.__filtered__||o,p}}),wr(["head","last"],function(e,t){var s="take"+(t?"Right":"");Pe.prototype[e]=function(){return this[s](1).value()[0]}}),wr(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Pe.prototype[e]=function(){return this.__filtered__?new Pe(this):this[s](1)}}),Pe.prototype.compact=function(){return this.filter(or)},Pe.prototype.find=function(e){return this.filter(e).head()},Pe.prototype.findLast=function(e){return this.reverse().find(e)},Pe.prototype.invokeMap=be(function(e,t){return typeof e=="function"?new Pe(this):this.map(function(s){return Os(s,e,t)})}),Pe.prototype.reject=function(e){return this.filter(Yn(se(e)))},Pe.prototype.slice=function(e,t){e=ye(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Pe(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==r&&(t=ye(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Pe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Pe.prototype.toArray=function(){return this.take(B)},zr(Pe.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),h=f[o?"take"+(t=="last"?"Right":""):t],p=o||/^find/.test(t);h&&(f.prototype[t]=function(){var m=this.__wrapped__,_=o?[1]:arguments,P=m instanceof Pe,q=_[0],M=P||ge(m),H=function(Ie){var Ce=h.apply(f,hi([Ie],_));return o&&G?Ce[0]:Ce};M&&s&&typeof q=="function"&&q.length!=1&&(P=M=!1);var G=this.__chain__,ee=!!this.__actions__.length,ne=p&&!G,we=P&&!ee;if(!p&&M){m=we?m:new Pe(this);var ae=e.apply(m,_);return ae.__actions__.push({func:Gn,args:[H],thisArg:r}),new br(ae,G)}return ne&&we?e.apply(this,_):(ae=this.thru(H),ne?o?ae.value()[0]:ae.value():ae)})}),wr(["pop","push","shift","sort","splice","unshift"],function(e){var t=wn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var h=arguments;if(o&&!this.__chain__){var p=this.value();return t.apply(ge(p)?p:[],h)}return this[s](function(m){return t.apply(ge(m)?m:[],h)})}}),zr(Pe.prototype,function(e,t){var s=f[t];if(s){var o=s.name+"";je.call(rs,o)||(rs[o]=[]),rs[o].push({name:t,func:s})}}),rs[Un(r,ce).name]=[{name:"wrapper",func:r}],Pe.prototype.clone=ap,Pe.prototype.reverse=op,Pe.prototype.value=cp,f.prototype.at=Mg,f.prototype.chain=jg,f.prototype.commit=zg,f.prototype.next=Ug,f.prototype.plant=kg,f.prototype.reverse=Kg,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=Vg,f.prototype.first=f.prototype.head,_s&&(f.prototype[_s]=Hg),f},Zi=zf();_t?((_t.exports=Zi)._=Zi,Be._=Zi):Oe._=Zi}).call(Us)})(dc,dc.exports);var tE=Object.defineProperty,rE=Object.defineProperties,iE=Object.getOwnPropertyDescriptors,bl=Object.getOwnPropertySymbols,sE=Object.prototype.hasOwnProperty,nE=Object.prototype.propertyIsEnumerable,El=(c,i,r)=>i in c?tE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,aa=(c,i)=>{for(var r in i||(i={}))sE.call(i,r)&&El(c,r,i[r]);if(bl)for(var r of bl(i))nE.call(i,r)&&El(c,r,i[r]);return c},aE=(c,i)=>rE(c,iE(i));function Ei(c,i,r){var n;const a=Nm(c);return((n=i.rpcMap)==null?void 0:n[a.reference])||`${eE}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function ki(c){return c.includes(":")?c.split(":")[1]:c}function df(c){return c.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function oE(c,i){const r=Object.keys(i.namespaces).filter(a=>a.includes(c));if(!r.length)return[];const n=[];return r.forEach(a=>{const l=i.namespaces[a].accounts;n.push(...l)}),n}function cE(c={},i={}){const r=Il(c),n=Il(i);return dc.exports.merge(r,n)}function Il(c){var i,r,n,a;const l={};if(!ua(c))return l;for(const[d,v]of Object.entries(c)){const w=jl(d)?[d]:v.chains,y=v.methods||[],E=v.events||[],O=v.rpcMap||{},R=Hs(d);l[R]=aE(aa(aa({},l[R]),v),{chains:Bo(w,(i=l[R])==null?void 0:i.chains),methods:Bo(y,(r=l[R])==null?void 0:r.methods),events:Bo(E,(n=l[R])==null?void 0:n.events),rpcMap:aa(aa({},O),(a=l[R])==null?void 0:a.rpcMap)})}return l}function uE(c){return c.includes(":")?c.split(":")[2]:c}function hE(c){const i={};for(const[r,n]of Object.entries(c)){const a=n.methods||[],l=n.events||[],d=n.accounts||[],v=jl(r)?[r]:n.chains?n.chains:df(n.accounts);i[r]={chains:v,methods:a,events:l,accounts:d}}return i}function sc(c){return typeof c=="number"?c:c.includes("0x")?parseInt(c,16):c.includes(":")?Number(c.split(":")[1]):Number(c)}const gf={},st=c=>gf[c],nc=(c,i)=>{gf[c]=i};class lE{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class fE{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(parseInt(i),r),this.chainId=parseInt(i),this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){const n=r||Ei(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=parseInt(ki(r));i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r,n;let a=i.request.params?(r=i.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:a}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}}class pE{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class dE{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class gE{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),a=ki(r);i[a]=this.createHttpProvider(a,n)}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){const r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||this.getCardanoRPCUrl(i);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class vE{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class yE{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class mE{constructor(i){this.name="near",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const n=r||Ei(`${this.name}:${i}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace);return typeof n>"u"?void 0:new ni(new Ii(n,st("disableProviderPing")))}}var wE=Object.defineProperty,_E=Object.defineProperties,bE=Object.getOwnPropertyDescriptors,xl=Object.getOwnPropertySymbols,EE=Object.prototype.hasOwnProperty,IE=Object.prototype.propertyIsEnumerable,Pl=(c,i,r)=>i in c?wE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,oa=(c,i)=>{for(var r in i||(i={}))EE.call(i,r)&&Pl(c,r,i[r]);if(xl)for(var r of xl(i))IE.call(i,r)&&Pl(c,r,i[r]);return c},ac=(c,i)=>_E(c,bE(i));class Sc{constructor(i){this.events=new mc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Se.pino(Se.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||wl})),this.disableProviderPing=(i==null?void 0:i.disableProviderPing)||!1}static async init(i){const r=new Sc(i);return await r.initialize(),r}async request(i,r){const[n,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:oa({},i),chainId:`${n}:${a}`,topic:this.session.topic})}sendAsync(i,r,n){const a=new Date().getTime();this.request(i,n).then(l=>r(null,ya(a,l))).catch(l=>r(l,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(i=this.session)==null?void 0:i.topic,reason:Gt("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:a}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=hE(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==ff)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{if(!this.session)return;const[n,a]=this.validateChain(i);this.getProvider(n).setDefaultChain(a,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ps(r)){for(const n of r)i.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Q1.init({logger:this.providerOpts.logger||wl,relayUrl:this.providerOpts.relayUrl||Y1,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const i=[...new Set(Object.keys(this.session.namespaces).map(r=>Hs(r)))];nc("client",this.client),nc("events",this.events),nc("disableProviderPing",this.disableProviderPing),i.forEach(r=>{if(!this.session)return;const n=oE(r,this.session),a=df(n),l=cE(this.namespaces,this.optionalNamespaces),d=ac(oa({},l[r]),{accounts:n,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new fE({namespace:d});break;case"solana":this.rpcProviders[r]=new pE({namespace:d});break;case"cosmos":this.rpcProviders[r]=new dE({namespace:d});break;case"polkadot":this.rpcProviders[r]=new lE({namespace:d});break;case"cip34":this.rpcProviders[r]=new gE({namespace:d});break;case"elrond":this.rpcProviders[r]=new vE({namespace:d});break;case"multiversx":this.rpcProviders[r]=new yE({namespace:d});break;case"near":this.rpcProviders[r]=new mE({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{const{params:r}=i,{event:n}=r;if(n.name==="accountsChanged"){const a=n.data;a&&ps(a)&&this.events.emit("accountsChanged",a.map(uE))}else if(n.name==="chainChanged"){const a=r.chainId,l=r.event.data,d=Hs(a),v=sc(a)!==sc(l)?`${d}:${sc(l)}`:a;this.onChainChanged(v)}else this.events.emit(n.name,n.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var n;const{namespaces:a}=r,l=(n=this.client)==null?void 0:n.session.get(i);this.session=ac(oa({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",ac(oa({},Gt("USER_DISCONNECTED")),{data:i.topic}))}),this.on(ai.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw new Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace((r=this.session)==null?void 0:r.namespaces[i])})}setNamespaces(i){const{namespaces:r,optionalNamespaces:n,sessionProperties:a}=i;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(i){const[r,n]=(i==null?void 0:i.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(d=>Hs(d)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const a=Hs(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){var n;if(!this.namespaces)return;const[a,l]=this.validateChain(i);r||this.getProvider(a).setDefaultChain(l),((n=this.namespaces[a])!=null?n:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${_l}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${_l}/${i}`)}}const xE=Sc,PE="wc",SE="ethereum_provider",OE=`${PE}@2:${SE}:`,CE="https://rpc.walletconnect.com/v1/",gc=["eth_sendTransaction","personal_sign"],RE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],vc=["chainChanged","accountsChanged"],AE=["chainChanged","accountsChanged","message","disconnect","connect"];var TE=Object.defineProperty,NE=Object.defineProperties,$E=Object.getOwnPropertyDescriptors,Sl=Object.getOwnPropertySymbols,DE=Object.prototype.hasOwnProperty,LE=Object.prototype.propertyIsEnumerable,Ol=(c,i,r)=>i in c?TE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,Ks=(c,i)=>{for(var r in i||(i={}))DE.call(i,r)&&Ol(c,r,i[r]);if(Sl)for(var r of Sl(i))LE.call(i,r)&&Ol(c,r,i[r]);return c},Cl=(c,i)=>NE(c,$E(i));function da(c){return Number(c[0].split(":")[1])}function oc(c){return`0x${c.toString(16)}`}function qE(c){const{chains:i,optionalChains:r,methods:n,optionalMethods:a,events:l,optionalEvents:d,rpcMap:v}=c;if(!ps(i))throw new Error("Invalid chains");const w={chains:i,methods:n||gc,events:l||vc,rpcMap:Ks({},i.length?{[da(i)]:v[da(i)]}:{})},y=l==null?void 0:l.filter(z=>!vc.includes(z)),E=n==null?void 0:n.filter(z=>!gc.includes(z));if(!r&&!d&&!a&&!(y!=null&&y.length)&&!(E!=null&&E.length))return{required:i.length?w:void 0};const O=(y==null?void 0:y.length)&&(E==null?void 0:E.length)||!r,R={chains:[...new Set(O?w.chains.concat(r||[]):r)],methods:[...new Set(w.methods.concat(a!=null&&a.length?a:RE))],events:[...new Set(w.events.concat(d!=null&&d.length?d:AE))],rpcMap:v};return{required:i.length?w:void 0,optional:r.length?R:void 0}}class Oc{constructor(){this.events=new Kr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=OE,this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){const r=new Oc;return await r.initialize(i),r}async request(i){return await this.signer.request(i,this.formatChainId(this.chainId))}sendAsync(i,r){this.signer.sendAsync(i,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);const{required:r,optional:n}=qE(this.rpc);try{const a=await new Promise(async(d,v)=>{var w;this.rpc.showQrModal&&((w=this.modal)==null||w.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),v(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Cl(Ks({namespaces:Ks({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:i==null?void 0:i.pairingTopic})).then(y=>{d(y)}).catch(y=>{v(new Error(y.message))})});if(!a)return;const l=$m(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:l),this.setAccounts(l),this.events.emit("connect",{chainId:oc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{const{params:r}=i,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{const r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",oc(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",Cl(Ks({},Gt("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return typeof i=="string"?i.startsWith(`${this.namespace}:`):!1}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){const r=i.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",oc(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){const r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){const[r,n,a]=i.split(":");return{chainId:`${r}:${n}`,address:a}}setAccounts(i){this.accounts=i.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,n;const a=(r=i==null?void 0:i.chains)!=null?r:[],l=(n=i==null?void 0:i.optionalChains)!=null?n:[],d=a.concat(l);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const v=a.length?(i==null?void 0:i.methods)||gc:[],w=a.length?(i==null?void 0:i.events)||vc:[],y=(i==null?void 0:i.optionalMethods)||[],E=(i==null?void 0:i.optionalEvents)||[],O=(i==null?void 0:i.rpcMap)||this.buildRpcMap(d,i.projectId),R=(i==null?void 0:i.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(z=>this.formatChainId(z)),optionalChains:l.map(z=>this.formatChainId(z)),methods:v,events:w,optionalMethods:y,optionalEvents:E,rpcMap:O,showQrModal:!!(i!=null&&i.showQrModal),qrModalOptions:R,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){const n={};return i.forEach(a=>{n[a]=this.getRpcUrl(a,r)}),n}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=this.rpc.chains.length?da(this.rpc.chains):da(this.rpc.optionalChains),this.signer=await xE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await Dm(()=>import("./index-6JlEh00p.js").then(a=>a.i),__vite__mapDeps([0,1,2]));r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Ks({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;const{chains:r,optionalChains:n,rpcMap:a}=i;r&&ps(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)})),n&&ps(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(l=>this.formatChainId(l)),n.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)}))}getRpcUrl(i,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[i])||`${CE}?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return typeof i=="string"||i instanceof String?[this.parseAccount(i)]:i.map(r=>this.parseAccount(r))}}const XE=Oc;export{XE as EthereumProvider,AE as OPTIONAL_EVENTS,RE as OPTIONAL_METHODS,vc as REQUIRED_EVENTS,gc as REQUIRED_METHODS,Oc as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-6JlEh00p.js","assets/index-NPCOLHFI.js","assets/index-VcEOFO0W.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
